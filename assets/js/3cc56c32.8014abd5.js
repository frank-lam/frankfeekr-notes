"use strict";(self.webpackChunknotes_frankfeekr_cn=self.webpackChunknotes_frankfeekr_cn||[]).push([[9807],{3905:(e,t,a)=>{a.d(t,{Zo:()=>o,kt:()=>h});var n=a(7294);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var s=n.createContext({}),k=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},o=function(e){var t=k(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,i=e.originalType,s=e.parentName,o=p(e,["components","mdxType","originalType","parentName"]),d=k(a),h=l,m=d["".concat(s,".").concat(h)]||d[h]||u[h]||i;return a?n.createElement(m,r(r({ref:t},o),{},{components:a})):n.createElement(m,r({ref:t},o))}));function h(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var i=a.length,r=new Array(i);r[0]=d;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p.mdxType="string"==typeof e?e:l,r[1]=p;for(var k=2;k<i;k++)r[k]=a[k];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},2587:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>p,toc:()=>k});var n=a(7462),l=(a(7294),a(3905));const i={},r="Java \u96c6\u5408\u6846\u67b6",p={unversionedId:"backend/java/Java\u96c6\u5408\u6846\u67b6",id:"backend/java/Java\u96c6\u5408\u6846\u67b6",title:"Java \u96c6\u5408\u6846\u67b6",description:"\u524d\u8a00",source:"@site/docs/02.backend/java/02-Java\u96c6\u5408\u6846\u67b6.md",sourceDirName:"02.backend/java",slug:"/backend/java/Java\u96c6\u5408\u6846\u67b6",permalink:"/docs/backend/java/Java\u96c6\u5408\u6846\u67b6",draft:!1,editUrl:"https://github.com/frank-lam/frankfeekr-notes/tree/master/docs/02.backend/java/02-Java\u96c6\u5408\u6846\u67b6.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"backend_java",previous:{title:"Java \u57fa\u7840\u77e5\u8bc6",permalink:"/docs/backend/java/Java\u57fa\u7840"},next:{title:"Java \u5e76\u53d1\u7f16\u7a0b",permalink:"/docs/backend/java/Java\u5e76\u53d1\u7f16\u7a0b"}},s={},k=[{value:"\u524d\u8a00",id:"\u524d\u8a00",level:2},{value:"\u4e00\u3001\u6982\u8ff0",id:"\u4e00\u6982\u8ff0",level:3},{value:"\u96c6\u5408\u6846\u67b6\u56fe",id:"\u96c6\u5408\u6846\u67b6\u56fe",level:3},{value:"Collection",id:"collection",level:3},{value:"Map",id:"map",level:3},{value:"\u5de5\u5177\u7c7b",id:"\u5de5\u5177\u7c7b",level:3},{value:"\u901a\u7528\u5b9e\u73b0",id:"\u901a\u7528\u5b9e\u73b0",level:3},{value:"\u4e8c\u3001\u6df1\u5165\u6e90\u7801\u5206\u6790",id:"\u4e8c\u6df1\u5165\u6e90\u7801\u5206\u6790",level:2},{value:"ArrayList",id:"arraylist",level:3},{value:"1. \u6982\u89c8",id:"1-\u6982\u89c8",level:4},{value:"2. \u5e8f\u5217\u5316",id:"2-\u5e8f\u5217\u5316",level:4},{value:"3. \u6269\u5bb9",id:"3-\u6269\u5bb9",level:4},{value:"4. \u5220\u9664\u5143\u7d20",id:"4-\u5220\u9664\u5143\u7d20",level:4},{value:"5. Fail-Fast",id:"5-fail-fast",level:4},{value:"Vector",id:"vector",level:3},{value:"1. \u540c\u6b65",id:"1-\u540c\u6b65",level:4},{value:"2. ArrayList \u4e0e Vector",id:"2-arraylist-\u4e0e-vector",level:4},{value:"3. Vector \u66ff\u4ee3\u65b9\u6848",id:"3-vector-\u66ff\u4ee3\u65b9\u6848",level:4},{value:"synchronizedList",id:"synchronizedlist",level:5},{value:"CopyOnWriteArrayList",id:"copyonwritearraylist",level:5},{value:"LinkedList",id:"linkedlist",level:3},{value:"1. \u6982\u89c8",id:"1-\u6982\u89c8-1",level:4},{value:"2. add()",id:"2-add",level:4},{value:"3. remove()",id:"3-remove",level:4},{value:"4. get()",id:"4-get",level:4},{value:"5. \u603b\u7ed3",id:"5-\u603b\u7ed3",level:4},{value:"6. ArrayList \u4e0e LinkedList",id:"6-arraylist-\u4e0e-linkedlist",level:4},{value:"HashMap",id:"hashmap",level:3},{value:"1. \u5b58\u50a8\u7ed3\u6784",id:"1-\u5b58\u50a8\u7ed3\u6784",level:4},{value:"JDK1.7 \u7684\u5b58\u50a8\u7ed3\u6784",id:"jdk17-\u7684\u5b58\u50a8\u7ed3\u6784",level:5},{value:"JDK1.8 \u7684\u5b58\u50a8\u7ed3\u6784",id:"jdk18-\u7684\u5b58\u50a8\u7ed3\u6784",level:5},{value:"2. \u91cd\u8981\u53c2\u6570",id:"2-\u91cd\u8981\u53c2\u6570",level:4},{value:"3. \u786e\u5b9a\u54c8\u5e0c\u6876\u6570\u7ec4\u7d22\u5f15\u4f4d\u7f6e",id:"3-\u786e\u5b9a\u54c8\u5e0c\u6876\u6570\u7ec4\u7d22\u5f15\u4f4d\u7f6e",level:4},{value:"4. \u5206\u6790HashMap\u7684put\u65b9\u6cd5",id:"4-\u5206\u6790hashmap\u7684put\u65b9\u6cd5",level:4},{value:"5. \u6269\u5bb9\u673a\u5236",id:"5-\u6269\u5bb9\u673a\u5236",level:4},{value:"6. \u7ebf\u7a0b\u5b89\u5168\u6027",id:"6-\u7ebf\u7a0b\u5b89\u5168\u6027",level:4},{value:"7. JDK1.8\u4e0eJDK1.7\u7684\u6027\u80fd\u5bf9\u6bd4",id:"7-jdk18\u4e0ejdk17\u7684\u6027\u80fd\u5bf9\u6bd4",level:4},{value:"8. Hash\u8f83\u5747\u5300\u7684\u60c5\u51b5",id:"8-hash\u8f83\u5747\u5300\u7684\u60c5\u51b5",level:4},{value:"9. Hash\u6781\u4e0d\u5747\u5300\u7684\u60c5\u51b5",id:"9-hash\u6781\u4e0d\u5747\u5300\u7684\u60c5\u51b5",level:4},{value:"10. HashMap\u4e0eHashtable",id:"10-hashmap\u4e0ehashtable",level:4},{value:"11. \u5c0f\u7ed3",id:"11-\u5c0f\u7ed3",level:4},{value:"ConcurrentHashMap",id:"concurrenthashmap",level:3},{value:"1. \u6982\u8ff0\u3000\u3000",id:"1-\u6982\u8ff0",level:4},{value:"2. \u5b58\u50a8\u7ed3\u6784",id:"2-\u5b58\u50a8\u7ed3\u6784",level:4},{value:"2. size \u64cd\u4f5c",id:"2-size-\u64cd\u4f5c",level:4},{value:"3. \u540c\u6b65\u65b9\u5f0f",id:"3-\u540c\u6b65\u65b9\u5f0f",level:4},{value:"4. JDK 1.8 \u7684\u6539\u52a8",id:"4-jdk-18-\u7684\u6539\u52a8",level:4},{value:"HashSet",id:"hashset",level:3},{value:"1. \u6210\u5458\u53d8\u91cf",id:"1-\u6210\u5458\u53d8\u91cf",level:4},{value:"2. \u6784\u9020\u51fd\u6570",id:"2-\u6784\u9020\u51fd\u6570",level:4},{value:"3. add()",id:"3-add",level:4},{value:"4. \u603b\u7ed3",id:"4-\u603b\u7ed3",level:4},{value:"LinkedHashSet and LinkedHashMap",id:"linkedhashset-and-linkedhashmap",level:3},{value:"1. \u6982\u89c8",id:"1-\u6982\u89c8-2",level:4},{value:"2. get()",id:"2-get",level:4},{value:"3. put()",id:"3-put",level:4},{value:"4. remove()",id:"4-remove",level:4},{value:"5. LinkedHashSet",id:"5-linkedhashset",level:4},{value:"6. LinkedHashMap\u7ecf\u5178\u7528\u6cd5",id:"6-linkedhashmap\u7ecf\u5178\u7528\u6cd5",level:4},{value:"\u4e09\u3001\u5bb9\u5668\u4e2d\u7684\u8bbe\u8ba1\u6a21\u5f0f",id:"\u4e09\u5bb9\u5668\u4e2d\u7684\u8bbe\u8ba1\u6a21\u5f0f",level:2},{value:"\u8fed\u4ee3\u5668\u6a21\u5f0f",id:"\u8fed\u4ee3\u5668\u6a21\u5f0f",level:3},{value:"\u9002\u914d\u5668\u6a21\u5f0f",id:"\u9002\u914d\u5668\u6a21\u5f0f",level:3},{value:"\u56db\u3001\u9762\u8bd5\u6307\u5357",id:"\u56db\u9762\u8bd5\u6307\u5357",level:2},{value:"1. ArrayList\u548cLinkedList\u533a\u522b",id:"1-arraylist\u548clinkedlist\u533a\u522b",level:3},{value:"2. HashMap\u548cHashtable\u533a\u522b\uff0cHashMap\u7684key\u7c7b\u578b",id:"2-hashmap\u548chashtable\u533a\u522bhashmap\u7684key\u7c7b\u578b",level:3},{value:"3. HashMap\u548cConcurrentHashMap",id:"3-hashmap\u548cconcurrenthashmap",level:3},{value:"4. Hashtable\u7684\u539f\u7406",id:"4-hashtable\u7684\u539f\u7406",level:3},{value:"5. Hash\u51b2\u7a81\u7684\u89e3\u51b3\u529e\u6cd5",id:"5-hash\u51b2\u7a81\u7684\u89e3\u51b3\u529e\u6cd5",level:3},{value:"6. \u4ec0\u4e48\u662f\u8fed\u4ee3\u5668",id:"6-\u4ec0\u4e48\u662f\u8fed\u4ee3\u5668",level:3},{value:"7. \u6784\u9020\u76f8\u540chash\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u653b\u51fb\uff0c\u8fd9\u79cd\u60c5\u51b5\u5e94\u8be5\u600e\u4e48\u5904\u7406\uff1fJDK7\u5982\u4f55\u5904\u7406",id:"7-\u6784\u9020\u76f8\u540chash\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u653b\u51fb\u8fd9\u79cd\u60c5\u51b5\u5e94\u8be5\u600e\u4e48\u5904\u7406jdk7\u5982\u4f55\u5904\u7406",level:3},{value:"8. HashMap\u4e3a\u4ec0\u4e48\u5927\u5c0f\u662f2\u7684\u5e42\u6b21",id:"8-hashmap\u4e3a\u4ec0\u4e48\u5927\u5c0f\u662f2\u7684\u5e42\u6b21",level:3},{value:"\u66f4\u65b0\u65e5\u5fd7",id:"\u66f4\u65b0\u65e5\u5fd7",level:2}],o={toc:k};function u(e){let{components:t,...i}=e;return(0,l.kt)("wrapper",(0,n.Z)({},o,i,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"java-\u96c6\u5408\u6846\u67b6"},"Java \u96c6\u5408\u6846\u67b6"),(0,l.kt)("h2",{id:"\u524d\u8a00"},"\u524d\u8a00"),(0,l.kt)("p",null,"\u3000\u3000Java\u96c6\u5408\u6846\u67b6 (Java Collections Framework, JCF) \u4e5f\u79f0\u5bb9\u5668\uff0c\u8fd9\u91cc\u53ef\u4ee5\u7c7b\u6bd4 C++ \u4e2d\u7684 STL\uff0c\u5728\u5e02\u9762\u4e0a\u4f3c\u4e4e\u8fd8\u6ca1\u80fd\u627e\u5230\u4e00\u672c\u8be6\u7ec6\u4ecb\u7ecd\u7684\u4e66\u7c4d\u3002\u5728\u8fd9\u91cc\u4e3b\u8981\u5bf9\u5982\u4e0b\u90e8\u5206\u8fdb\u884c\u6e90\u7801\u5206\u6790\uff0c\u53ca\u5728\u9762\u8bd5\u4e2d\u5e38\u89c1\u7684\u95ee\u9898\u3002"),(0,l.kt)("p",null,"\u3000\u3000\u4f8b\u5982\uff0c\u5728\u963f\u91cc\u9762\u8bd5\u5e38\u95ee\u5230\u7684 HashMap \u548c ConcurrentHashMap \u539f\u7406\u7b49\u7b49\u3002\u6df1\u5165\u6e90\u7801\u5206\u6790\u662f\u9762\u8bd5\u4e2d\u5fc5\u5907\u7684\u6280\u80fd\uff0c\u901a\u8fc7\u672c\u6587\u7684\u9605\u8bfb\u4f1a\u5bf9\u96c6\u5408\u6846\u67b6\u6709\u66f4\u6df1\u4e00\u6b65\u7684\u4e86\u89e3\u3002"),(0,l.kt)("p",null,"\u672c\u6587\u53c2\u8003\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/CarpenterLee/JCFInternals"},"CarpenterLee/JCFInternals: \u6df1\u5165\u7406\u89e3Java\u96c6\u5408\u6846\u67b6")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/crossoverJie/Java-Interview"},"crossoverJie/Java-Interview: \ud83d\udc68\u200d\ud83c\udf93 Java related : basic, concurrent, algorithm")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/CyC2018/Interview-Notebook/blob/master/notes/Java%20%E5%AE%B9%E5%99%A8.md"},"Interview-Notebook/Java \u5bb9\u5668.md at master \xb7 CyC2018/Interview-Notebook"))),(0,l.kt)("h3",{id:"\u4e00\u6982\u8ff0"},"\u4e00\u3001\u6982\u8ff0"),(0,l.kt)("p",null,"\u3000\u3000Java\u96c6\u5408\u6846\u67b6\u63d0\u4f9b\u4e86\u6570\u636e\u6301\u6709\u5bf9\u8c61\u7684\u65b9\u5f0f\uff0c\u63d0\u4f9b\u4e86\u5bf9\u6570\u636e\u96c6\u5408\u7684\u64cd\u4f5c\u3002Java \u96c6\u5408\u6846\u67b6\u4f4d\u4e8e ",(0,l.kt)("inlineCode",{parentName:"p"}," java.util")," \u5305\u4e0b\uff0c\u4e3b\u8981\u6709\u4e09\u4e2a\u5927\u7c7b\uff1a",(0,l.kt)("strong",{parentName:"p"},"Collection(\u63a5\u53e3)"),"\u3001",(0,l.kt)("strong",{parentName:"p"},"Map(\u63a5\u53e3)"),"\u3001",(0,l.kt)("strong",{parentName:"p"},"\u96c6\u5408\u5de5\u5177\u7c7b"),"\u3002"),(0,l.kt)("h3",{id:"\u96c6\u5408\u6846\u67b6\u56fe"},"\u96c6\u5408\u6846\u67b6\u56fe"),(0,l.kt)("p",null,(0,l.kt)("img",{src:a(9138).Z,width:"1856",height:"629"})),(0,l.kt)("h3",{id:"collection"},"Collection"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"ArrayList"),"\uff1a",(0,l.kt)("strong",{parentName:"li"},"\u7ebf\u7a0b\u4e0d\u540c\u6b65"),"\u3002\u9ed8\u8ba4\u521d\u59cb\u5bb9\u91cf\u4e3a 10\uff0c\u5f53\u6570\u7ec4\u5927\u5c0f\u4e0d\u8db3\u65f6\u5bb9\u91cf\u6269\u5927\u4e3a 1.5 \u500d\u3002\u4e3a\u8ffd\u6c42\u6548\u7387\uff0cArrayList \u6ca1\u6709\u5b9e\u73b0\u540c\u6b65\uff08synchronized\uff09\uff0c\u5982\u679c\u9700\u8981\u591a\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u8bbf\u95ee\uff0c\u7528\u6237\u53ef\u4ee5\u624b\u52a8\u540c\u6b65\uff0c\u4e5f\u53ef\u4f7f\u7528 Vector \u66ff\u4ee3\u3002 "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"LinkedList"),"\uff1a",(0,l.kt)("strong",{parentName:"li"},"\u7ebf\u7a0b\u4e0d\u540c\u6b65"),"\u3002",(0,l.kt)("strong",{parentName:"li"},"\u53cc\u5411\u94fe\u63a5\u5b9e\u73b0"),"\u3002LinkedList \u540c\u65f6\u5b9e\u73b0\u4e86 List \u63a5\u53e3\u548c Deque \u63a5\u53e3\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u65e2\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u987a\u5e8f\u5bb9\u5668\uff0c\u53c8\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u961f\u5217\uff08Queue\uff09\uff0c\u540c\u65f6\u53c8\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u6808\uff08Stack\uff09\u3002\u8fd9\u6837\u770b\u6765\uff0cLinkedList \u7b80\u76f4\u5c31\u662f\u4e2a\u5168\u80fd\u51a0\u519b\u3002\u5f53\u4f60\u9700\u8981\u4f7f\u7528\u6808\u6216\u8005\u961f\u5217\u65f6\uff0c\u53ef\u4ee5\u8003\u8651\u4f7f\u7528 LinkedList\uff0c\u4e00\u65b9\u9762\u662f\u56e0\u4e3a Java \u5b98\u65b9\u5df2\u7ecf\u58f0\u660e\u4e0d\u5efa\u8bae\u4f7f\u7528 Stack \u7c7b\uff0c\u66f4\u9057\u61be\u7684\u662f\uff0cJava \u91cc\u6839\u672c\u6ca1\u6709\u4e00\u4e2a\u53eb\u505a Queue \u7684\u7c7b\uff08\u5b83\u662f\u4e2a\u63a5\u53e3\u540d\u5b57\uff09\u3002\u5173\u4e8e\u6808\u6216\u961f\u5217\uff0c\u73b0\u5728\u7684\u9996\u9009\u662f ArrayDeque\uff0c\u5b83\u6709\u7740\u6bd4 LinkedList\uff08\u5f53\u4f5c\u6808\u6216\u961f\u5217\u4f7f\u7528\u65f6\uff09\u6709\u7740\u66f4\u597d\u7684\u6027\u80fd\u3002 "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Stack and Queue"),"\uff1aJava \u91cc\u6709\u4e00\u4e2a\u53eb\u505a Stack \u7684\u7c7b\uff0c\u5374\u6ca1\u6709\u53eb\u505a Queue \u7684\u7c7b\uff08\u5b83\u662f\u4e2a\u63a5\u53e3\u540d\u5b57\uff09\u3002\u5f53\u9700\u8981\u4f7f\u7528\u6808\u65f6\uff0cJava \u5df2\u4e0d\u63a8\u8350\u4f7f\u7528 Stack\uff0c\u800c\u662f\u63a8\u8350\u4f7f\u7528\u66f4\u9ad8\u6548\u7684 ArrayDeque\uff1b\u65e2\u7136 Queue \u53ea\u662f\u4e00\u4e2a\u63a5\u53e3\uff0c\u5f53\u9700\u8981\u4f7f\u7528\u961f\u5217\u65f6\u4e5f\u5c31\u9996\u9009 ArrayDeque \u4e86\uff08\u6b21\u9009\u662f LinkedList \uff09\u3002 "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Vector"),"\uff1a",(0,l.kt)("strong",{parentName:"li"},"\u7ebf\u7a0b\u540c\u6b65"),"\u3002\u9ed8\u8ba4\u521d\u59cb\u5bb9\u91cf\u4e3a 10\uff0c\u5f53\u6570\u7ec4\u5927\u5c0f\u4e0d\u8db3\u65f6\u5bb9\u91cf\u6269\u5927\u4e3a 2 \u500d\u3002\u5b83\u7684\u540c\u6b65\u662f\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"li"},"Iterator")," \u65b9\u6cd5\u52a0 ",(0,l.kt)("inlineCode",{parentName:"li"},"synchronized")," \u5b9e\u73b0\u7684\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Stack"),"\uff1a",(0,l.kt)("strong",{parentName:"li"},"\u7ebf\u7a0b\u540c\u6b65"),"\u3002\u7ee7\u627f\u81ea Vector\uff0c\u6dfb\u52a0\u4e86\u51e0\u4e2a\u65b9\u6cd5\u6765\u5b8c\u6210\u6808\u7684\u529f\u80fd\u3002\u73b0\u5728\u5df2\u7ecf\u4e0d\u63a8\u8350\u4f7f\u7528 Stack\uff0c\u5728\u6808\u548c\u961f\u5217\u4e2d\u6709\u9650\u4f7f\u7528 ArrayDeque\uff0c\u5176\u6b21\u662f LinkedList\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"TreeSet"),"\uff1a",(0,l.kt)("strong",{parentName:"li"},"\u7ebf\u7a0b\u4e0d\u540c\u6b65"),"\uff0c\u5185\u90e8\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"li"},"NavigableMap")," \u64cd\u4f5c\u3002\u9ed8\u8ba4\u5143\u7d20 \u201c\u81ea\u7136\u987a\u5e8f\u201d \u6392\u5217\uff0c\u53ef\u4ee5\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"li"},"Comparator")," \u6539\u53d8\u6392\u5e8f\u3002TreeSet \u91cc\u9762\u6709\u4e00\u4e2a TreeMap\uff08\u9002\u914d\u5668\u6a21\u5f0f\uff09"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"HashSet"),"\uff1a",(0,l.kt)("strong",{parentName:"li"},"\u7ebf\u7a0b\u4e0d\u540c\u6b65"),"\uff0c\u5185\u90e8\u4f7f\u7528 HashMap \u8fdb\u884c\u6570\u636e\u5b58\u50a8\uff0c\u63d0\u4f9b\u7684\u65b9\u6cd5\u57fa\u672c\u90fd\u662f\u8c03\u7528 HashMap \u7684\u65b9\u6cd5\uff0c\u6240\u4ee5\u4e24\u8005\u672c\u8d28\u662f\u4e00\u6837\u7684\u3002\u96c6\u5408\u5143\u7d20\u53ef\u4ee5\u4e3a NULL\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Set"),"\uff1aSet \u662f\u4e00\u79cd\u4e0d\u5305\u542b\u91cd\u590d\u5143\u7d20\u7684 Collection\uff0cSet \u6700\u591a\u53ea\u6709\u4e00\u4e2a null \u5143\u7d20\u3002Set \u96c6\u5408\u901a\u5e38\u53ef\u4ee5\u901a\u8fc7 Map \u96c6\u5408\u901a\u8fc7\u9002\u914d\u5668\u6a21\u5f0f\u5f97\u5230\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"PriorityQueue"),"\uff1aJava \u4e2d PriorityQueue \u5b9e\u73b0\u4e86 Queue \u63a5\u53e3\uff0c\u4e0d\u5141\u8bb8\u653e\u5165 null \u5143\u7d20\uff1b\u5176\u901a\u8fc7\u5806\u5b9e\u73b0\uff0c\u5177\u4f53\u8bf4\u662f\u901a\u8fc7\u5b8c\u5168\u4e8c\u53c9\u6811\uff08complete binary tree\uff09\u5b9e\u73b0\u7684",(0,l.kt)("strong",{parentName:"li"},"\u5c0f\u9876\u5806"),"\uff08\u4efb\u610f\u4e00\u4e2a\u975e\u53f6\u5b50\u8282\u70b9\u7684\u6743\u503c\uff0c\u90fd\u4e0d\u5927\u4e8e\u5176\u5de6\u53f3\u5b50\u8282\u70b9\u7684\u6743\u503c\uff09\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u53ef\u4ee5\u901a\u8fc7\u6570\u7ec4\u6765\u4f5c\u4e3a PriorityQueue \u7684\u5e95\u5c42\u5b9e\u73b0\u3002 ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u4f18\u5148\u961f\u5217\u7684\u4f5c\u7528\u662f\u80fd\u4fdd\u8bc1\u6bcf\u6b21\u53d6\u51fa\u7684\u5143\u7d20\u90fd\u662f\u961f\u5217\u4e2d\u6743\u503c\u6700\u5c0f\u7684"),"\uff08Java \u7684\u4f18\u5148\u961f\u5217\u6bcf\u6b21\u53d6\u6700\u5c0f\u5143\u7d20\uff0cC++ \u7684\u4f18\u5148\u961f\u5217\u6bcf\u6b21\u53d6\u6700\u5927\u5143\u7d20\uff09\u3002\u8fd9\u91cc\u7275\u6d89\u5230\u4e86\u5927\u5c0f\u5173\u7cfb\uff0c",(0,l.kt)("strong",{parentName:"li"},"\u5143\u7d20\u5927\u5c0f\u7684\u8bc4\u5224\u53ef\u4ee5\u901a\u8fc7\u5143\u7d20\u672c\u8eab\u7684\u81ea\u7136\u987a\u5e8f\uff08natural ordering\uff09\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6784\u9020\u65f6\u4f20\u5165\u7684\u6bd4\u8f83\u5668"),"\uff08",(0,l.kt)("em",{parentName:"li"},"Comparator"),"\uff0c\u7c7b\u4f3c\u4e8e C++ \u7684\u4eff\u51fd\u6570\uff09\u3002 "))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"NavigableSet"),"\uff1a\u6dfb\u52a0\u4e86\u641c\u7d22\u529f\u80fd\uff0c\u53ef\u4ee5\u5bf9\u7ed9\u5b9a\u5143\u7d20\u8fdb\u884c\u641c\u7d22\uff1a\u5c0f\u4e8e\u3001\u5c0f\u4e8e\u7b49\u4e8e\u3001\u5927\u4e8e\u3001\u5927\u4e8e\u7b49\u4e8e\uff0c\u653e\u56de\u4e00\u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u6700\u63a5\u8fd1\u7ed9\u5b9a\u5143\u7d20\u7684 key\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"EnumSet"),"\uff1a\u7ebf\u7a0b\u4e0d\u540c\u6b65\u3002\u5185\u90e8\u4f7f\u7528 Enum \u6570\u7ec4\u5b9e\u73b0\uff0c\u901f\u5ea6\u6bd4 ",(0,l.kt)("inlineCode",{parentName:"li"},"HashSet")," \u5feb\u3002",(0,l.kt)("strong",{parentName:"li"},"\u53ea\u80fd\u5b58\u50a8\u5728\u6784\u9020\u51fd\u6570\u4f20\u5165\u7684\u679a\u4e3e\u7c7b\u7684\u679a\u4e3e\u503c"),"\u3002")),(0,l.kt)("p",null,"\u3000\u3000\u6ce8\u91ca\uff1a\u66f4\u591a\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u8bf7\u8f6c\u5411 ",(0,l.kt)("a",{parentName:"p",href:"/docs/backend/java/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"},"Java \u8bbe\u8ba1\u6a21\u5f0f")),(0,l.kt)("h3",{id:"map"},"Map"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"TreeMap"),"\uff1a\u7ebf\u7a0b\u4e0d\u540c\u6b65\uff0c\u57fa\u4e8e ",(0,l.kt)("strong",{parentName:"li"},"\u7ea2\u9ed1\u6811")," \uff08Red-Black tree\uff09\u7684 NavigableMap \u5b9e\u73b0\uff0c\u80fd\u591f\u628a\u5b83\u4fdd\u5b58\u7684\u8bb0\u5f55\u6839\u636e\u952e\u6392\u5e8f\uff0c\u9ed8\u8ba4\u662f\u6309\u952e\u503c\u7684\u5347\u5e8f\u6392\u5e8f\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u6392\u5e8f\u7684\u6bd4\u8f83\u5668\uff0c\u5f53\u7528 Iterator \u904d\u5386 TreeMap \u65f6\uff0c\u5f97\u5230\u7684\u8bb0\u5f55\u662f\u6392\u8fc7\u5e8f\u7684\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"TreeMap \u5e95\u5c42\u901a\u8fc7\u7ea2\u9ed1\u6811\uff08Red-Black tree\uff09\u5b9e\u73b0"),"\uff0c\u4e5f\u5c31\u610f\u5473\u7740 ",(0,l.kt)("inlineCode",{parentName:"li"},"containsKey()"),", ",(0,l.kt)("inlineCode",{parentName:"li"},"get()"),", ",(0,l.kt)("inlineCode",{parentName:"li"},"put()"),", ",(0,l.kt)("inlineCode",{parentName:"li"},"remove()")," \u90fd\u6709\u7740 ",(0,l.kt)("inlineCode",{parentName:"li"},"log(n)")," \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u5176\u5177\u4f53\u7b97\u6cd5\u5b9e\u73b0\u53c2\u7167\u4e86\u300a\u7b97\u6cd5\u5bfc\u8bba\u300b\u3002"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Hashtable"),"\uff1a",(0,l.kt)("strong",{parentName:"li"},"\u7ebf\u7a0b\u5b89\u5168"),"\uff0cHashMap \u7684\u8fed\u4ee3\u5668 ","(","Iterator",")"," \u662f ",(0,l.kt)("inlineCode",{parentName:"li"},"fail-fast")," \u8fed\u4ee3\u5668\u3002",(0,l.kt)("strong",{parentName:"li"},"Hashtable \u4e0d\u80fd\u5b58\u50a8 NULL \u7684 key \u548c value\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"HashMap"),"\uff1a\u7ebf\u7a0b\u4e0d\u540c\u6b65\u3002\u6839\u636e ",(0,l.kt)("inlineCode",{parentName:"li"},"key")," \u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"hashcode")," \u8fdb\u884c\u5b58\u50a8\uff0c\u5185\u90e8\u4f7f\u7528\u9759\u6001\u5185\u90e8\u7c7b ",(0,l.kt)("inlineCode",{parentName:"li"},"Node")," \u7684\u6570\u7ec4\u8fdb\u884c\u5b58\u50a8\uff0c\u9ed8\u8ba4\u521d\u59cb\u5927\u5c0f\u4e3a 16\uff0c\u6bcf\u6b21\u6269\u5927\u4e00\u500d\u3002\u5f53\u53d1\u751f Hash \u51b2\u7a81\u65f6\uff0c\u91c7\u7528\u62c9\u94fe\u6cd5\uff08\u94fe\u8868\uff09\u3002JDK 1.8\u4e2d\uff1a",(0,l.kt)("strong",{parentName:"li"},"\u5f53\u5355\u4e2a\u6876\u4e2d\u5143\u7d20\u4e2a\u6570\u5927\u4e8e\u7b49\u4e8e8\u65f6\uff0c\u94fe\u8868\u5b9e\u73b0\u6539\u4e3a\u7ea2\u9ed1\u6811\u5b9e\u73b0\uff1b\u5f53\u5143\u7d20\u4e2a\u6570\u5c0f\u4e8e6\u65f6\uff0c\u53d8\u56de\u94fe\u8868\u5b9e\u73b0\u3002\u7531\u6b64\u6765\u9632\u6b62hashCode\u653b\u51fb\u3002"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Java\xa0HashMap \u91c7\u7528\u7684\u662f\u51b2\u7a81\u94fe\u8868\u65b9\u5f0f\u3002  "),(0,l.kt)("li",{parentName:"ul"},"HashMap \u662f Hashtable \u7684\u8f7b\u91cf\u7ea7\u5b9e\u73b0\uff0c\u53ef\u4ee5\u63a5\u53d7\u4e3a null \u7684\u952e\u503c (key",")"," \u548c\u503c ","(","value",")","\uff0c\u800c Hashtable \u4e0d\u5141\u8bb8\u3002"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"LinkedHashMap"),"\uff1a",(0,l.kt)("strong",{parentName:"li"},"\u4fdd\u5b58\u4e86\u8bb0\u5f55\u7684\u63d2\u5165\u987a\u5e8f"),"\uff0c\u5728\u7528 Iterator \u904d\u5386 LinkedHashMap \u65f6\uff0c\u5148\u5f97\u5230\u7684\u8bb0\u5f55\u80af\u5b9a\u662f\u5148\u63d2\u5165\u7684\u3002\u4e5f\u53ef\u4ee5\u5728\u6784\u9020\u65f6\u7528\u5e26\u53c2\u6570\uff0c\u6309\u7167\u5e94\u7528\u6b21\u6570\u6392\u5e8f\u3002\u5728\u904d\u5386\u7684\u65f6\u5019\u4f1a\u6bd4 HashMap \u6162\uff0c\u4e0d\u8fc7\u6709\u79cd\u60c5\u51b5\u4f8b\u5916\uff0c\u5f53 HashMap \u5bb9\u91cf\u5f88\u5927\uff0c\u5b9e\u9645\u6570\u636e\u8f83\u5c11\u65f6\uff0c\u904d\u5386\u8d77\u6765\u53ef\u80fd\u4f1a\u6bd4 LinkedHashMap \u6162\uff0c\u56e0\u4e3a LinkedHashMap \u7684\u904d\u5386\u901f\u5ea6\u53ea\u548c\u5b9e\u9645\u6570\u636e\u6709\u5173\uff0c\u548c\u5bb9\u91cf\u65e0\u5173\uff0c\u800c HashMap \u7684\u904d\u5386\u901f\u5ea6\u548c\u4ed6\u7684\u5bb9\u91cf\u6709\u5173\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"WeakHashMap"),"\uff1a\u4ece\u540d\u5b57\u53ef\u4ee5\u770b\u51fa\u5b83\u662f\u67d0\u79cd\xa0Map\u3002\u5b83\u7684\u7279\u6b8a\u4e4b\u5904\u5728\u4e8e\xa0WeakHashMap\xa0\u91cc\u7684 entry \u53ef\u80fd\u4f1a\u88ab GC \u81ea\u52a8\u5220\u9664\uff0c\u5373\u4f7f\u7a0b\u5e8f\u5458\u6ca1\u6709\u8c03\u7528 ",(0,l.kt)("inlineCode",{parentName:"li"},"remove()")," \u6216\u8005 ",(0,l.kt)("inlineCode",{parentName:"li"},"clear()")," \u65b9\u6cd5\u3002 WeakHashMap \u7684\u5b58\u50a8\u7ed3\u6784\u7c7b\u4f3c\u4e8eHashMap",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u65e2\u7136\u6709\xa0WeekHashMap\uff0c\u662f\u5426\u6709\xa0WeekHashSet\xa0\u5462\uff1f\u7b54\u6848\u662f\u6ca1\u6709\uff01\u4e0d\u8fc7 Java\xa0Collections \u5de5\u5177\u7c7b\u7ed9\u51fa\u4e86\u89e3\u51b3\u65b9\u6848\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"Collections.newSetFromMap(Map<E,Boolean> map)")," \u65b9\u6cd5\u53ef\u4ee5\u5c06\u4efb\u4f55\xa0Map\u5305\u88c5\u6210\u4e00\u4e2aSet\u3002")))),(0,l.kt)("h3",{id:"\u5de5\u5177\u7c7b"},"\u5de5\u5177\u7c7b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"Collections"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"Arrays"),"\uff1a\u96c6\u5408\u7c7b\u7684\u4e00\u4e2a\u5de5\u5177\u7c7b\u5e2e\u52a9\u7c7b\uff0c\u5176\u4e2d\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u9759\u6001\u65b9\u6cd5\uff0c\u7528\u4e8e\u5bf9\u96c6\u5408\u4e2d\u5143\u7d20\u8fdb\u884c\u6392\u5e8f\u3001\u641c\u7d22\u4ee5\u53ca\u7ebf\u7a0b\u5b89\u5168\u7b49\u5404\u79cd\u64cd\u4f5c\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"Comparable"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"Comparator"),"\uff1a\u4e00\u822c\u662f\u7528\u4e8e\u5bf9\u8c61\u7684\u6bd4\u8f83\u6765\u5b9e\u73b0\u6392\u5e8f\uff0c\u4e24\u8005\u7565\u6709\u533a\u522b\u3002"),(0,l.kt)("blockquote",{parentName:"li"},(0,l.kt)("ul",{parentName:"blockquote"},(0,l.kt)("li",{parentName:"ul"},"\u7c7b\u8bbe\u8ba1\u8005\u6ca1\u6709\u8003\u8651\u5230\u6bd4\u8f83\u95ee\u9898\u800c\u6ca1\u6709\u5b9e\u73b0 Comparable \u63a5\u53e3\u3002\u8fd9\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528 Comparator\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u662f\u4e0d\u9700\u8981\u6539\u53d8\u5bf9\u8c61\u7684\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u4e00\u4e2a\u96c6\u5408\u4e2d\uff0c\u6211\u4eec\u53ef\u80fd\u9700\u8981\u6709\u591a\u91cd\u7684\u6392\u5e8f\u6807\u51c6\uff0c\u8fd9\u65f6\u5019\u5982\u679c\u4f7f\u7528 Comparable \u5c31\u6709\u4e9b\u6349\u895f\u89c1\u8098\u4e86\uff0c\u53ef\u4ee5\u81ea\u5df1\u7ee7\u627f Comparator \u63d0\u4f9b\u591a\u79cd\u6807\u51c6\u7684\u6bd4\u8f83\u5668\u8fdb\u884c\u6392\u5e8f\u3002"))))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u8bf4\u660e"),"\uff1a\u7ebf\u7a0b\u4e0d\u540c\u6b65\u7684\u65f6\u5019\u53ef\u4ee5\u901a\u8fc7\uff0cCollections.synchronizedList() \u65b9\u6cd5\u6765\u5305\u88c5\u4e00\u4e2a\u7ebf\u7a0b\u540c\u6b65\u65b9\u6cd5"),(0,l.kt)("h3",{id:"\u901a\u7528\u5b9e\u73b0"},"\u901a\u7528\u5b9e\u73b0"),(0,l.kt)("table",{align:"center"},(0,l.kt)("tr",null,(0,l.kt)("td",{colspan:"2",rowspan:"2",align:"center",border:"0"}),(0,l.kt)("th",{colspan:"5",align:"center"},"Implementations")),(0,l.kt)("tr",null,(0,l.kt)("th",null,"Hash Table"),(0,l.kt)("th",null,"Resizable Array"),(0,l.kt)("th",null,"Balanced Tree"),(0,l.kt)("th",null,"Linked List"),(0,l.kt)("th",null,"Hash Table + Linked List")),(0,l.kt)("tr",null,(0,l.kt)("th",{rowspan:"4"},"Interfaces"),(0,l.kt)("th",null,"Set"),(0,l.kt)("td",null,(0,l.kt)("tt",null,"HashSet")),(0,l.kt)("td",null),(0,l.kt)("td",null,(0,l.kt)("tt",null,"TreeSet")),(0,l.kt)("td",null),(0,l.kt)("td",null,(0,l.kt)("tt",null,"LinkedHashSet"))),(0,l.kt)("tr",null,(0,l.kt)("th",null,"List"),(0,l.kt)("td",null),(0,l.kt)("td",null,(0,l.kt)("tt",null,"ArrayList")),(0,l.kt)("td",null),(0,l.kt)("td",null,(0,l.kt)("tt",null,"LinkedList")),(0,l.kt)("td",null)),(0,l.kt)("tr",null,(0,l.kt)("th",null,"Deque"),(0,l.kt)("td",null),(0,l.kt)("td",null,(0,l.kt)("tt",null,"ArrayDeque")),(0,l.kt)("td",null),(0,l.kt)("td",null,(0,l.kt)("tt",null,"LinkedList")),(0,l.kt)("td",null)),(0,l.kt)("tr",null,(0,l.kt)("th",null,"Map"),(0,l.kt)("td",null,(0,l.kt)("tt",null,"HashMap")),(0,l.kt)("td",null),(0,l.kt)("td",null,(0,l.kt)("tt",null,"TreeMap")),(0,l.kt)("td",null),(0,l.kt)("td",null,(0,l.kt)("tt",null,"LinkedHashMap")))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u53c2\u8003\u8d44\u6599\uff1a")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/CarpenterLee/JCFInternals"},"CarpenterLee/JCFInternals:\u6df1\u5165\u7406\u89e3Java\u96c6\u5408\u6846\u67b6")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://juejin.im/post/5af86ac8f265da0ba063410e"},"Java\u57fa\u7840-\u96c6\u5408\u6846\u67b6 - \u6398\u91d1"))),(0,l.kt)("h2",{id:"\u4e8c\u6df1\u5165\u6e90\u7801\u5206\u6790"},"\u4e8c\u3001\u6df1\u5165\u6e90\u7801\u5206\u6790"),(0,l.kt)("p",null,"\u6e90\u7801\u5206\u6790\u57fa\u4e8e JDK 1.8 / JDK 1.7\uff0c\u5728 IDEA \u4e2d double shift \u8c03\u51fa Search EveryWhere\uff0c\u67e5\u627e\u6e90\u7801\u6587\u4ef6\uff0c\u627e\u5230\u4e4b\u540e\u5c31\u53ef\u4ee5\u9605\u8bfb\u6e90\u7801\u3002"),(0,l.kt)("h3",{id:"arraylist"},"ArrayList"),(0,l.kt)("h4",{id:"1-\u6982\u89c8"},"1. \u6982\u89c8"),(0,l.kt)("p",null,"\u5b9e\u73b0\u4e86 RandomAccess \u63a5\u53e3\uff0c\u56e0\u6b64\u652f\u6301\u968f\u673a\u8bbf\u95ee\uff0c\u8fd9\u662f\u7406\u6240\u5f53\u7136\u7684\uff0c\u56e0\u4e3a ArrayList \u662f\u57fa\u4e8e\u6570\u7ec4\u5b9e\u73b0\u7684\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public class ArrayList<E> extends AbstractList<E>\n        implements List<E>, RandomAccess, Cloneable, java.io.Serializable\n")),(0,l.kt)("p",null,"\u6570\u7ec4\u7684\u9ed8\u8ba4\u5927\u5c0f\u4e3a 10\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"private static final int DEFAULT_CAPACITY = 10;\n")),(0,l.kt)("p",null,(0,l.kt)("img",{src:a(4345).Z,width:"800",height:"245"})),(0,l.kt)("h4",{id:"2-\u5e8f\u5217\u5316"},"2. \u5e8f\u5217\u5316"),(0,l.kt)("p",null,"\u57fa\u4e8e\u6570\u7ec4\u5b9e\u73b0\uff0c\u4fdd\u5b58\u5143\u7d20\u7684\u6570\u7ec4\u4f7f\u7528 transient \u4fee\u9970\uff0c\u8be5\u5173\u952e\u5b57\u58f0\u660e\u6570\u7ec4\u9ed8\u8ba4\u4e0d\u4f1a\u88ab\u5e8f\u5217\u5316\u3002ArrayList \u5177\u6709\u52a8\u6001\u6269\u5bb9\u7279\u6027\uff0c\u56e0\u6b64\u4fdd\u5b58\u5143\u7d20\u7684\u6570\u7ec4\u4e0d\u4e00\u5b9a\u90fd\u4f1a\u88ab\u4f7f\u7528\uff0c\u90a3\u4e48\u5c31\u6ca1\u5fc5\u8981\u5168\u90e8\u8fdb\u884c\u5e8f\u5217\u5316\u3002ArrayList \u91cd\u5199\u4e86 writeObject() \u548c readObject() \u6765\u63a7\u5236\u53ea\u5e8f\u5217\u5316\u6570\u7ec4\u4e2d\u6709\u5143\u7d20\u586b\u5145\u90a3\u90e8\u5206\u5185\u5bb9\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"transient Object[] elementData; // non-private to simplify nested class access\n")),(0,l.kt)("h4",{id:"3-\u6269\u5bb9"},"3. \u6269\u5bb9"),(0,l.kt)("p",null,"\u6dfb\u52a0\u5143\u7d20\u65f6\u4f7f\u7528 ensureCapacityInternal() \u65b9\u6cd5\u6765\u4fdd\u8bc1\u5bb9\u91cf\u8db3\u591f\uff0c\u5982\u679c\u4e0d\u591f\u65f6\uff0c\u9700\u8981\u4f7f\u7528 grow() \u65b9\u6cd5\u8fdb\u884c\u6269\u5bb9\uff0c\u65b0\u5bb9\u91cf\u7684\u5927\u5c0f\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"oldCapacity + (oldCapacity >> 1)"),"\uff0c\u4e5f\u5c31\u662f\u65e7\u5bb9\u91cf\u7684 1.5 \u500d\u3002"),(0,l.kt)("p",null,"\u6269\u5bb9\u64cd\u4f5c\u9700\u8981\u8c03\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"Arrays.copyOf()")," \u628a\u539f\u6570\u7ec4\u6574\u4e2a\u590d\u5236\u5230\u65b0\u6570\u7ec4\u4e2d\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u4ee3\u4ef7\u5f88\u9ad8\uff0c\u56e0\u6b64\u6700\u597d\u5728\u521b\u5efa ArrayList \u5bf9\u8c61\u65f6\u5c31\u6307\u5b9a\u5927\u6982\u7684\u5bb9\u91cf\u5927\u5c0f\uff0c\u51cf\u5c11\u6269\u5bb9\u64cd\u4f5c\u7684\u6b21\u6570\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"// JDK 1.8\n    \npublic boolean add(E e) {\n    ensureCapacityInternal(size + 1);  // Increments modCount!!\n    elementData[size++] = e;\n    return true;\n}\n\n// \u5224\u65ad\u6570\u7ec4\u662f\u5426\u8d8a\u754c\nprivate void ensureCapacityInternal(int minCapacity) {\n    if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {\n        minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);\n    }\n    ensureExplicitCapacity(minCapacity);\n}\n\nprivate void ensureExplicitCapacity(int minCapacity) {\n    modCount++;\n    // overflow-conscious code\n    if (minCapacity - elementData.length > 0)\n        grow(minCapacity);\n}\n\n// \u6269\u5bb9\nprivate void grow(int minCapacity) {\n    // overflow-conscious code\n    int oldCapacity = elementData.length;\n    int newCapacity = oldCapacity + (oldCapacity >> 1); // 1.5\u500d\n    if (newCapacity - minCapacity < 0)\n        newCapacity = minCapacity;\n    if (newCapacity - MAX_ARRAY_SIZE > 0)\n        newCapacity = hugeCapacity(minCapacity);\n    // minCapacity is usually close to size, so this is a win:\n    elementData = Arrays.copyOf(elementData, newCapacity);\n}\n\nprivate static int hugeCapacity(int minCapacity) {\n    if (minCapacity < 0) // overflow\n        throw new OutOfMemoryError();\n    return (minCapacity > MAX_ARRAY_SIZE) ? Integer.MAX_VALUE : MAX_ARRAY_SIZE;\n}\n")),(0,l.kt)("h4",{id:"4-\u5220\u9664\u5143\u7d20"},"4. \u5220\u9664\u5143\u7d20"),(0,l.kt)("p",null,"\u9700\u8981\u8c03\u7528 System.arraycopy() \u5c06 index+1 \u540e\u9762\u7684\u5143\u7d20\u90fd\u590d\u5236\u5230 index \u4f4d\u7f6e\u4e0a\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public E remove(int index) {\n    rangeCheck(index);\n    modCount++;\n    E oldValue = elementData(index);\n    int numMoved = size - index - 1;\n    if (numMoved > 0)\n        System.arraycopy(elementData, index+1, elementData, index, numMoved);\n    elementData[--size] = null; // clear to let GC do its work\n    return oldValue;\n}\n")),(0,l.kt)("h4",{id:"5-fail-fast"},"5. Fail-Fast"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5f00\u59cb\u4e4b\u524d\u6211\u4eec\u60f3\u8bb2\u8bb2\uff0c\u4ec0\u4e48\u662f fail-fast \u673a\u5236?")),(0,l.kt)("p",null,"fail-fast \u673a\u5236\u5728\u904d\u5386\u4e00\u4e2a\u96c6\u5408\u65f6\uff0c\u5f53\u96c6\u5408\u7ed3\u6784\u88ab\u4fee\u6539\uff0c\u4f1a\u629b\u51fa Concurrent Modification Exception\u3002"),(0,l.kt)("p",null,"fail-fast \u4f1a\u5728\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\u4e0b\u629b\u51fa Concurrent Modification Exception"),(0,l.kt)("p",null,"\uff081\uff09\u5355\u7ebf\u7a0b\u73af\u5883"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u96c6\u5408\u88ab\u521b\u5efa\u540e\uff0c\u5728\u904d\u5386\u5b83\u7684\u8fc7\u7a0b\u4e2d\u4fee\u6539\u4e86\u7ed3\u6784\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u6ce8\u610f remove() \u65b9\u6cd5\u4f1a\u8ba9 expectModcount \u548c modcount \u76f8\u7b49\uff0c\u6240\u4ee5\u662f\u4e0d\u4f1a\u629b\u51fa\u8fd9\u4e2a\u5f02\u5e38\u3002"))),(0,l.kt)("p",null,"\uff082\uff09\u591a\u7ebf\u7a0b\u73af\u5883"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5728\u904d\u5386\u8fd9\u4e2a\u96c6\u5408\uff0c\u800c\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u8fd9\u4e2a\u96c6\u5408\u7684\u7ed3\u6784\u8fdb\u884c\u4e86\u4fee\u6539\u3002")),(0,l.kt)("p",null,"modCount \u7528\u6765\u8bb0\u5f55 ArrayList \u7ed3\u6784\u53d1\u751f\u53d8\u5316\u7684\u6b21\u6570\u3002\u7ed3\u6784\u53d1\u751f\u53d8\u5316\u662f\u6307",(0,l.kt)("strong",{parentName:"p"},"\u6dfb\u52a0"),"\u6216\u8005",(0,l.kt)("strong",{parentName:"p"},"\u5220\u9664"),"\u81f3\u5c11\u4e00\u4e2a\u5143\u7d20\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u6216\u8005\u662f\u8c03\u6574\u5185\u90e8\u6570\u7ec4\u7684\u5927\u5c0f\uff0c\u4ec5\u4ec5\u53ea\u662f\u8bbe\u7f6e\u5143\u7d20\u7684\u503c\u4e0d\u7b97\u7ed3\u6784\u53d1\u751f\u53d8\u5316\u3002"),(0,l.kt)("p",null,"\u5728\u8fdb\u884c\u5e8f\u5217\u5316\u6216\u8005\u8fed\u4ee3\u7b49\u64cd\u4f5c\u65f6\uff0c\u9700\u8981\u6bd4\u8f83\u64cd\u4f5c\u524d\u540e modCount \u662f\u5426\u6539\u53d8\uff0c\u5982\u679c\u6539\u53d8\u4e86\u9700\u8981\u629b\u51fa Concurrent Modification Exception\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"private void writeObject(java.io.ObjectOutputStream s) throws java.io.IOException{\n    // Write out element count, and any hidden stuff\n    int expectedModCount = modCount;\n    s.defaultWriteObject();\n\n    // Write out size as capacity for behavioural compatibility with clone()\n    s.writeInt(size);\n\n    // Write out all elements in the proper order.\n    for (int i=0; i<size; i++) {\n        s.writeObject(elementData[i]);\n    }\n\n    if (modCount != expectedModCount) {\n        throw new ConcurrentModificationException();\n    }\n}\n")),(0,l.kt)("h3",{id:"vector"},"Vector"),(0,l.kt)("h4",{id:"1-\u540c\u6b65"},"1. \u540c\u6b65"),(0,l.kt)("p",null,"\u5b83\u7684\u5b9e\u73b0\u4e0e ArrayList \u7c7b\u4f3c\uff0c\u4f46\u662f\u4f7f\u7528\u4e86 synchronized \u8fdb\u884c\u540c\u6b65\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public synchronized boolean add(E e) {\n    modCount++;\n    ensureCapacityHelper(elementCount + 1);\n    elementData[elementCount++] = e;\n    return true;\n}\n\npublic synchronized E get(int index) {\n    if (index >= elementCount)\n        throw new ArrayIndexOutOfBoundsException(index);\n    return elementData(index);\n}\n")),(0,l.kt)("h4",{id:"2-arraylist-\u4e0e-vector"},"2. ArrayList \u4e0e Vector"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Vector \u662f\u540c\u6b65\u7684\uff0c\u56e0\u6b64\u5f00\u9500\u5c31\u6bd4 ArrayList \u8981\u5927\uff0c\u8bbf\u95ee\u901f\u5ea6\u66f4\u6162\u3002\u6700\u597d\u4f7f\u7528 ArrayList \u800c\u4e0d\u662f Vector\uff0c\u56e0\u4e3a\u540c\u6b65\u64cd\u4f5c\u5b8c\u5168\u53ef\u4ee5\u7531\u7a0b\u5e8f\u5458\u81ea\u5df1\u6765\u63a7\u5236\uff1b"),(0,l.kt)("li",{parentName:"ul"},"Vector \u6bcf\u6b21\u6269\u5bb9\u8bf7\u6c42\u5176\u5927\u5c0f\u7684 2 \u500d\u7a7a\u95f4\uff0c\u800c ArrayList \u662f 1.5 \u500d\u3002")),(0,l.kt)("h4",{id:"3-vector-\u66ff\u4ee3\u65b9\u6848"},"3. Vector \u66ff\u4ee3\u65b9\u6848"),(0,l.kt)("h5",{id:"synchronizedlist"},"synchronizedList"),(0,l.kt)("p",null,"\u4e3a\u4e86\u83b7\u5f97\u7ebf\u7a0b\u5b89\u5168\u7684 ArrayList\uff0c\u53ef\u4ee5\u4f7f\u7528  ",(0,l.kt)("inlineCode",{parentName:"p"},"Collections.synchronizedList();"),"  \u5f97\u5230\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684  ArrayList\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"List<String> list = new ArrayList<>();\nList<String> synList = Collections.synchronizedList(list);\n")),(0,l.kt)("h5",{id:"copyonwritearraylist"},"CopyOnWriteArrayList"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/cow.png",width:""})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u4e5f\u53ef\u4ee5\u4f7f\u7528 concurrent \u5e76\u53d1\u5305\u4e0b\u7684 CopyOnWriteArrayList \u7c7b\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"List<String> list = new CopyOnWriteArrayList<>();\n")),(0,l.kt)("p",null,"CopyOnWrite \u5bb9\u5668\u5373\u5199\u65f6\u590d\u5236\u7684\u5bb9\u5668\u3002\u901a\u4fd7\u7684\u7406\u89e3\u662f",(0,l.kt)("strong",{parentName:"p"},"\u5f53\u6211\u4eec\u5f80\u4e00\u4e2a\u5bb9\u5668\u6dfb\u52a0\u5143\u7d20\u7684\u65f6\u5019\uff0c\u4e0d\u76f4\u63a5\u5f80\u5f53\u524d\u5bb9\u5668\u6dfb\u52a0\uff0c\u800c\u662f\u5148\u5c06\u5f53\u524d\u5bb9\u5668\u8fdb\u884c Copy\uff0c\u590d\u5236\u51fa\u4e00\u4e2a\u65b0\u7684\u5bb9\u5668\uff0c\u7136\u540e\u65b0\u7684\u5bb9\u5668\u91cc\u6dfb\u52a0\u5143\u7d20\uff0c\u6dfb\u52a0\u5b8c\u5143\u7d20\u4e4b\u540e\uff0c\u518d\u5c06\u539f\u5bb9\u5668\u7684\u5f15\u7528\u6307\u5411\u65b0\u7684\u5bb9\u5668"),"\u3002\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\u6211\u4eec\u53ef\u4ee5\u5bf9 CopyOnWrite \u5bb9\u5668\u8fdb\u884c\u5e76\u53d1\u7684\u8bfb\uff0c\u800c\u4e0d\u9700\u8981\u52a0\u9501\uff0c\u56e0\u4e3a\u5f53\u524d\u5bb9\u5668\u4e0d\u4f1a\u6dfb\u52a0\u4efb\u4f55\u5143\u7d20\u3002\u6240\u4ee5 CopyOnWrite \u5bb9\u5668\u4e5f\u662f\u4e00\u79cd",(0,l.kt)("strong",{parentName:"p"},"\u8bfb\u5199\u5206\u79bb"),"\u7684\u601d\u60f3\uff0c\u8bfb\u548c\u5199\u4e0d\u540c\u7684\u5bb9\u5668\u3002 "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public boolean add(T e) {\n    final ReentrantLock lock = this.lock;\n    lock.lock();\n    try {\n        Object[] elements = getArray();\n        int len = elements.length;\n        // \u590d\u5236\u51fa\u65b0\u6570\u7ec4\n        Object[] newElements = Arrays.copyOf(elements, len + 1);\n        // \u628a\u65b0\u5143\u7d20\u6dfb\u52a0\u5230\u65b0\u6570\u7ec4\u91cc\n        newElements[len] = e;\n        // \u628a\u539f\u6570\u7ec4\u5f15\u7528\u6307\u5411\u65b0\u6570\u7ec4\n        setArray(newElements);\n        return true;\n    } finally {\n        lock.unlock();\n    }\n}\n\nfinal void setArray(Object[] a) {\n    array = a;\n}\n")),(0,l.kt)("p",null,"\u8bfb\u7684\u65f6\u5019\u4e0d\u9700\u8981\u52a0\u9501\uff0c\u5982\u679c\u8bfb\u7684\u65f6\u5019\u6709\u591a\u4e2a\u7ebf\u7a0b\u6b63\u5728\u5411 ArrayList \u6dfb\u52a0\u6570\u636e\uff0c\u8bfb\u8fd8\u662f\u4f1a\u8bfb\u5230\u65e7\u7684\u6570\u636e\uff0c\u56e0\u4e3a\u5199\u7684\u65f6\u5019\u4e0d\u4f1a\u9501\u4f4f\u65e7\u7684 ArrayList\u3002  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public E get(int index) {\n    return get(getArray(), index);\n}\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"CopyOnWrite\u7684\u7f3a\u70b9")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"CopyOnWrite \u5bb9\u5668\u6709\u5f88\u591a\u4f18\u70b9\uff0c\u4f46\u662f\u540c\u65f6\u4e5f\u5b58\u5728\u4e24\u4e2a\u95ee\u9898\uff0c\u5373\u5185\u5b58\u5360\u7528\u95ee\u9898\u548c\u6570\u636e\u4e00\u81f4\u6027\u95ee\u9898\u3002\u6240\u4ee5\u5728\u5f00\u53d1\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\u3002")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5185\u5b58\u5360\u7528\u95ee\u9898"),"\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u56e0\u4e3a CopyOnWrite \u7684\u5199\u65f6\u590d\u5236\u673a\u5236\uff0c\u6240\u4ee5\u5728\u8fdb\u884c\u5199\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u5185\u5b58\u91cc\u4f1a\u540c\u65f6\u9a7b\u624e\u4e24\u4e2a\u5bf9\u8c61\u7684\u5185\u5b58\uff0c\u65e7\u7684\u5bf9\u8c61\u548c\u65b0\u5199\u5165\u7684\u5bf9\u8c61\uff08\u6ce8\u610f\uff1a\u5728\u590d\u5236\u7684\u65f6\u5019\u53ea\u662f\u590d\u5236\u5bb9\u5668\u91cc\u7684\u5f15\u7528\uff0c\u53ea\u662f\u5728\u5199\u7684\u65f6\u5019\u4f1a\u521b\u5efa\u65b0\u5bf9\u8c61\u6dfb\u52a0\u5230\u65b0\u5bb9\u5668\u91cc\uff0c\u800c\u65e7\u5bb9\u5668\u7684\u5bf9\u8c61\u8fd8\u5728\u4f7f\u7528\uff0c\u6240\u4ee5\u6709\u4e24\u4efd\u5bf9\u8c61\u5185\u5b58\uff09\u3002\u5982\u679c\u8fd9\u4e9b\u5bf9\u8c61\u5360\u7528\u7684\u5185\u5b58\u6bd4\u8f83\u5927\uff0c\u6bd4\u5982\u8bf4 200M \u5de6\u53f3\uff0c\u90a3\u4e48\u518d\u5199\u5165 100M \u6570\u636e\u8fdb\u53bb\uff0c\u5185\u5b58\u5c31\u4f1a\u5360\u7528 300M\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5f88\u6709\u53ef\u80fd\u9020\u6210\u9891\u7e41\u7684 Yong GC \u548c Full GC\u3002\u4e4b\u524d\u6211\u4eec\u7cfb\u7edf\u4e2d\u4f7f\u7528\u4e86\u4e00\u4e2a\u670d\u52a1\u7531\u4e8e\u6bcf\u665a\u4f7f\u7528 CopyOnWrite \u673a\u5236\u66f4\u65b0\u5927\u5bf9\u8c61\uff0c\u9020\u6210\u4e86\u6bcf\u665a 15 \u79d2\u7684 Full GC\uff0c\u5e94\u7528\u54cd\u5e94\u65f6\u95f4\u4e5f\u968f\u4e4b\u53d8\u957f\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u9488\u5bf9\u5185\u5b58\u5360\u7528\u95ee\u9898\uff0c\u53ef\u4ee5\u901a\u8fc7\u538b\u7f29\u5bb9\u5668\u4e2d\u7684\u5143\u7d20\u7684\u65b9\u6cd5\u6765\u51cf\u5c11\u5927\u5bf9\u8c61\u7684\u5185\u5b58\u6d88\u8017\uff0c\u6bd4\u5982\uff0c\u5982\u679c\u5143\u7d20\u5168\u662f 10 \u8fdb\u5236\u7684\u6570\u5b57\uff0c\u53ef\u4ee5\u8003\u8651\u628a\u5b83\u538b\u7f29\u6210 36 \u8fdb\u5236\u6216 64 \u8fdb\u5236\u3002\u6216\u8005\u4e0d\u4f7f\u7528 CopyOnWrite \u5bb9\u5668\uff0c\u800c\u4f7f\u7528\u5176\u4ed6\u7684\u5e76\u53d1\u5bb9\u5668\uff0c\u5982  ConcurrentHashMap \u3002"))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6570\u636e\u4e00\u81f4\u6027\u95ee\u9898"),"\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"CopyOnWrite \u5bb9\u5668\u53ea\u80fd\u4fdd\u8bc1\u6570\u636e\u7684\u6700\u7ec8\u4e00\u81f4\u6027\uff0c\u4e0d\u80fd\u4fdd\u8bc1\u6570\u636e\u7684\u5b9e\u65f6\u4e00\u81f4\u6027\u3002\u6240\u4ee5\u5982\u679c\u4f60\u5e0c\u671b\u5199\u5165\u7684\u7684\u6570\u636e\uff0c\u9a6c\u4e0a\u80fd\u8bfb\u5230\uff0c\u8bf7\u4e0d\u8981\u4f7f\u7528 CopyOnWrite \u5bb9\u5668\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5173\u4e8e C++ \u7684 STL \u4e2d\uff0c\u66fe\u7ecf\u4e5f\u6709\u8fc7 Copy-On-Write \u7684\u73a9\u6cd5\uff0c\u53c2\u89c1\u9648\u7693\u7684\u300a",(0,l.kt)("a",{parentName:"p",href:"http://blog.csdn.net/haoel/article/details/24058"},"C++ STL String\u7c7b\u4e2d\u7684Copy-On-Write"),"\u300b\uff0c\u540e\u6765\uff0c\u56e0\u4e3a\u6709\u5f88\u591a\u7ebf\u7a0b\u5b89\u5168\u4e0a\u7684\u4e8b\uff0c\u5c31\u88ab\u53bb\u6389\u4e86\u3002"))),(0,l.kt)("p",null,"\u53c2\u8003\u8d44\u6599\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://ifeve.com/java-copy-on-write/"},"\u804a\u804a\u5e76\u53d1-Java\u4e2d\u7684Copy-On-Write\u5bb9\u5668 | \u5e76\u53d1\u7f16\u7a0b\u7f51 \u2013 ifeve.com"))),(0,l.kt)("h3",{id:"linkedlist"},"LinkedList"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/LinkedList_base.png",width:"600"})),(0,l.kt)("h4",{id:"1-\u6982\u89c8-1"},"1. \u6982\u89c8"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"LinkedList \u5e95\u5c42\u662f\u57fa\u4e8e\u53cc\u5411\u94fe\u8868\u5b9e\u73b0\u7684"),"\uff0c\u4e5f\u662f\u5b9e\u73b0\u4e86 List \u63a5\u53e3\uff0c\u6240\u4ee5\u4e5f\u62e5\u6709 List \u7684\u4e00\u4e9b\u7279\u70b9 (JDK1.7/8 \u4e4b\u540e\u53d6\u6d88\u4e86\u5faa\u73af\uff0c\u4fee\u6539\u4e3a\u53cc\u5411\u94fe\u8868) \u3002 "),(0,l.kt)("p",null,"LinkedList \u540c\u65f6\u5b9e\u73b0\u4e86 List \u63a5\u53e3\u548c Deque \u63a5\u53e3\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u65e2\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u987a\u5e8f\u5bb9\u5668\uff0c\u53c8\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u961f\u5217\uff08Queue\uff09\uff0c\u540c\u65f6\u53c8\u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u6808\uff08Stack\uff09\u3002\u8fd9\u6837\u770b\u6765\uff0c LinkedList \u7b80\u76f4\u5c31\u662f\u4e2a\u5168\u80fd\u51a0\u519b\u3002\u5f53\u4f60\u9700\u8981\u4f7f\u7528\u6808\u6216\u8005\u961f\u5217\u65f6\uff0c\u53ef\u4ee5\u8003\u8651\u4f7f\u7528 LinkedList \uff0c\u4e00\u65b9\u9762\u662f\u56e0\u4e3a Java \u5b98\u65b9\u5df2\u7ecf\u58f0\u660e\u4e0d\u5efa\u8bae\u4f7f\u7528 Stack \u7c7b\uff0c\u66f4\u9057\u61be\u7684\u662f\uff0cJava\u91cc\u6839\u672c\u6ca1\u6709\u4e00\u4e2a\u53eb\u505a Queue \u7684\u7c7b\uff08\u5b83\u662f\u4e2a\u63a5\u53e3\u540d\u5b57\uff09\u3002"),(0,l.kt)("p",null,"\u5173\u4e8e\u6808\u6216\u961f\u5217\uff0c\u73b0\u5728\u7684\u9996\u9009\u662f ArrayDeque\uff0c\u5b83\u6709\u7740\u6bd4 LinkedList \uff08\u5f53\u4f5c\u6808\u6216\u961f\u5217\u4f7f\u7528\u65f6\uff09\u6709\u7740\u66f4\u597d\u7684\u6027\u80fd\u3002 "),(0,l.kt)("p",null,"\u57fa\u4e8e\u53cc\u5411\u94fe\u8868\u5b9e\u73b0\uff0c\u5185\u90e8\u4f7f\u7528 Node \u6765\u5b58\u50a8\u94fe\u8868\u8282\u70b9\u4fe1\u606f\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"private static class Node<E> {\n    E item;\n    Node<E> next;\n    Node<E> prev;\n}\n")),(0,l.kt)("p",null,"\u6bcf\u4e2a\u94fe\u8868\u5b58\u50a8\u4e86 Head \u548c Tail \u6307\u9488\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"transient Node<E> first;\ntransient Node<E> last;\n")),(0,l.kt)("p",null,"LinkedList \u7684\u5b9e\u73b0\u65b9\u5f0f\u51b3\u5b9a\u4e86\u6240\u6709\u8ddf\u4e0b\u6807\u76f8\u5173\u7684\u64cd\u4f5c\u90fd\u662f\u7ebf\u6027\u65f6\u95f4\uff0c\u800c\u5728\u9996\u6bb5\u6216\u8005\u672b\u5c3e\u5220\u9664\u5143\u7d20\u53ea\u9700\u8981\u5e38\u6570\u65f6\u95f4\u3002\u4e3a\u8ffd\u6c42\u6548\u7387",(0,l.kt)("em",{parentName:"p"},"LinkedList"),"\u6ca1\u6709\u5b9e\u73b0\u540c\u6b65\uff08synchronized\uff09\uff0c\u5982\u679c\u9700\u8981\u591a\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u8bbf\u95ee\uff0c\u53ef\u4ee5\u5148\u91c7\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"Collections.synchronizedList()")," \u65b9\u6cd5\u5bf9\u5176\u8fdb\u884c\u5305\u88c5\u3002 "),(0,l.kt)("h4",{id:"2-add"},"2. add()"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/LinkedList_add.png",width:"600"})),(0,l.kt)("p",null,"add() \u65b9\u6cd5\u6709\u4e24\u4e2a\u7248\u672c\uff0c\u4e00\u4e2a\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"add(E e)"),"\uff0c\u8be5\u65b9\u6cd5\u5728 LinkedList \u7684\u672b\u5c3e\u63d2\u5165\u5143\u7d20\uff0c\u56e0\u4e3a\u6709 last \u6307\u5411\u94fe\u8868\u672b\u5c3e\uff0c\u5728\u672b\u5c3e\u63d2\u5165\u5143\u7d20\u7684\u82b1\u8d39\u662f\u5e38\u6570\u65f6\u95f4\u3002\u53ea\u9700\u8981\u7b80\u5355\u4fee\u6539\u51e0\u4e2a\u76f8\u5173\u5f15\u7528\u5373\u53ef\uff1b\u53e6\u4e00\u4e2a\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"add(int index, E element)"),"\uff0c\u8be5\u65b9\u6cd5\u662f\u5728\u6307\u5b9a\u4e0b\u8868\u5904\u63d2\u5165\u5143\u7d20\uff0c\u9700\u8981\u5148\u901a\u8fc7\u7ebf\u6027\u67e5\u627e\u627e\u5230\u5177\u4f53\u4f4d\u7f6e\uff0c\u7136\u540e\u4fee\u6539\u76f8\u5173\u5f15\u7528\u5b8c\u6210\u63d2\u5165\u64cd\u4f5c\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"// JDK 1.8\npublic boolean add(E e) {\n    linkLast(e);\n    return true;\n}\n\n/**\n* Links e as last element.\n*/\nvoid linkLast(E e) {\n    final Node<E> l = last;\n    final Node<E> newNode = new Node<>(l, e, null);\n    last = newNode;\n    if (l == null)\n        first = newNode;\n    else\n        l.next = newNode;\n    size++;\n    modCount++;\n}\n\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"add(int index, E element)")," \u7684\u903b\u8f91\u7a0d\u663e\u590d\u6742\uff0c\u53ef\u4ee5\u5206\u6210\u4e24\u90e8\u5206"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5148\u6839\u636e index \u627e\u5230\u8981\u63d2\u5165\u7684\u4f4d\u7f6e\uff1b")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u4fee\u6539\u5f15\u7528\uff0c\u5b8c\u6210\u63d2\u5165\u64cd\u4f5c\u3002"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public void add(int index, E element) {\n    checkPositionIndex(index);\n    if (index == size)\n        linkLast(element);\n    else\n        linkBefore(element, node(index));\n}\n\nprivate void checkPositionIndex(int index) {\n    if (!isPositionIndex(index))\n        throw new IndexOutOfBoundsException(outOfBoundsMsg(index));\n}\n")),(0,l.kt)("p",null,"\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"node(int index)")," \u51fd\u6570\u6709\u4e00\u70b9\u5c0f\u5c0f\u7684 trick\uff0c\u56e0\u4e3a\u94fe\u8868\u53cc\u5411\u7684\uff0c\u53ef\u4ee5\u4ece\u5f00\u59cb\u5f80\u540e\u627e\uff0c\u4e5f\u53ef\u4ee5\u4ece\u7ed3\u5c3e\u5f80\u524d\u627e\uff0c\u5177\u4f53\u671d\u90a3\u4e2a\u65b9\u5411\u627e\u53d6\u51b3\u4e8e\u6761\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"index < (size >> 1)"),"\uff0c\u4e5f\u5373\u662f index \u662f\u9760\u8fd1\u524d\u7aef\u8fd8\u662f\u540e\u7aef\u3002"),(0,l.kt)("h4",{id:"3-remove"},"3. remove()"),(0,l.kt)("p",null,"remove() \u65b9\u6cd5\u4e5f\u6709\u4e24\u4e2a\u7248\u672c\uff0c\u4e00\u4e2a\u662f\u5220\u9664\u8ddf\u6307\u5b9a\u5143\u7d20\u76f8\u7b49\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20 ",(0,l.kt)("inlineCode",{parentName:"p"},"remove(Object o)"),"\uff0c\u53e6\u4e00\u4e2a\u662f\u5220\u9664\u6307\u5b9a\u4e0b\u6807\u5904\u7684\u5143\u7d20 ",(0,l.kt)("inlineCode",{parentName:"p"},"remove(int index)"),"\u3002"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/LinkedList_remove.png",width:"600"})),(0,l.kt)("p",null,"\u4e24\u4e2a\u5220\u9664\u64cd\u4f5c\u90fd\u8981\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5148\u627e\u5230\u8981\u5220\u9664\u5143\u7d20\u7684\u5f15\u7528\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u4fee\u6539\u76f8\u5173\u5f15\u7528\uff0c\u5b8c\u6210\u5220\u9664\u64cd\u4f5c\u3002")),(0,l.kt)("p",null,"\u5728\u5bfb\u627e\u88ab\u5220\u5143\u7d20\u5f15\u7528\u7684\u65f6\u5019 ",(0,l.kt)("inlineCode",{parentName:"p"},"remove(Object o)")," \u8c03\u7528\u7684\u662f\u5143\u7d20\u7684 equals \u65b9\u6cd5\uff0c\u800c ",(0,l.kt)("inlineCode",{parentName:"p"},"remove(int index)")," \u4f7f\u7528\u7684\u662f\u4e0b\u6807\u8ba1\u6570\uff0c\u4e24\u79cd\u65b9\u5f0f\u90fd\u662f\u7ebf\u6027\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u5728\u6b65\u9aa4 2 \u4e2d\uff0c\u4e24\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"revome()")," \u65b9\u6cd5\u90fd\u662f\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"unlink(Node<E> x)")," \u65b9\u6cd5\u5b8c\u6210\u7684\u3002\u8fd9\u91cc\u9700\u8981\u8003\u8651\u5220\u9664\u5143\u7d20\u662f\u7b2c\u4e00\u4e2a\u6216\u8005\u6700\u540e\u4e00\u4e2a\u65f6\u7684\u8fb9\u754c\u60c5\u51b5\u3002  "),(0,l.kt)("h4",{id:"4-get"},"4. get()"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public E get(int index) {\n    checkElementIndex(index);\n    return node(index).item;\n}\n    \nNode<E> node(int index) {\n    // assert isElementIndex(index);\n    if (index < (size >> 1)) {\n        Node<E> x = first;\n        for (int i = 0; i < index; i++)\n            x = x.next;\n        return x;\n    } else {\n        Node<E> x = last;\n        for (int i = size - 1; i > index; i--)\n            x = x.prev;\n        return x;\n    }\n}\n")),(0,l.kt)("p",null,"\u7531\u6b64\u53ef\u4ee5\u770b\u51fa\u662f\u4f7f\u7528\u4e8c\u5206\u67e5\u627e\u6765\u770b ",(0,l.kt)("inlineCode",{parentName:"p"},"index")," \u79bb size \u4e2d\u95f4\u8ddd\u79bb\u6765\u5224\u65ad\u662f\u4ece\u5934\u7ed3\u70b9\u6b63\u5e8f\u67e5\u8fd8\u662f\u4ece\u5c3e\u8282\u70b9\u5012\u5e8f\u67e5\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"node() \u4f1a\u4ee5 ",(0,l.kt)("inlineCode",{parentName:"li"},"O(n/2)")," \u7684\u6027\u80fd\u53bb\u83b7\u53d6\u4e00\u4e2a\u7ed3\u70b9",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u7d22\u5f15\u503c\u5927\u4e8e\u94fe\u8868\u5927\u5c0f\u7684\u4e00\u534a\uff0c\u90a3\u4e48\u5c06\u4ece\u5c3e\u7ed3\u70b9\u5f00\u59cb\u904d\u5386")))),(0,l.kt)("p",null,"\u8fd9\u6837\u7684\u6548\u7387\u662f\u975e\u5e38\u4f4e\u7684\uff0c\u7279\u522b\u662f\u5f53 index \u8d8a\u63a5\u8fd1 size \u7684\u4e2d\u95f4\u503c\u65f6\u3002"),(0,l.kt)("h4",{id:"5-\u603b\u7ed3"},"5. \u603b\u7ed3"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"LinkedList \u63d2\u5165\uff0c\u5220\u9664\u90fd\u662f\u79fb\u52a8\u6307\u9488\u6548\u7387\u5f88\u9ad8\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u67e5\u627e\u9700\u8981\u8fdb\u884c\u904d\u5386\u67e5\u8be2\uff0c\u6548\u7387\u8f83\u4f4e\u3002")),(0,l.kt)("h4",{id:"6-arraylist-\u4e0e-linkedlist"},"6. ArrayList \u4e0e LinkedList"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"ArrayList \u57fa\u4e8e\u52a8\u6001\u6570\u7ec4\u5b9e\u73b0\uff0cLinkedList \u57fa\u4e8e\u53cc\u5411\u94fe\u8868\u5b9e\u73b0\uff1b"),(0,l.kt)("li",{parentName:"ul"},"ArrayList \u652f\u6301\u968f\u673a\u8bbf\u95ee\uff0cLinkedList \u4e0d\u652f\u6301\uff1b"),(0,l.kt)("li",{parentName:"ul"},"LinkedList \u5728\u4efb\u610f\u4f4d\u7f6e\u6dfb\u52a0\u5220\u9664\u5143\u7d20\u66f4\u5feb\u3002")),(0,l.kt)("h3",{id:"hashmap"},"HashMap"),(0,l.kt)("p",null,"\u6211\u4eec\u8fd9\u7bc7\u6587\u7ae0\u5c31\u6765\u8bd5\u7740\u5206\u6790\u4e0b HashMap \u7684\u6e90\u7801\uff0c\u7531\u4e8e HashMap \u5e95\u5c42\u6d89\u53ca\u5230\u592a\u591a\u65b9\u9762\uff0c\u4e00\u7bc7\u6587\u7ae0\u603b\u662f\u4e0d\u80fd\u9762\u9762\u4ff1\u5230\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5e26\u7740\u9762\u8bd5\u5b98\u5e38\u95ee\u7684\u51e0\u4e2a\u95ee\u9898\u53bb\u770b\u6e90\u7801\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u4e86\u89e3\u5e95\u5c42\u5982\u4f55\u5b58\u50a8\u6570\u636e\u7684"),(0,l.kt)("li",{parentName:"ol"},"HashMap \u7684\u51e0\u4e2a\u4e3b\u8981\u65b9\u6cd5"),(0,l.kt)("li",{parentName:"ol"},"HashMap \u662f\u5982\u4f55\u786e\u5b9a\u5143\u7d20\u5b58\u50a8\u4f4d\u7f6e\u7684\u4ee5\u53ca\u5982\u4f55\u5904\u7406\u54c8\u5e0c\u51b2\u7a81\u7684"),(0,l.kt)("li",{parentName:"ol"},"HashMap \u6269\u5bb9\u673a\u5236\u662f\u600e\u6837\u7684"),(0,l.kt)("li",{parentName:"ol"},"JDK 1.8 \u5728\u6269\u5bb9\u548c\u89e3\u51b3\u54c8\u5e0c\u51b2\u7a81\u4e0a\u5bf9 HashMap \u6e90\u7801\u505a\u4e86\u54ea\u4e9b\u6539\u52a8\uff1f\u6709\u4ec0\u4e48\u597d\u5904?")),(0,l.kt)("p",null,"HashMap \u7684\u5185\u90e8\u529f\u80fd\u5b9e\u73b0\u5f88\u591a\uff0c\u672c\u6587\u4e3b\u8981\u4ece\u6839\u636e key \u83b7\u53d6\u54c8\u5e0c\u6876\u6570\u7ec4\u7d22\u5f15\u4f4d\u7f6e\u3001put \u65b9\u6cd5\u7684\u8be6\u7ec6\u6267\u884c\u3001\u6269\u5bb9\u8fc7\u7a0b\u4e09\u4e2a\u5177\u6709\u4ee3\u8868\u6027\u7684\u70b9\u6df1\u5165\u5c55\u5f00\u8bb2\u89e3\u3002"),(0,l.kt)("h4",{id:"1-\u5b58\u50a8\u7ed3\u6784"},"1. \u5b58\u50a8\u7ed3\u6784"),(0,l.kt)("h5",{id:"jdk17-\u7684\u5b58\u50a8\u7ed3\u6784"},"JDK1.7 \u7684\u5b58\u50a8\u7ed3\u6784"),(0,l.kt)("p",null,"\u5728 1.7 \u4e4b\u524d JDK \u91c7\u7528\u300c\u62c9\u94fe\u6cd5\u300d\u6765\u5b58\u50a8\u6570\u636e\uff0c\u5373\u6570\u7ec4\u548c\u94fe\u8868\u7ed3\u5408\u7684\u65b9\u5f0f\uff1a"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashmap-link.jpg",width:"550"})),(0,l.kt)("p",null," \u300c\u62c9\u94fe\u6cd5\u300d\u7528\u4e13\u4e1a\u70b9\u7684\u540d\u8bcd\u6765\u8bf4\u53eb\u505a",(0,l.kt)("strong",{parentName:"p"},"\u94fe\u5730\u5740\u6cd5"),"\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u6570\u7ec4\u52a0\u94fe\u8868\u7684\u7ed3\u5408\u3002\u5728\u6bcf\u4e2a\u6570\u7ec4\u5143\u7d20\u4e0a\u5b58\u50a8\u7684\u90fd\u662f\u4e00\u4e2a\u94fe\u8868\u3002"),(0,l.kt)("p",null,"\u6211\u4eec\u4e4b\u524d\u8bf4\u5230\u4e0d\u540c\u7684 key \u53ef\u80fd\u7ecf\u8fc7 hash \u8fd0\u7b97\u53ef\u80fd\u4f1a\u5f97\u5230\u76f8\u540c\u7684\u5730\u5740\uff0c\u4f46\u662f\u4e00\u4e2a\u6570\u7ec4\u5355\u4f4d\u4e0a\u53ea\u80fd\u5b58\u653e\u4e00\u4e2a\u5143\u7d20\uff0c\u91c7\u7528\u94fe\u5730\u5740\u6cd5\u4ee5\u540e\uff0c\u5982\u679c\u9047\u5230\u76f8\u540c\u7684 hash \u503c\u7684 key \u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u653e\u5230\u4f5c\u4e3a\u6570\u7ec4\u5143\u7d20\u7684\u94fe\u8868\u4e0a\u3002\u5f85\u6211\u4eec\u53bb\u53d6\u5143\u7d20\u7684\u65f6\u5019\u901a\u8fc7 hash \u8fd0\u7b97\u7684\u7ed3\u679c\u627e\u5230\u8fd9\u4e2a\u94fe\u8868\uff0c\u518d\u5728\u94fe\u8868\u4e2d\u627e\u5230\u4e0e key \u76f8\u540c\u7684\u8282\u70b9\uff0c\u5c31\u80fd\u627e\u5230 key \u76f8\u5e94\u7684\u503c\u4e86\u3002"),(0,l.kt)("p",null,"JDK1.7 \u4e2d\u65b0\u6dfb\u52a0\u8fdb\u6765\u7684\u5143\u7d20\u603b\u662f\u653e\u5728\u6570\u7ec4\u76f8\u5e94\u7684\u89d2\u6807\u4f4d\u7f6e\uff0c\u800c\u539f\u6765\u5904\u4e8e\u8be5\u89d2\u6807\u7684\u4f4d\u7f6e\u7684\u8282\u70b9\u4f5c\u4e3a next \u8282\u70b9\u653e\u5230\u65b0\u8282\u70b9\u7684\u540e\u8fb9\u3002\u7a0d\u540e\u901a\u8fc7\u6e90\u7801\u5206\u6790\u6211\u4eec\u4e5f\u80fd\u770b\u5230\u8fd9\u4e00\u70b9\u3002"),(0,l.kt)("h5",{id:"jdk18-\u7684\u5b58\u50a8\u7ed3\u6784"},"JDK1.8 \u7684\u5b58\u50a8\u7ed3\u6784"),(0,l.kt)("p",null,"\u5bf9\u4e8e JDK1.8 \u4e4b\u540e\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"HashMap")," \u5e95\u5c42\u5728\u89e3\u51b3\u54c8\u5e0c\u51b2\u7a81\u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u5355\u5355\u662f\u4f7f\u7528\u6570\u7ec4\u52a0\u4e0a\u5355\u94fe\u8868\u7684\u7ec4\u5408\u4e86\uff0c\u56e0\u4e3a\u5f53\u5904\u7406\u5982\u679c hash \u503c\u51b2\u7a81\u8f83\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u94fe\u8868\u7684\u957f\u5ea6\u5c31\u4f1a\u8d8a\u6765\u8d8a\u957f\uff0c\u6b64\u65f6\u901a\u8fc7\u5355\u94fe\u8868\u6765\u5bfb\u627e\u5bf9\u5e94 Key \u5bf9\u5e94\u7684 Value \u7684\u65f6\u5019\u5c31\u4f1a\u4f7f\u5f97\u65f6\u95f4\u590d\u6742\u5ea6\u8fbe\u5230 O(n)\uff0c\u56e0\u6b64\u5728 JDK1.8 \u4e4b\u540e\uff0c\u5728\u94fe\u8868\u65b0\u589e\u8282\u70b9\u5bfc\u81f4\u94fe\u8868\u957f\u5ea6\u8d85\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"TREEIFY_THRESHOLD = 8"),"  \u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u5728\u6dfb\u52a0\u5143\u7d20\u7684\u540c\u65f6\u5c06\u539f\u6765\u7684\u5355\u94fe\u8868\u8f6c\u5316\u4e3a\u7ea2\u9ed1\u6811\u3002"),(0,l.kt)("p",null,"\u5bf9\u6570\u636e\u7ed3\u6784\u5f88\u5728\u884c\u7684\u8bfb\u8005\u5e94\u8be5\uff0c\u77e5\u9053\u7ea2\u9ed1\u6811\u662f\u4e00\u79cd\u6613\u4e8e\u589e\u5220\u6539\u67e5\u7684\u4e8c\u53c9\u6811\uff0c\u4ed6\u5bf9\u4e0e\u6570\u636e\u7684\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"O(logn)")," \u7ea7\u522b\uff0c\u6240\u4ee5\u5229\u7528\u7ea2\u9ed1\u6811\u7684\u7279\u70b9\u5c31\u53ef\u4ee5\u66f4\u9ad8\u6548\u7684\u5bf9 ",(0,l.kt)("inlineCode",{parentName:"p"},"HashMap")," \u4e2d\u7684\u5143\u7d20\u8fdb\u884c\u64cd\u4f5c\u3002"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashmap-rb-link.jpg",width:"550"})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u4ece\u7ed3\u6784\u5b9e\u73b0\u6765\u8bb2\uff0cHashMap \u662f\u6570\u7ec4+\u94fe\u8868+\u7ea2\u9ed1\u6811\uff08JDK1.8\u589e\u52a0\u4e86\u7ea2\u9ed1\u6811\u90e8\u5206\uff09\u5b9e\u73b0\u7684\uff0c\u5982\u4e0b\u5982\u6240\u793a\u3002 "),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashMap-datastruct.png",width:"400"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u8fd9\u91cc\u9700\u8981\u8bb2\u660e\u767d\u4e24\u4e2a\u95ee\u9898\uff1a\u6570\u636e\u5e95\u5c42\u5177\u4f53\u5b58\u50a8\u7684\u662f\u4ec0\u4e48\uff1f\u8fd9\u6837\u7684\u5b58\u50a8\u65b9\u5f0f\u6709\u4ec0\u4e48\u4f18\u70b9\u5462\uff1f")," "),(0,l.kt)("p",null,"\uff081\uff09\u4ece\u6e90\u7801\u53ef\u77e5\uff0cHashMap \u7c7b\u4e2d\u6709\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u5b57\u6bb5\uff0c\u5c31\u662f Node[] table\uff0c\u5373\u54c8\u5e0c\u6876\u6570\u7ec4\uff0c\u660e\u663e\u5b83\u662f\u4e00\u4e2a Node \u7684\u6570\u7ec4\u3002\u6211\u4eec\u6765\u770b Node\uff08 JDK1.8 \u4e2d\uff09 \u662f\u4f55\u7269\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"static class Node<K,V> implements Map.Entry<K,V> {\n    final int hash;    //\u7528\u6765\u5b9a\u4f4d\u6570\u7ec4\u7d22\u5f15\u4f4d\u7f6e\n    final K key;\n    V value;\n    Node<K,V> next;   //\u94fe\u8868\u7684\u4e0b\u4e00\u4e2anode\n\n    Node(int hash, K key, V value, Node<K,V> next) { ... }\n    public final K getKey(){ ... }\n    public final V getValue() { ... }\n    public final String toString() { ... }\n    public final int hashCode() { ... }\n    public final V setValue(V newValue) { ... }\n    public final boolean equals(Object o) { ... }\n}\n")),(0,l.kt)("p",null,"Node \u662f HashMap \u7684\u4e00\u4e2a\u5185\u90e8\u7c7b\uff0c\u5b9e\u73b0\u4e86 Map.Entry \u63a5\u53e3\uff0c\u672c\u8d28\u662f\u5c31\u662f\u4e00\u4e2a\u6620\u5c04\uff08\u952e\u503c\u5bf9\uff09\u3002\u4e0a\u56fe\u4e2d\u7684\u6bcf\u4e2a\u9ed1\u8272\u5706\u70b9\u5c31\u662f\u4e00\u4e2aNode\u5bf9\u8c61\u3002"),(0,l.kt)("p",null,"\uff082\uff09HashMap \u5c31\u662f\u4f7f\u7528\u54c8\u5e0c\u8868\u6765\u5b58\u50a8\u7684\u3002\u54c8\u5e0c\u8868\u4e3a\u89e3\u51b3\u51b2\u7a81\uff0c\u53ef\u4ee5\u91c7\u7528",(0,l.kt)("strong",{parentName:"p"},"\u5f00\u653e\u5730\u5740\u6cd5"),"\u548c",(0,l.kt)("strong",{parentName:"p"},"\u94fe\u5730\u5740\u6cd5"),"\u7b49\u6765\u89e3\u51b3\u95ee\u9898\uff0c Java \u4e2d HashMap \u91c7\u7528\u4e86\u94fe\u5730\u5740\u6cd5\u3002\u94fe\u5730\u5740\u6cd5\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u6570\u7ec4\u52a0\u94fe\u8868\u7684\u7ed3\u5408\u3002\u5728\u6bcf\u4e2a\u6570\u7ec4\u5143\u7d20\u4e0a\u90fd\u4e00\u4e2a\u94fe\u8868\u7ed3\u6784\uff0c\u5f53\u6570\u636e\u88ab Hash \u540e\uff0c\u5f97\u5230\u6570\u7ec4\u4e0b\u6807\uff0c\u628a\u6570\u636e\u653e\u5728\u5bf9\u5e94\u4e0b\u6807\u5143\u7d20\u7684\u94fe\u8868\u4e0a\u3002\u4f8b\u5982\u7a0b\u5e8f\u6267\u884c\u4e0b\u9762\u4ee3\u7801\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'map.put("\u7f8e\u56e2","\u5c0f\u7f8e");\n')),(0,l.kt)("p",null,'\u7cfb\u7edf\u5c06\u8c03\u7528 "\u7f8e\u56e2" \u8fd9\u4e2a key \u7684 hashCode() \u65b9\u6cd5\u5f97\u5230\u5176 hashCode \u503c\uff08\u8be5\u65b9\u6cd5\u9002\u7528\u4e8e\u6bcf\u4e2a Java \u5bf9\u8c61\uff09\uff0c\u7136\u540e\u518d\u901a\u8fc7 Hash \u7b97\u6cd5\u7684\u540e\u4e24\u6b65\u8fd0\u7b97\uff08\u9ad8\u4f4d\u8fd0\u7b97\u548c\u53d6\u6a21\u8fd0\u7b97\uff0c\u4e0b\u6587\u6709\u4ecb\u7ecd\uff09\u6765\u5b9a\u4f4d\u8be5\u952e\u503c\u5bf9\u7684\u5b58\u50a8\u4f4d\u7f6e\uff0c\u6709\u65f6\u4e24\u4e2a key \u4f1a\u5b9a\u4f4d\u5230\u76f8\u540c\u7684\u4f4d\u7f6e\uff0c\u8868\u793a\u53d1\u751f\u4e86 Hash \u78b0\u649e\u3002\u5f53\u7136 Hash \u7b97\u6cd5\u8ba1\u7b97\u7ed3\u679c\u8d8a\u5206\u6563\u5747\u5300\uff0cHash \u78b0\u649e\u7684\u6982\u7387\u5c31\u8d8a\u5c0f\uff0cmap \u7684\u5b58\u53d6\u6548\u7387\u5c31\u4f1a\u8d8a\u9ad8\u3002'),(0,l.kt)("p",null,"\u5982\u679c\u54c8\u5e0c\u6876\u6570\u7ec4\u5f88\u5927\uff0c\u5373\u4f7f\u8f83\u5dee\u7684 Hash \u7b97\u6cd5\u4e5f\u4f1a\u6bd4\u8f83\u5206\u6563\uff0c\u5982\u679c\u54c8\u5e0c\u6876\u6570\u7ec4\u6570\u7ec4\u5f88\u5c0f\uff0c\u5373\u4f7f\u597d\u7684 Hash \u7b97\u6cd5\u4e5f\u4f1a\u51fa\u73b0\u8f83\u591a\u78b0\u649e\uff0c\u6240\u4ee5\u5c31\u9700\u8981\u5728\u7a7a\u95f4\u6210\u672c\u548c\u65f6\u95f4\u6210\u672c\u4e4b\u95f4\u6743\u8861\uff0c\u5176\u5b9e\u5c31\u662f\u5728\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u786e\u5b9a\u54c8\u5e0c\u6876\u6570\u7ec4\u7684\u5927\u5c0f\uff0c\u5e76\u5728\u6b64\u57fa\u7840\u4e0a\u8bbe\u8ba1\u597d\u7684 hash \u7b97\u6cd5\u51cf\u5c11 Hash \u78b0\u649e\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u90a3\u4e48\u901a\u8fc7\u4ec0\u4e48\u65b9\u5f0f\u6765\u63a7\u5236 map \u4f7f\u5f97 Hash \u78b0\u649e\u7684\u6982\u7387\u53c8\u5c0f\uff0c\u54c8\u5e0c\u6876\u6570\u7ec4\uff08Node[] table\uff09\u5360\u7528\u7a7a\u95f4\u53c8\u5c11\u5462\uff1f")),(0,l.kt)("p",null,"\u7b54\u6848\u5c31\u662f\u597d\u7684 Hash \u7b97\u6cd5\u548c\u6269\u5bb9\u673a\u5236\u3002"),(0,l.kt)("p",null,"\u5728\u7406\u89e3 Hash \u548c\u6269\u5bb9\u6d41\u7a0b\u4e4b\u524d\uff0c\u6211\u4eec\u5f97\u5148\u4e86\u89e3\u4e0b HashMap \u7684\u51e0\u4e2a\u5b57\u6bb5\u3002\u4ece HashMap \u7684\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\u6e90\u7801\u53ef\u77e5\uff0c\u6784\u9020\u51fd\u6570\u5c31\u662f\u5bf9\u4e0b\u9762\u51e0\u4e2a\u5b57\u6bb5\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u6e90\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"int threshold;             // \u6240\u80fd\u5bb9\u7eb3\u7684key-value\u5bf9\u6781\u9650 \nfinal float loadFactor;    // \u8d1f\u8f7d\u56e0\u5b50\nint modCount;  \nint size;\n")),(0,l.kt)("p",null,"\u9996\u5148\uff0c",(0,l.kt)("strong",{parentName:"p"},"Node[] table\u7684\u521d\u59cb\u5316\u957f\u5ea6 length (\u9ed8\u8ba4\u503c\u662f16)"),"\uff0c",(0,l.kt)("strong",{parentName:"p"},"Load factor \u4e3a\u8d1f\u8f7d\u56e0\u5b50(\u9ed8\u8ba4\u503c\u662f0.75)"),"\uff0cthreshold \u662f HashMap \u6240\u80fd\u5bb9\u7eb3\u7684\u6700\u5927\u6570\u636e\u91cf\u7684 Node (\u952e\u503c\u5bf9)\u4e2a\u6570\u3002",(0,l.kt)("strong",{parentName:"p"},"threshold = length * Load factor"),"\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u6570\u7ec4\u5b9a\u4e49\u597d\u957f\u5ea6\u4e4b\u540e\uff0c\u8d1f\u8f7d\u56e0\u5b50\u8d8a\u5927\uff0c\u6240\u80fd\u5bb9\u7eb3\u7684\u952e\u503c\u5bf9\u4e2a\u6570\u8d8a\u591a\u3002"),(0,l.kt)("p",null,"\u7ed3\u5408\u8d1f\u8f7d\u56e0\u5b50\u7684\u5b9a\u4e49\u516c\u5f0f\u53ef\u77e5\uff0cthreshold \u5c31\u662f\u5728\u6b64 Load factor \u548c length (\u6570\u7ec4\u957f\u5ea6)\u5bf9\u5e94\u4e0b\u5141\u8bb8\u7684\u6700\u5927\u5143\u7d20\u6570\u76ee\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u6570\u76ee\u5c31\u91cd\u65b0 resize(\u6269\u5bb9)\uff0c\u6269\u5bb9\u540e\u7684 HashMap \u5bb9\u91cf\u662f\u4e4b\u524d\u5bb9\u91cf\u7684\u4e24\u500d\u3002\u9ed8\u8ba4\u7684\u8d1f\u8f7d\u56e0\u5b50 0.75 \u662f\u5bf9\u7a7a\u95f4\u548c\u65f6\u95f4\u6548\u7387\u7684\u4e00\u4e2a\u5e73\u8861\u9009\u62e9\uff0c\u5efa\u8bae\u5927\u5bb6\u4e0d\u8981\u4fee\u6539\uff0c\u9664\u975e\u5728\u65f6\u95f4\u548c\u7a7a\u95f4\u6bd4\u8f83\u7279\u6b8a\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u5185\u5b58\u7a7a\u95f4\u5f88\u591a\u800c\u53c8\u5bf9\u65f6\u95f4\u6548\u7387\u8981\u6c42\u5f88\u9ad8\uff0c\u53ef\u4ee5\u964d\u4f4e\u8d1f\u8f7d\u56e0\u5b50 Load factor \u7684\u503c\uff1b\u76f8\u53cd\uff0c\u5982\u679c\u5185\u5b58\u7a7a\u95f4\u7d27\u5f20\u800c\u5bf9\u65f6\u95f4\u6548\u7387\u8981\u6c42\u4e0d\u9ad8\uff0c\u53ef\u4ee5\u589e\u52a0\u8d1f\u8f7d\u56e0\u5b50 loadFactor \u7684\u503c\uff0c\u8fd9\u4e2a\u503c\u53ef\u4ee5\u5927\u4e8e1\u3002"),(0,l.kt)("p",null,"size \u8fd9\u4e2a\u5b57\u6bb5\u5176\u5b9e\u5f88\u597d\u7406\u89e3\uff0c\u5c31\u662f HashMap \u4e2d\u5b9e\u9645\u5b58\u5728\u7684\u952e\u503c\u5bf9\u6570\u91cf\u3002\u6ce8\u610f\u548c table \u7684\u957f\u5ea6 length\u3001\u5bb9\u7eb3\u6700\u5927\u952e\u503c\u5bf9\u6570\u91cf threshold \u7684\u533a\u522b\u3002\u800c modCount \u5b57\u6bb5\u4e3b\u8981\u7528\u6765\u8bb0\u5f55 HashMap \u5185\u90e8\u7ed3\u6784\u53d1\u751f\u53d8\u5316\u7684\u6b21\u6570\uff0c\u4e3b\u8981\u7528\u4e8e\u8fed\u4ee3\u7684\u5feb\u901f\u5931\u8d25\u3002\u5f3a\u8c03\u4e00\u70b9\uff0c\u5185\u90e8\u7ed3\u6784\u53d1\u751f\u53d8\u5316\u6307\u7684\u662f\u7ed3\u6784\u53d1\u751f\u53d8\u5316\uff0c\u4f8b\u5982 put \u65b0\u952e\u503c\u5bf9\uff0c\u4f46\u662f\u67d0\u4e2a key \u5bf9\u5e94\u7684 value \u503c\u88ab\u8986\u76d6\u4e0d\u5c5e\u4e8e\u7ed3\u6784\u53d8\u5316\u3002"),(0,l.kt)("p",null,"\u5728 HashMap \u4e2d\uff0c\u54c8\u5e0c\u6876\u6570\u7ec4 table \u7684\u957f\u5ea6 length \u5927\u5c0f\u5fc5\u987b\u4e3a 2",(0,l.kt)("sup",null,"n"),"\uff08\u4e00\u5b9a\u662f\u5408\u6570\uff09\uff0c\u8fd9\u662f\u4e00\u79cd\u975e\u5e38\u89c4\u7684\u8bbe\u8ba1\uff0c\u5e38\u89c4\u7684\u8bbe\u8ba1\u662f\u628a\u6876\u7684\u5927\u5c0f\u8bbe\u8ba1\u4e3a\u7d20\u6570\u3002\u76f8\u5bf9\u6765\u8bf4\u7d20\u6570\u5bfc\u81f4\u51b2\u7a81\u7684\u6982\u7387\u8981\u5c0f\u4e8e\u5408\u6570\uff0c\u5177\u4f53\u8bc1\u660e\u53ef\u4ee5\u53c2\u8003 ",(0,l.kt)("a",{parentName:"p",href:"https://blog.csdn.net/liuqiyao_01/article/details/14475159"},"\u4e3a\u4ec0\u4e48\u4e00\u822chashtable\u7684\u6876\u6570\u4f1a\u53d6\u4e00\u4e2a\u7d20\u6570\uff1f")," \uff0c",(0,l.kt)("strong",{parentName:"p"},"Hashtable \u521d\u59cb\u5316\u6876\u5927\u5c0f\u4e3a 11\uff0c\u5c31\u662f\u6876\u5927\u5c0f\u8bbe\u8ba1\u4e3a\u7d20\u6570\u7684\u5e94\u7528\uff08Hashtable \u6269\u5bb9\u540e\u4e0d\u80fd\u4fdd\u8bc1\u8fd8\u662f\u7d20\u6570\uff09"),"\u3002HashMap \u91c7\u7528\u8fd9\u79cd\u975e\u5e38\u89c4\u8bbe\u8ba1\uff0c",(0,l.kt)("strong",{parentName:"p"},"\u4e3b\u8981\u662f\u4e3a\u4e86\u5728\u53d6\u6a21\u548c\u6269\u5bb9\u65f6\u505a\u4f18\u5316\uff0c\u540c\u65f6\u4e3a\u4e86\u51cf\u5c11\u51b2\u7a81\uff0cHashMap \u5b9a\u4f4d\u54c8\u5e0c\u6876\u7d22\u5f15\u4f4d\u7f6e\u65f6\uff0c\u4e5f\u52a0\u5165\u4e86\u9ad8\u4f4d\u53c2\u4e0e\u8fd0\u7b97\u7684\u8fc7\u7a0b"),"\u3002"),(0,l.kt)("p",null,"\u8fd9\u91cc\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u5373\u4f7f\u8d1f\u8f7d\u56e0\u5b50\u548c Hash \u7b97\u6cd5\u8bbe\u8ba1\u7684\u518d\u5408\u7406\uff0c\u4e5f\u514d\u4e0d\u4e86\u4f1a\u51fa\u73b0\u62c9\u94fe\u8fc7\u957f\u7684\u60c5\u51b5\uff0c\u4e00\u65e6\u51fa\u73b0\u62c9\u94fe\u8fc7\u957f\uff0c\u5219\u4f1a\u4e25\u91cd\u5f71\u54cd HashMap \u7684\u6027\u80fd\u3002\u4e8e\u662f\uff0c\u5728 JDK1.8 \u7248\u672c\u4e2d\uff0c\u5bf9\u6570\u636e\u7ed3\u6784\u505a\u4e86\u8fdb\u4e00\u6b65\u7684\u4f18\u5316\uff0c\u5f15\u5165\u4e86\u7ea2\u9ed1\u6811\u3002\u800c\u5f53\u94fe\u8868\u957f\u5ea6\u592a\u957f\uff08\u9ed8\u8ba4\u8d85\u8fc78\uff09\u65f6\uff0c\u94fe\u8868\u5c31\u8f6c\u6362\u4e3a\u7ea2\u9ed1\u6811\uff0c\u5229\u7528\u7ea2\u9ed1\u6811\u5feb\u901f\u589e\u5220\u6539\u67e5\u7684\u7279\u70b9\u63d0\u9ad8 HashMap \u7684\u6027\u80fd\uff0c\u5176\u4e2d\u4f1a\u7528\u5230\u7ea2\u9ed1\u6811\u7684\u63d2\u5165\u3001\u5220\u9664\u3001\u67e5\u627e\u7b49\u7b97\u6cd5\u3002\u672c\u6587\u4e0d\u518d\u5bf9\u7ea2\u9ed1\u6811\u5c55\u5f00\u8ba8\u8bba\uff0c\u60f3\u4e86\u89e3\u66f4\u591a\u7ea2\u9ed1\u6811\u6570\u636e\u7ed3\u6784\u7684\u5de5\u4f5c\u539f\u7406\u53ef\u4ee5\u53c2\u8003\uff1a",(0,l.kt)("a",{parentName:"p",href:"https://blog.csdn.net/v_july_v/article/details/6105630"},"\u6559\u4f60\u521d\u6b65\u4e86\u89e3\u7ea2\u9ed1\u6811"),"\u3002"),(0,l.kt)("h4",{id:"2-\u91cd\u8981\u53c2\u6570"},"2. \u91cd\u8981\u53c2\u6570"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"buckets"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5728 HashMap \u7684\u6ce8\u91ca\u91cc\u4f7f\u7528\u54c8\u5e0c\u6876\u6765\u5f62\u8c61\u7684\u8868\u793a\u6570\u7ec4\u4e2d\u6bcf\u4e2a\u5730\u5740\u4f4d\u7f6e\u3002\u6ce8\u610f\u8fd9\u91cc\u5e76\u4e0d\u662f\u6570\u7ec4\u672c\u8eab\uff0c\u6570\u7ec4\u662f\u88c5\u54c8\u5e0c\u6876\u7684\uff0c\u4ed6\u53ef\u4ee5\u88ab\u79f0\u4e3a",(0,l.kt)("strong",{parentName:"td"},"\u54c8\u5e0c\u8868"),"\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"capacity"),(0,l.kt)("td",{parentName:"tr",align:null},"table \u7684\u5bb9\u91cf\u5927\u5c0f\uff0c\u9ed8\u8ba4\u4e3a 16\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f capacity \u5fc5\u987b\u4fdd\u8bc1\u4e3a 2 \u7684 n \u6b21\u65b9\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"size"),(0,l.kt)("td",{parentName:"tr",align:null},"table \u7684\u5b9e\u9645\u4f7f\u7528\u91cf\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"threshold"),(0,l.kt)("td",{parentName:"tr",align:null},"size \u7684\u4e34\u754c\u503c\uff0csize \u5fc5\u987b\u5c0f\u4e8e threshold\uff0c\u5982\u679c\u5927\u4e8e\u7b49\u4e8e\uff0c\u5c31\u5fc5\u987b\u8fdb\u884c\u6269\u5bb9\u64cd\u4f5c\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"loadFactor"),(0,l.kt)("td",{parentName:"tr",align:null},"\u88c5\u8f7d\u56e0\u5b50\uff0ctable \u80fd\u591f\u4f7f\u7528\u7684\u6bd4\u4f8b\uff0cthreshold = capacity * loadFactor\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"TREEIFY_THRESHOLD"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6811\u5316\u9600\u503c\uff0c\u54c8\u5e0c\u6876\u4e2d\u7684\u8282\u70b9\u4e2a\u6570\u5927\u4e8e\u8be5\u503c\uff08\u9ed8\u8ba4\u4e3a8\uff09\u7684\u65f6\u5019\u5c06\u4f1a\u88ab\u8f6c\u4e3a\u7ea2\u9ed1\u6811\u884c\u5b58\u50a8\u7ed3\u6784\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"UNTREEIFY_THRESHOLD"),(0,l.kt)("td",{parentName:"tr",align:null},"\u975e\u6811\u5316\u9600\u503c\uff0c\u5c0f\u4e8e\u8be5\u503c\uff08\u9ed8\u8ba4\u4e3a 6\uff09\u7684\u65f6\u5019\u5c06\u518d\u6b21\u6539\u4e3a\u5355\u94fe\u8868\u7684\u683c\u5f0f\u5b58\u50a8")))),(0,l.kt)("h4",{id:"3-\u786e\u5b9a\u54c8\u5e0c\u6876\u6570\u7ec4\u7d22\u5f15\u4f4d\u7f6e"},"3. \u786e\u5b9a\u54c8\u5e0c\u6876\u6570\u7ec4\u7d22\u5f15\u4f4d\u7f6e"),(0,l.kt)("p",null,"\u5f88\u591a\u64cd\u4f5c\u90fd\u9700\u8981\u5148\u786e\u5b9a\u4e00\u4e2a\u952e\u503c\u5bf9\u6240\u5728\u7684\u6876\u4e0b\u6807\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"int hash = hash(key);\nint i = indexFor(hash, table.length);\n")),(0,l.kt)("p",null,"\uff08\u4e00\uff09\u8ba1\u7b97 hash \u503c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"final int hash(Object k) {\n    int h = hashSeed;\n    if (0 != h && k instanceof String) {\n        return sun.misc.Hashing.stringHash32((String) k);\n    }\n\n    h ^= k.hashCode();\n\n    // This function ensures that hashCodes that differ only by\n    // constant multiples at each bit position have a bounded\n    // number of collisions (approximately 8 at default load factor).\n    h ^= (h >>> 20) ^ (h >>> 12);\n    return h ^ (h >>> 7) ^ (h >>> 4);\n}\npublic final int hashCode() {\n    return Objects.hashCode(key) ^ Objects.hashCode(value);\n}\n")),(0,l.kt)("p",null,"\uff08\u4e8c\uff09\u53d6\u6a21"),(0,l.kt)("p",null,"\u4ee4 x = 1<<4\uff0c\u5373 x \u4e3a 2 \u7684 4 \u6b21\u65b9\uff0c\u5b83\u5177\u6709\u4ee5\u4e0b\u6027\u8d28\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"x   : 00010000\nx-1 : 00001111\n")),(0,l.kt)("p",null,"\u4ee4\u4e00\u4e2a\u6570 y \u4e0e x-1 \u505a\u4e0e\u8fd0\u7b97\uff0c\u53ef\u4ee5\u53bb\u9664 y \u4f4d\u7ea7\u8868\u793a\u7684\u7b2c 4 \u4f4d\u4ee5\u4e0a\u6570\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"y       : 10110010\nx-1     : 00001111\ny&(x-1) : 00000010\n")),(0,l.kt)("p",null,"\u8fd9\u4e2a\u6027\u8d28\u548c y \u5bf9 x \u53d6\u6a21\u6548\u679c\u662f\u4e00\u6837\u7684\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"y   : 10110010\nx   : 00010000\ny%x : 00000010\n")),(0,l.kt)("p",null,"\u6211\u4eec\u77e5\u9053\uff0c\u4f4d\u8fd0\u7b97\u7684\u4ee3\u4ef7\u6bd4\u6c42\u6a21\u8fd0\u7b97\u5c0f\u7684\u591a\uff0c\u56e0\u6b64\u5728\u8fdb\u884c\u8fd9\u79cd\u8ba1\u7b97\u65f6\u7528\u4f4d\u8fd0\u7b97\u7684\u8bdd\u80fd\u5e26\u6765\u66f4\u9ad8\u7684\u6027\u80fd\u3002"),(0,l.kt)("p",null,"\u786e\u5b9a\u6876\u4e0b\u6807\u7684\u6700\u540e\u4e00\u6b65\u662f\u5c06 key \u7684 hash \u503c\u5bf9\u6876\u4e2a\u6570\u53d6\u6a21\uff1ahash%capacity\uff0c\u5982\u679c\u80fd\u4fdd\u8bc1 capacity \u4e3a 2 \u7684 n \u6b21\u65b9\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u64cd\u4f5c\u8f6c\u6362\u4e3a\u4f4d\u8fd0\u7b97\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"static int indexFor(int h, int length) {\n    return h & (length-1);\n}\n")),(0,l.kt)("h4",{id:"4-\u5206\u6790hashmap\u7684put\u65b9\u6cd5"},"4. \u5206\u6790HashMap\u7684put\u65b9\u6cd5"),(0,l.kt)("p",null,"\u3000\u3000HashMap \u7684 put \u65b9\u6cd5\u6267\u884c\u8fc7\u7a0b\u53ef\u4ee5\u901a\u8fc7\u4e0b\u56fe\u6765\u7406\u89e3\uff0c\u81ea\u5df1\u6709\u5174\u8da3\u53ef\u4ee5\u53bb\u5bf9\u6bd4\u6e90\u7801\u66f4\u6e05\u695a\u5730\u7814\u7a76\u5b66\u4e60\u3002"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashmap-put.png",width:""})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u2460.\u5224\u65ad\u952e\u503c\u5bf9\u6570\u7ec4 table","[i]"," \u662f\u5426\u4e3a\u7a7a\u6216\u4e3a null\uff0c\u5426\u5219\u6267\u884c resize() \u8fdb\u884c\u6269\u5bb9\uff1b"),(0,l.kt)("p",null,"\u2461.\u6839\u636e\u952e\u503c key \u8ba1\u7b97 hash \u503c\u5f97\u5230\u63d2\u5165\u7684\u6570\u7ec4\u7d22\u5f15i\uff0c\u5982\u679c table","[i]","==null\uff0c\u76f4\u63a5\u65b0\u5efa\u8282\u70b9\u6dfb\u52a0\uff0c\u8f6c\u5411 \u2465\uff0c\u5982\u679ctable","[i]"," \u4e0d\u4e3a\u7a7a\uff0c\u8f6c\u5411 \u2462\uff1b"),(0,l.kt)("p",null,"\u2462.\u5224\u65ad table","[i]"," \u7684\u9996\u4e2a\u5143\u7d20\u662f\u5426\u548c key \u4e00\u6837\uff0c\u5982\u679c\u76f8\u540c\u76f4\u63a5\u8986\u76d6 value\uff0c\u5426\u5219\u8f6c\u5411 \u2463\uff0c\u8fd9\u91cc\u7684\u76f8\u540c\u6307\u7684\u662f hashCode \u4ee5\u53ca equals\uff1b"),(0,l.kt)("p",null,"\u2463.\u5224\u65adtable","[i]"," \u662f\u5426\u4e3a treeNode\uff0c\u5373 table","[i]"," \u662f\u5426\u662f\u7ea2\u9ed1\u6811\uff0c\u5982\u679c\u662f\u7ea2\u9ed1\u6811\uff0c\u5219\u76f4\u63a5\u5728\u6811\u4e2d\u63d2\u5165\u952e\u503c\u5bf9\uff0c\u5426\u5219\u8f6c\u5411 \u2464\uff1b"),(0,l.kt)("p",null,"\u2464.\u904d\u5386 table","[i]","\uff0c\u5224\u65ad\u94fe\u8868\u957f\u5ea6\u662f\u5426\u5927\u4e8e 8\uff0c\u5927\u4e8e 8 \u7684\u8bdd\u628a\u94fe\u8868\u8f6c\u6362\u4e3a\u7ea2\u9ed1\u6811\uff0c\u5728\u7ea2\u9ed1\u6811\u4e2d\u6267\u884c\u63d2\u5165\u64cd\u4f5c\uff0c\u5426\u5219\u8fdb\u884c\u94fe\u8868\u7684\u63d2\u5165\u64cd\u4f5c\uff1b\u904d\u5386\u8fc7\u7a0b\u4e2d\u82e5\u53d1\u73b0 key \u5df2\u7ecf\u5b58\u5728\u76f4\u63a5\u8986\u76d6 value \u5373\u53ef\uff1b"),(0,l.kt)("p",null,"\u2465.\u63d2\u5165\u6210\u529f\u540e\uff0c\u5224\u65ad\u5b9e\u9645\u5b58\u5728\u7684\u952e\u503c\u5bf9\u6570\u91cf size \u662f\u5426\u8d85\u591a\u4e86\u6700\u5927\u5bb9\u91cf threshold\uff0c\u5982\u679c\u8d85\u8fc7\uff0c\u8fdb\u884c\u6269\u5bb9\u3002"),(0,l.kt)("p",null,"JDK1.8 HashMap \u7684 put \u65b9\u6cd5\u6e90\u7801\u5982\u4e0b:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public V put(K key, V value) {\n    // \u5bf9key\u7684hashCode()\u505ahash\n    return putVal(hash(key), key, value, false, true);\n}\n\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    Node<K,V>[] tab; Node<K,V> p; int n, i;\n    // \u6b65\u9aa4\u2460\uff1atab\u4e3a\u7a7a\u5219\u521b\u5efa\n    if ((tab = table) == null || (n = tab.length) == 0)\n        n = (tab = resize()).length;\n    // \u6b65\u9aa4\u2461\uff1a\u8ba1\u7b97index\uff0c\u5e76\u5bf9null\u505a\u5904\u7406 \n    if ((p = tab[i = (n - 1) & hash]) == null) \n        tab[i] = newNode(hash, key, value, null);\n    else {\n        Node<K,V> e; K k;\n        // \u6b65\u9aa4\u2462\uff1a\u8282\u70b9key\u5b58\u5728\uff0c\u76f4\u63a5\u8986\u76d6value\n        if (p.hash == hash &&\n            ((k = p.key) == key || (key != null && key.equals(k))))\n            e = p;\n        // \u6b65\u9aa4\u2463\uff1a\u5224\u65ad\u8be5\u94fe\u4e3a\u7ea2\u9ed1\u6811\n        else if (p instanceof TreeNode)\n            e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);\n        // \u6b65\u9aa4\u2464\uff1a\u8be5\u94fe\u4e3a\u94fe\u8868\n        else {\n            for (int binCount = 0; ; ++binCount) {\n                if ((e = p.next) == null) {\n                    p.next = newNode(hash, key,value,null);\n                     //\u94fe\u8868\u957f\u5ea6\u5927\u4e8e8\u8f6c\u6362\u4e3a\u7ea2\u9ed1\u6811\u8fdb\u884c\u5904\u7406\n                    if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st  \n                        treeifyBin(tab, hash);\n                    break;\n                }\n                 // key\u5df2\u7ecf\u5b58\u5728\u76f4\u63a5\u8986\u76d6value\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k)))) \n                           break;\n                p = e;\n            }\n        }\n        \n        if (e != null) { // existing mapping for key\n            V oldValue = e.value;\n            if (!onlyIfAbsent || oldValue == null)\n                e.value = value;\n            afterNodeAccess(e);\n            return oldValue;\n        }\n    }\n    ++modCount;\n    // \u6b65\u9aa4\u2465\uff1a\u8d85\u8fc7\u6700\u5927\u5bb9\u91cf \u5c31\u6269\u5bb9\n    if (++size > threshold)\n        resize();\n    afterNodeInsertion(evict);\n    return null;\n}\n")),(0,l.kt)("h4",{id:"5-\u6269\u5bb9\u673a\u5236"},"5. \u6269\u5bb9\u673a\u5236"),(0,l.kt)("p",null,"\u6269\u5bb9 (resize) \u5c31\u662f\u91cd\u65b0\u8ba1\u7b97\u5bb9\u91cf\uff0c\u5411 HashMap \u5bf9\u8c61\u91cc\u4e0d\u505c\u7684\u6dfb\u52a0\u5143\u7d20\uff0c\u800c HashMap \u5bf9\u8c61\u5185\u90e8\u7684\u6570\u7ec4\u65e0\u6cd5\u88c5\u8f7d\u66f4\u591a\u7684\u5143\u7d20\u65f6\uff0c\u5bf9\u8c61\u5c31\u9700\u8981\u6269\u5927\u6570\u7ec4\u7684\u957f\u5ea6\uff0c\u4ee5\u4fbf\u80fd\u88c5\u5165\u66f4\u591a\u7684\u5143\u7d20\u3002\u5f53\u7136 Java \u91cc\u7684\u6570\u7ec4\u662f\u65e0\u6cd5\u81ea\u52a8\u6269\u5bb9\u7684\uff0c\u65b9\u6cd5\u662f\u4f7f\u7528\u4e00\u4e2a\u65b0\u7684\u6570\u7ec4\u4ee3\u66ff\u5df2\u6709\u7684\u5bb9\u91cf\u5c0f\u7684\u6570\u7ec4\uff0c\u5c31\u50cf\u6211\u4eec\u7528\u4e00\u4e2a\u5c0f\u6876\u88c5\u6c34\uff0c\u5982\u679c\u60f3\u88c5\u66f4\u591a\u7684\u6c34\uff0c\u5c31\u5f97\u6362\u5927\u6c34\u6876\u3002"),(0,l.kt)("p",null,"\u6211\u4eec\u5206\u6790\u4e0b resize \u7684\u6e90\u7801\uff0c\u9274\u4e8e JDK1.8 \u878d\u5165\u4e86\u7ea2\u9ed1\u6811\uff0c\u8f83\u590d\u6742\uff0c\u4e3a\u4e86\u4fbf\u4e8e\u7406\u89e3\u6211\u4eec\u4ecd\u7136\u4f7f\u7528 JDK1.7 \u7684\u4ee3\u7801\uff0c\u597d\u7406\u89e3\u4e00\u4e9b\uff0c\u672c\u8d28\u4e0a\u533a\u522b\u4e0d\u5927\uff0c\u5177\u4f53\u533a\u522b\u540e\u6587\u518d\u8bf4\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-JAVA"},"void resize(int newCapacity) {   //\u4f20\u5165\u65b0\u7684\u5bb9\u91cf\n    Entry[] oldTable = table;    //\u5f15\u7528\u6269\u5bb9\u524d\u7684Entry\u6570\u7ec4\n    int oldCapacity = oldTable.length;         \n    if (oldCapacity == MAXIMUM_CAPACITY) {  //\u6269\u5bb9\u524d\u7684\u6570\u7ec4\u5927\u5c0f\u5982\u679c\u5df2\u7ecf\u8fbe\u5230\u6700\u5927(2^30)\u4e86\n        threshold = Integer.MAX_VALUE; //\u4fee\u6539\u9608\u503c\u4e3aint\u7684\u6700\u5927\u503c(2^31-1)\uff0c\u8fd9\u6837\u4ee5\u540e\u5c31\u4e0d\u4f1a\u6269\u5bb9\u4e86\n        return;\n    }\n \n    Entry[] newTable = new Entry[newCapacity];  //\u521d\u59cb\u5316\u4e00\u4e2a\u65b0\u7684Entry\u6570\u7ec4\n    transfer(newTable);                         //\uff01\uff01\u5c06\u6570\u636e\u8f6c\u79fb\u5230\u65b0\u7684Entry\u6570\u7ec4\u91cc\n    table = newTable;                           //HashMap\u7684table\u5c5e\u6027\u5f15\u7528\u65b0\u7684Entry\u6570\u7ec4\n    threshold = (int)(newCapacity * loadFactor);//\u4fee\u6539\u9608\u503c\n}\n")),(0,l.kt)("p",null,"\u8fd9\u91cc\u5c31\u662f\u4f7f\u7528\u4e00\u4e2a\u5bb9\u91cf\u66f4\u5927\u7684\u6570\u7ec4\u6765\u4ee3\u66ff\u5df2\u6709\u7684\u5bb9\u91cf\u5c0f\u7684\u6570\u7ec4\uff0ctransfer() \u65b9\u6cd5\u5c06\u539f\u6709 Entry \u6570\u7ec4\u7684\u5143\u7d20\u62f7\u8d1d\u5230\u65b0\u7684 Entry \u6570\u7ec4\u91cc\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"void transfer(Entry[] newTable) {\n    Entry[] src = table;                   //src\u5f15\u7528\u4e86\u65e7\u7684Entry\u6570\u7ec4\n    int newCapacity = newTable.length;\n    for (int j = 0; j < src.length; j++) { //\u904d\u5386\u65e7\u7684Entry\u6570\u7ec4\n        Entry<K,V> e = src[j];             //\u53d6\u5f97\u65e7Entry\u6570\u7ec4\u7684\u6bcf\u4e2a\u5143\u7d20\n        if (e != null) {\n            src[j] = null;//\u91ca\u653e\u65e7Entry\u6570\u7ec4\u7684\u5bf9\u8c61\u5f15\u7528\uff08for\u5faa\u73af\u540e\uff0c\u65e7\u7684Entry\u6570\u7ec4\u4e0d\u518d\u5f15\u7528\u4efb\u4f55\u5bf9\u8c61\uff09\n            do {\n                Entry<K,V> next = e.next;\n                int i = indexFor(e.hash, newCapacity); //\uff01\uff01\u91cd\u65b0\u8ba1\u7b97\u6bcf\u4e2a\u5143\u7d20\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\n                e.next = newTable[i]; //\u6807\u8bb0[1]\n                newTable[i] = e;      //\u5c06\u5143\u7d20\u653e\u5728\u6570\u7ec4\u4e0a\n                e = next;             //\u8bbf\u95ee\u4e0b\u4e00\u4e2aEntry\u94fe\u4e0a\u7684\u5143\u7d20\n            } while (e != null);\n        }\n    }\n}\n")),(0,l.kt)("p",null,"newTable","[i]"," \u7684\u5f15\u7528\u8d4b\u7ed9\u4e86 e.next\uff0c\u4e5f\u5c31\u662f\u4f7f\u7528\u4e86\u5355\u94fe\u8868\u7684\u5934\u63d2\u5165\u65b9\u5f0f\uff0c\u540c\u4e00\u4f4d\u7f6e\u4e0a\u65b0\u5143\u7d20\u603b\u4f1a\u88ab\u653e\u5728\u94fe\u8868\u7684\u5934\u90e8\u4f4d\u7f6e\uff1b\u8fd9\u6837\u5148\u653e\u5728\u4e00\u4e2a\u7d22\u5f15\u4e0a\u7684\u5143\u7d20\u7ec8\u4f1a\u88ab\u653e\u5230 Entry \u94fe\u7684\u5c3e\u90e8(\u5982\u679c\u53d1\u751f\u4e86 hash \u51b2\u7a81\u7684\u8bdd\uff09\uff0c\u8fd9\u4e00\u70b9\u548c Jdk1.8 \u6709\u533a\u522b\uff0c\u4e0b\u6587\u8be6\u89e3\u3002\u5728\u65e7\u6570\u7ec4\u4e2d\u540c\u4e00\u6761 Entry \u94fe\u4e0a\u7684\u5143\u7d20\uff0c\u901a\u8fc7\u91cd\u65b0\u8ba1\u7b97\u7d22\u5f15\u4f4d\u7f6e\u540e\uff0c\u6709\u53ef\u80fd\u88ab\u653e\u5230\u4e86\u65b0\u6570\u7ec4\u7684\u4e0d\u540c\u4f4d\u7f6e\u4e0a\u3002"),(0,l.kt)("p",null,"\u4e0b\u9762\u4e3e\u4e2a\u4f8b\u5b50\u8bf4\u660e\u4e0b\u6269\u5bb9\u8fc7\u7a0b\u3002\u5047\u8bbe\u4e86\u6211\u4eec\u7684 hash \u7b97\u6cd5\u5c31\u662f\u7b80\u5355\u7684\u7528 key mod \u4e00\u4e0b\u8868\u7684\u5927\u5c0f\uff08\u4e5f\u5c31\u662f\u6570\u7ec4\u7684\u957f\u5ea6\uff09\u3002\u5176\u4e2d\u7684\u54c8\u5e0c\u6876\u6570\u7ec4 table \u7684 size=2\uff0c \u6240\u4ee5 key = 3\u30017\u30015\uff0cput \u987a\u5e8f\u4f9d\u6b21\u4e3a 5\u30017\u30013\u3002\u5728 mod 2 \u4ee5\u540e\u90fd\u51b2\u7a81\u5728 table","[1]"," \u8fd9\u91cc\u4e86\u3002\u8fd9\u91cc\u5047\u8bbe\u8d1f\u8f7d\u56e0\u5b50 loadFactor=1\uff0c\u5373\u5f53\u952e\u503c\u5bf9\u7684\u5b9e\u9645\u5927\u5c0f size \u5927\u4e8e table \u7684\u5b9e\u9645\u5927\u5c0f\u65f6\u8fdb\u884c\u6269\u5bb9\u3002\u63a5\u4e0b\u6765\u7684\u4e09\u4e2a\u6b65\u9aa4\u662f\u54c8\u5e0c\u6876\u6570\u7ec4 resize \u6210 4\uff0c\u7136\u540e\u6240\u6709\u7684 Node \u91cd\u65b0 rehash \u7684\u8fc7\u7a0b\u3002"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/jdk1.7-resize.png",width:"600"})),(0,l.kt)("p",null,"\u4e0b\u9762\u6211\u4eec\u8bb2\u89e3\u4e0b JDK1.8 \u505a\u4e86\u54ea\u4e9b\u4f18\u5316\u3002\u7ecf\u8fc7\u89c2\u6d4b\u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u662f 2 \u6b21\u5e42\u7684\u6269\u5c55 (\u6307\u957f\u5ea6\u6269\u4e3a\u539f\u6765 2 \u500d)\uff0c\u6240\u4ee5\uff0c\u5143\u7d20\u7684\u4f4d\u7f6e\u8981\u4e48\u662f\u5728\u539f\u4f4d\u7f6e\uff0c\u8981\u4e48\u662f\u5728\u539f\u4f4d\u7f6e\u518d\u79fb\u52a8 2 \u6b21\u5e42\u7684\u4f4d\u7f6e\u3002\u770b\u4e0b\u56fe\u53ef\u4ee5\u660e\u767d\u8fd9\u53e5\u8bdd\u7684\u610f\u601d\uff0cn \u4e3a table \u7684\u957f\u5ea6\uff0c\u56fe\uff08a\uff09\u8868\u793a\u6269\u5bb9\u524d\u7684 key1 \u548c key2 \u4e24\u79cd key \u786e\u5b9a\u7d22\u5f15\u4f4d\u7f6e\u7684\u793a\u4f8b\uff0c\u56fe\uff08b\uff09\u8868\u793a\u6269\u5bb9\u540e key1 \u548c key2 \u4e24\u79cd key \u786e\u5b9a\u7d22\u5f15\u4f4d\u7f6e\u7684\u793a\u4f8b\uff0c\u5176\u4e2d hash1 \u662f key1 \u5bf9\u5e94\u7684\u54c8\u5e0c\u4e0e\u9ad8\u4f4d\u8fd0\u7b97\u7ed3\u679c\u3002"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashMap-1.8-hash1.png",width:"700"})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u5143\u7d20\u5728\u91cd\u65b0\u8ba1\u7b97 hash \u4e4b\u540e\uff0c\u56e0\u4e3a n \u53d8\u4e3a 2 \u500d\uff0c\u90a3\u4e48 n-1 \u7684 mask \u8303\u56f4\u5728\u9ad8\u4f4d\u591a 1bit (\u7ea2\u8272)\uff0c\u56e0\u6b64\u65b0\u7684 index \u5c31\u4f1a\u53d1\u751f\u8fd9\u6837\u7684\u53d8\u5316\uff1a"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashMap-1.8-hash2.png",width:"600"})),(0,l.kt)("p",null,"\u56e0\u6b64\uff0c\u6211\u4eec\u5728\u6269\u5145 HashMap \u7684\u65f6\u5019\uff0c\u4e0d\u9700\u8981\u50cf JDK1.7 \u7684\u5b9e\u73b0\u90a3\u6837\u91cd\u65b0\u8ba1\u7b97 hash\uff0c\u53ea\u9700\u8981\u770b\u770b\u539f\u6765\u7684 hash \u503c\u65b0\u589e\u7684\u90a3\u4e2a bit \u662f 1 \u8fd8\u662f 0 \u5c31\u597d\u4e86\uff0c\u662f 0 \u7684\u8bdd\u7d22\u5f15\u6ca1\u53d8\uff0c\u662f 1 \u7684\u8bdd\u7d22\u5f15\u53d8\u6210\u201c\u539f\u7d22\u5f15+oldCap\u201d\uff0c\u53ef\u4ee5\u770b\u770b\u4e0b\u56fe\u4e3a 16 \u6269\u5145\u4e3a 32 \u7684 resize \u793a\u610f\u56fe\uff1a"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/jdk1.8-resize.png",width:"700"})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u8fd9\u4e2a\u8bbe\u8ba1\u786e\u5b9e\u975e\u5e38\u7684\u5de7\u5999\uff0c\u65e2\u7701\u53bb\u4e86\u91cd\u65b0\u8ba1\u7b97 hash \u503c\u7684\u65f6\u95f4\uff0c\u800c\u4e14\u540c\u65f6\uff0c\u7531\u4e8e\u65b0\u589e\u7684 1bit \u662f 0 \u8fd8\u662f 1 \u53ef\u4ee5\u8ba4\u4e3a\u662f\u968f\u673a\u7684\uff0c\u56e0\u6b64 resize \u7684\u8fc7\u7a0b\uff0c\u5747\u5300\u7684\u628a\u4e4b\u524d\u7684\u51b2\u7a81\u7684\u8282\u70b9\u5206\u6563\u5230\u65b0\u7684 bucket \u4e86\u3002\u8fd9\u4e00\u5757\u5c31\u662f JDK1.8 \u65b0\u589e\u7684\u4f18\u5316\u70b9\u3002\u6709\u4e00\u70b9\u6ce8\u610f\u533a\u522b\uff0cJDK1.7 \u4e2d rehash \u7684\u65f6\u5019\uff0c\u65e7\u94fe\u8868\u8fc1\u79fb\u65b0\u94fe\u8868\u7684\u65f6\u5019\uff0c\u5982\u679c\u5728\u65b0\u8868\u7684\u6570\u7ec4\u7d22\u5f15\u4f4d\u7f6e\u76f8\u540c\uff0c\u5219\u94fe\u8868\u5143\u7d20\u4f1a\u5012\u7f6e\uff0c\u4f46\u662f\u4ece\u4e0a\u56fe\u53ef\u4ee5\u770b\u51fa\uff0cJDK1.8 \u4e0d\u4f1a\u5012\u7f6e\u3002\u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u7814\u7a76\u4e0b JDK1.8 \u7684 resize\u6e90 \u7801\uff0c\u5199\u7684\u5f88\u8d5e\uff0c\u5982\u4e0b:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'final Node<K,V>[] resize() {\n    Node<K,V>[] oldTab = table;\n    int oldCap = (oldTab == null) ? 0 : oldTab.length;\n    int oldThr = threshold;\n    int newCap, newThr = 0;\n    if (oldCap > 0) {\n        // \u8d85\u8fc7\u6700\u5927\u503c\u5c31\u4e0d\u518d\u6269\u5145\u4e86\uff0c\u5c31\u53ea\u597d\u968f\u4f60\u78b0\u649e\u53bb\u5427\n        if (oldCap >= MAXIMUM_CAPACITY) {\n            threshold = Integer.MAX_VALUE;\n            return oldTab;\n        }\n        // \u6ca1\u8d85\u8fc7\u6700\u5927\u503c\uff0c\u5c31\u6269\u5145\u4e3a\u539f\u6765\u76842\u500d\n        else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&\n                 oldCap >= DEFAULT_INITIAL_CAPACITY)\n            newThr = oldThr << 1; // double threshold\n    }\n    else if (oldThr > 0) // initial capacity was placed in threshold\n        newCap = oldThr;\n    else {               // zero initial threshold signifies using defaults\n        newCap = DEFAULT_INITIAL_CAPACITY;\n        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n    }\n    // \u8ba1\u7b97\u65b0\u7684resize\u4e0a\u9650\n    if (newThr == 0) {\n\n        float ft = (float)newCap * loadFactor;\n        newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ?\n                  (int)ft : Integer.MAX_VALUE);\n    }\n    threshold = newThr;\n    @SuppressWarnings({"rawtypes"\uff0c"unchecked"})\n        Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];\n    table = newTab;\n    if (oldTab != null) {\n        // \u628a\u6bcf\u4e2abucket\u90fd\u79fb\u52a8\u5230\u65b0\u7684buckets\u4e2d\n        for (int j = 0; j < oldCap; ++j) {\n            Node<K,V> e;\n            if ((e = oldTab[j]) != null) {\n                oldTab[j] = null;\n                if (e.next == null)\n                    newTab[e.hash & (newCap - 1)] = e;\n                else if (e instanceof TreeNode)\n                    ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);\n                else { // \u94fe\u8868\u4f18\u5316\u91cdhash\u7684\u4ee3\u7801\u5757\n                    Node<K,V> loHead = null, loTail = null;\n                    Node<K,V> hiHead = null, hiTail = null;\n                    Node<K,V> next;\n                    do {\n                        next = e.next;\n                        // \u539f\u7d22\u5f15\n                        if ((e.hash & oldCap) == 0) {\n                            if (loTail == null)\n                                loHead = e;\n                            else\n                                loTail.next = e;\n                            loTail = e;\n                        }\n                        // \u539f\u7d22\u5f15+oldCap\n                        else {\n                            if (hiTail == null)\n                                hiHead = e;\n                            else\n                                hiTail.next = e;\n                            hiTail = e;\n                        }\n                    } while ((e = next) != null);\n                    // \u539f\u7d22\u5f15\u653e\u5230bucket\u91cc\n                    if (loTail != null) {\n                        loTail.next = null;\n                        newTab[j] = loHead;\n                    }\n                    // \u539f\u7d22\u5f15+oldCap\u653e\u5230bucket\u91cc\n                    if (hiTail != null) {\n                        hiTail.next = null;\n                        newTab[j + oldCap] = hiHead;\n                    }\n                }\n            }\n        }\n    }\n    return newTab;\n}\n')),(0,l.kt)("h4",{id:"6-\u7ebf\u7a0b\u5b89\u5168\u6027"},"6. \u7ebf\u7a0b\u5b89\u5168\u6027"),(0,l.kt)("p",null,"\u5728\u591a\u7ebf\u7a0b\u4f7f\u7528\u573a\u666f\u4e2d\uff0c\u5e94\u8be5\u5c3d\u91cf\u907f\u514d\u4f7f\u7528\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684 HashMap\uff0c\u800c\u4f7f\u7528\u7ebf\u7a0b\u5b89\u5168\u7684 ConcurrentHashMap\u3002\u90a3\u4e48\u4e3a\u4ec0\u4e48\u8bf4 HashMap \u662f\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\uff0c\u4e0b\u9762\u4e3e\u4f8b\u5b50\u8bf4\u660e\u5728\u5e76\u53d1\u7684\u591a\u7ebf\u7a0b\u4f7f\u7528\u573a\u666f\u4e2d\u4f7f\u7528 HashMap \u53ef\u80fd\u9020\u6210\u6b7b\u5faa\u73af\u3002\u4ee3\u7801\u4f8b\u5b50\u5982\u4e0b(\u4fbf\u4e8e\u7406\u89e3\uff0c\u4ecd\u7136\u4f7f\u7528 JDK1.7 \u7684\u73af\u5883)\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class HashMapInfiniteLoop {  \n\n    private static HashMap<Integer,String> map = new HashMap<Integer,String>(2\uff0c0.75f);  \n    public static void main(String[] args) {  \n        map.put(5\uff0c "C");  \n\n        new Thread("Thread1") {  \n            public void run() {  \n                map.put(7, "B");  \n                System.out.println(map);  \n            };  \n        }.start();  \n        new Thread("Thread2") {  \n            public void run() {  \n                map.put(3, "A);  \n                System.out.println(map);  \n            };  \n        }.start();        \n    }  \n}\n')),(0,l.kt)("p",null,"\u5176\u4e2d\uff0cmap\u521d\u59cb\u5316\u4e3a\u4e00\u4e2a\u957f\u5ea6\u4e3a2\u7684\u6570\u7ec4\uff0cloadFactor=0.75\uff0cthreshold=2*0.75=1\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53put\u7b2c\u4e8c\u4e2akey\u7684\u65f6\u5019\uff0cmap\u5c31\u9700\u8981\u8fdb\u884cresize\u3002"),(0,l.kt)("p",null,"\u901a\u8fc7\u8bbe\u7f6e\u65ad\u70b9\u8ba9\u7ebf\u7a0b1\u548c\u7ebf\u7a0b2\u540c\u65f6debug\u5230transfer\u65b9\u6cd5(3.3\u5c0f\u8282\u4ee3\u7801\u5757)\u7684\u9996\u884c\u3002\u6ce8\u610f\u6b64\u65f6\u4e24\u4e2a\u7ebf\u7a0b\u5df2\u7ecf\u6210\u529f\u6dfb\u52a0\u6570\u636e\u3002\u653e\u5f00thread1\u7684\u65ad\u70b9\u81f3transfer\u65b9\u6cd5\u7684\u201cEntry next = e.next;\u201d \u8fd9\u4e00\u884c\uff1b\u7136\u540e\u653e\u5f00\u7ebf\u7a0b2\u7684\u7684\u65ad\u70b9\uff0c\u8ba9\u7ebf\u7a0b2\u8fdb\u884cresize\u3002\u7ed3\u679c\u5982\u4e0b\u56fe\u3002"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/jdk1.7-drop-dead-1.png",width:"600"})),(0,l.kt)("p",null,"\u6ce8\u610f\uff0cThread1\u7684 e \u6307\u5411\u4e86key(3)\uff0c\u800cnext\u6307\u5411\u4e86key(7)\uff0c\u5176\u5728\u7ebf\u7a0b\u4e8crehash\u540e\uff0c\u6307\u5411\u4e86\u7ebf\u7a0b\u4e8c\u91cd\u7ec4\u540e\u7684\u94fe\u8868\u3002"),(0,l.kt)("p",null,"\u7ebf\u7a0b\u4e00\u88ab\u8c03\u5ea6\u56de\u6765\u6267\u884c\uff0c\u5148\u662f\u6267\u884c newTalbe","[i]"," = e\uff0c \u7136\u540e\u662fe = next\uff0c\u5bfc\u81f4\u4e86e\u6307\u5411\u4e86key(7)\uff0c\u800c\u4e0b\u4e00\u6b21\u5faa\u73af\u7684next = e.next\u5bfc\u81f4\u4e86next\u6307\u5411\u4e86key(3)\u3002"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/jdk1.7-drop-dead-2.png",width:"600"})),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/jdk1.7-drop-dead-3.png",width:"600"})),(0,l.kt)("p",null,"e.next = newTable","[i]"," \u5bfc\u81f4 key(3).next \u6307\u5411\u4e86 key(7)\u3002\u6ce8\u610f\uff1a\u6b64\u65f6\u7684key(7).next \u5df2\u7ecf\u6307\u5411\u4e86key(3)\uff0c \u73af\u5f62\u94fe\u8868\u5c31\u8fd9\u6837\u51fa\u73b0\u4e86\u3002"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/jdk1.7-drop-dead-5.png",width:"600"})),(0,l.kt)("p",null,"\u4e8e\u662f\uff0c\u5f53\u6211\u4eec\u7528\u7ebf\u7a0b\u4e00\u8c03\u7528map.get(11)\u65f6\uff0c\u60b2\u5267\u5c31\u51fa\u73b0\u4e86\u2014\u2014Infinite Loop\u3002"),(0,l.kt)("h4",{id:"7-jdk18\u4e0ejdk17\u7684\u6027\u80fd\u5bf9\u6bd4"},"7. JDK1.8\u4e0eJDK1.7\u7684\u6027\u80fd\u5bf9\u6bd4"),(0,l.kt)("p",null,"HashMap\u4e2d\uff0c\u5982\u679ckey\u7ecf\u8fc7hash\u7b97\u6cd5\u5f97\u51fa\u7684\u6570\u7ec4\u7d22\u5f15\u4f4d\u7f6e\u5168\u90e8\u4e0d\u76f8\u540c\uff0c\u5373Hash\u7b97\u6cd5\u975e\u5e38\u597d\uff0c\u90a3\u6837\u7684\u8bdd\uff0cgetKey\u65b9\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662fO(1)\uff0c\u5982\u679cHash\u7b97\u6cd5\u6280\u672f\u7684\u7ed3\u679c\u78b0\u649e\u975e\u5e38\u591a\uff0c\u5047\u5982Hash\u7b97\u6781\u5176\u5dee\uff0c\u6240\u6709\u7684Hash\u7b97\u6cd5\u7ed3\u679c\u5f97\u51fa\u7684\u7d22\u5f15\u4f4d\u7f6e\u4e00\u6837\uff0c\u90a3\u6837\u6240\u6709\u7684\u952e\u503c\u5bf9\u90fd\u96c6\u4e2d\u5230\u4e00\u4e2a\u6876\u4e2d\uff0c\u6216\u8005\u5728\u4e00\u4e2a\u94fe\u8868\u4e2d\uff0c\u6216\u8005\u5728\u4e00\u4e2a\u7ea2\u9ed1\u6811\u4e2d\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u522b\u4e3aO(n)\u548cO(lgn)\u3002 \u9274\u4e8eJDK1.8\u505a\u4e86\u591a\u65b9\u9762\u7684\u4f18\u5316\uff0c\u603b\u4f53\u6027\u80fd\u4f18\u4e8eJDK1.7\uff0c\u4e0b\u9762\u6211\u4eec\u4ece\u4e24\u4e2a\u65b9\u9762\u7528\u4f8b\u5b50\u8bc1\u660e\u8fd9\u4e00\u70b9\u3002"),(0,l.kt)("h4",{id:"8-hash\u8f83\u5747\u5300\u7684\u60c5\u51b5"},"8. Hash\u8f83\u5747\u5300\u7684\u60c5\u51b5"),(0,l.kt)("p",null,"\u4e3a\u4e86\u4fbf\u4e8e\u6d4b\u8bd5\uff0c\u6211\u4eec\u5148\u5199\u4e00\u4e2a\u7c7bKey\uff0c\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"class Key implements Comparable<Key> {\n\n    private final int value;\n\n    Key(int value) {\n        this.value = value;\n    }\n\n    @Override\n    public int compareTo(Key o) {\n        return Integer.compare(this.value, o.value);\n    }\n\n    @Override\n    public boolean equals(Object o) {\n        if (this == o) return true;\n        if (o == null || getClass() != o.getClass())\n            return false;\n        Key key = (Key) o;\n        return value == key.value;\n    }\n\n    @Override\n    public int hashCode() {\n        return value;\n    }\n}\n")),(0,l.kt)("p",null,"\u8fd9\u4e2a\u7c7b\u590d\u5199\u4e86equals\u65b9\u6cd5\uff0c\u5e76\u4e14\u63d0\u4f9b\u4e86\u76f8\u5f53\u597d\u7684hashCode\u51fd\u6570\uff0c\u4efb\u4f55\u4e00\u4e2a\u503c\u7684hashCode\u90fd\u4e0d\u4f1a\u76f8\u540c\uff0c\u56e0\u4e3a\u76f4\u63a5\u4f7f\u7528value\u5f53\u505ahashcode\u3002\u4e3a\u4e86\u907f\u514d\u9891\u7e41\u7684GC\uff0c\u6211\u5c06\u4e0d\u53d8\u7684Key\u5b9e\u4f8b\u7f13\u5b58\u4e86\u8d77\u6765\uff0c\u800c\u4e0d\u662f\u4e00\u904d\u4e00\u904d\u7684\u521b\u5efa\u5b83\u4eec\u3002\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public class Keys {\n\n    public static final int MAX_KEY = 10_000_000;\n    private static final Key[] KEYS_CACHE = new Key[MAX_KEY];\n\n    static {\n        for (int i = 0; i < MAX_KEY; ++i) {\n            KEYS_CACHE[i] = new Key(i);\n        }\n    }\n\n    public static Key of(int value) {\n        return KEYS_CACHE[value];\n    }\n}\n")),(0,l.kt)("p",null,"\u73b0\u5728\u5f00\u59cb\u6211\u4eec\u7684\u8bd5\u9a8c\uff0c\u6d4b\u8bd5\u9700\u8981\u505a\u7684\u4ec5\u4ec5\u662f\uff0c\u521b\u5efa\u4e0d\u540csize\u7684HashMap\uff081\u300110\u3001100\u3001......10000000\uff09\uff0c\u5c4f\u853d\u4e86\u6269\u5bb9\u7684\u60c5\u51b5\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"static void test(int mapSize) {\n\n    HashMap<Key, Integer> map = new HashMap<Key,Integer>(mapSize);\n    for (int i = 0; i < mapSize; ++i) {\n        map.put(Keys.of(i), i);\n    }\n\n    long beginTime = System.nanoTime(); //\u83b7\u53d6\u7eb3\u79d2\n    for (int i = 0; i < mapSize; i++) {\n        map.get(Keys.of(i));\n    }\n    long endTime = System.nanoTime();\n    System.out.println(endTime - beginTime);\n}\n\npublic static void main(String[] args) {\n    for(int i=10;i<= 1000 0000;i*= 10){\n        test(i);\n    }\n}\n")),(0,l.kt)("p",null,"\u5728\u6d4b\u8bd5\u4e2d\u4f1a\u67e5\u627e\u4e0d\u540c\u7684\u503c\uff0c\u7136\u540e\u5ea6\u91cf\u82b1\u8d39\u7684\u65f6\u95f4\uff0c\u4e3a\u4e86\u8ba1\u7b97getKey\u7684\u5e73\u5747\u65f6\u95f4\uff0c\u6211\u4eec\u904d\u5386\u6240\u6709\u7684get\u65b9\u6cd5\uff0c\u8ba1\u7b97\u603b\u7684\u65f6\u95f4\uff0c\u9664\u4ee5key\u7684\u6570\u91cf\uff0c\u8ba1\u7b97\u4e00\u4e2a\u5e73\u5747\u503c\uff0c\u4e3b\u8981\u7528\u6765\u6bd4\u8f83\uff0c\u7edd\u5bf9\u503c\u53ef\u80fd\u4f1a\u53d7\u5f88\u591a\u73af\u5883\u56e0\u7d20\u7684\u5f71\u54cd\u3002\u7ed3\u679c\u5982\u4e0b\uff1a"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashmap-compare1.png",width:""})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u901a\u8fc7\u89c2\u6d4b\u6d4b\u8bd5\u7ed3\u679c\u53ef\u77e5\uff0cJDK1.8\u7684\u6027\u80fd\u8981\u9ad8\u4e8eJDK1.7 15%\u4ee5\u4e0a\uff0c\u5728\u67d0\u4e9bsize\u7684\u533a\u57df\u4e0a\uff0c\u751a\u81f3\u9ad8\u4e8e100%\u3002\u7531\u4e8eHash\u7b97\u6cd5\u8f83\u5747\u5300\uff0cJDK1.8\u5f15\u5165\u7684\u7ea2\u9ed1\u6811\u6548\u679c\u4e0d\u660e\u663e\uff0c\u4e0b\u9762\u6211\u4eec\u770b\u770bHash\u4e0d\u5747\u5300\u7684\u7684\u60c5\u51b5\u3002"),(0,l.kt)("h4",{id:"9-hash\u6781\u4e0d\u5747\u5300\u7684\u60c5\u51b5"},"9. Hash\u6781\u4e0d\u5747\u5300\u7684\u60c5\u51b5"),(0,l.kt)("p",null,"\u5047\u8bbe\u6211\u4eec\u53c8\u4e00\u4e2a\u975e\u5e38\u5dee\u7684Key\uff0c\u5b83\u4eec\u6240\u6709\u7684\u5b9e\u4f8b\u90fd\u8fd4\u56de\u76f8\u540c\u7684hashCode\u503c\u3002\u8fd9\u662f\u4f7f\u7528HashMap\u6700\u574f\u7684\u60c5\u51b5\u3002\u4ee3\u7801\u4fee\u6539\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"class Key implements Comparable<Key> {\n\n    //...\n\n    @Override\n    public int hashCode() {\n        return 1;\n    }\n}\n")),(0,l.kt)("p",null,"\u4ecd\u7136\u6267\u884cmain\u65b9\u6cd5\uff0c\u5f97\u51fa\u7684\u7ed3\u679c\u5982\u4e0b\u8868\u6240\u793a\uff1a"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashmap-compare2.png",width:""})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u4ece\u8868\u4e2d\u7ed3\u679c\u4e2d\u53ef\u77e5\uff0c\u968f\u7740size\u7684\u53d8\u5927\uff0cJDK1.7\u7684\u82b1\u8d39\u65f6\u95f4\u662f\u589e\u957f\u7684\u8d8b\u52bf\uff0c\u800cJDK1.8\u662f\u660e\u663e\u7684\u964d\u4f4e\u8d8b\u52bf\uff0c\u5e76\u4e14\u5448\u73b0\u5bf9\u6570\u589e\u957f\u7a33\u5b9a\u3002\u5f53\u4e00\u4e2a\u94fe\u8868\u592a\u957f\u7684\u65f6\u5019\uff0cHashMap\u4f1a\u52a8\u6001\u7684\u5c06\u5b83\u66ff\u6362\u6210\u4e00\u4e2a\u7ea2\u9ed1\u6811\uff0c\u8fd9\u8bdd\u7684\u8bdd\u4f1a\u5c06\u65f6\u95f4\u590d\u6742\u5ea6\u4eceO(n)\u964d\u4e3aO(logn)\u3002hash\u7b97\u6cd5\u5747\u5300\u548c\u4e0d\u5747\u5300\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u660e\u663e\u4e5f\u4e0d\u76f8\u540c\uff0c\u8fd9\u4e24\u79cd\u60c5\u51b5\u7684\u76f8\u5bf9\u6bd4\u8f83\uff0c\u53ef\u4ee5\u8bf4\u660e\u4e00\u4e2a\u597d\u7684hash\u7b97\u6cd5\u7684\u91cd\u8981\u6027\u3002"),(0,l.kt)("p",null,"\u6d4b\u8bd5\u73af\u5883\uff1a\u5904\u7406\u5668\u4e3a2.2 GHz Intel Core i7\uff0c\u5185\u5b58\u4e3a16 GB 1600 MHz DDR3\uff0cSSD\u786c\u76d8\uff0c\u4f7f\u7528\u9ed8\u8ba4\u7684JVM\u53c2\u6570\uff0c\u8fd0\u884c\u572864\u4f4d\u7684OS X 10.10.1\u4e0a\u3002"),(0,l.kt)("h4",{id:"10-hashmap\u4e0ehashtable"},"10. HashMap\u4e0eHashtable"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Hashtable \u4f7f\u7528 synchronized \u6765\u8fdb\u884c\u540c\u6b65\u3002"),(0,l.kt)("li",{parentName:"ol"},"HashMap \u53ef\u4ee5\u63d2\u5165\u952e\u4e3a null \u7684 Entry\u3002"),(0,l.kt)("li",{parentName:"ol"},"HashMap \u7684\u8fed\u4ee3\u5668\u662f fail-fast \u8fed\u4ee3\u5668\u3002"),(0,l.kt)("li",{parentName:"ol"},"HashMap \u4e0d\u80fd\u4fdd\u8bc1\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb Map \u4e2d\u7684\u5143\u7d20\u6b21\u5e8f\u662f\u4e0d\u53d8\u7684\u3002")),(0,l.kt)("h4",{id:"11-\u5c0f\u7ed3"},"11. \u5c0f\u7ed3"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u6269\u5bb9\u662f\u4e00\u4e2a\u7279\u522b\u8017\u6027\u80fd\u7684\u64cd\u4f5c\uff0c\u6240\u4ee5\u5f53\u7a0b\u5e8f\u5458\u5728\u4f7f\u7528 HashMap \u7684\u65f6\u5019\uff0c\u4f30\u7b97 map \u7684\u5927\u5c0f\uff0c\u521d\u59cb\u5316\u7684\u65f6\u5019\u7ed9\u4e00\u4e2a\u5927\u81f4\u7684\u6570\u503c\uff0c\u907f\u514d map \u8fdb\u884c\u9891\u7e41\u7684\u6269\u5bb9\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u8d1f\u8f7d\u56e0\u5b50\u662f\u53ef\u4ee5\u4fee\u6539\u7684\uff0c\u4e5f\u53ef\u4ee5\u5927\u4e8e1\uff0c\u4f46\u662f\u5efa\u8bae\u4e0d\u8981\u8f7b\u6613\u4fee\u6539\uff0c\u9664\u975e\u60c5\u51b5\u975e\u5e38\u7279\u6b8a\u3002"),(0,l.kt)("li",{parentName:"ol"},"HashMap \u662f\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\uff0c\u4e0d\u8981\u5728\u5e76\u53d1\u7684\u73af\u5883\u4e2d\u540c\u65f6\u64cd\u4f5c HashMap\uff0c\u5efa\u8bae\u4f7f\u7528 ConcurrentHashMap\u3002"),(0,l.kt)("li",{parentName:"ol"},"JDK1.8 \u5f15\u5165\u7ea2\u9ed1\u6811\u5927\u7a0b\u5ea6\u4f18\u5316\u4e86 HashMap \u7684\u6027\u80fd\u3002")),(0,l.kt)("p",null,"\u53c2\u8003\u8d44\u6599\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://tech.meituan.com/java_hashmap.html"},"Java 8\u7cfb\u5217\u4e4b\u91cd\u65b0\u8ba4\u8bc6HashMap\u2014\u2014\u7f8e\u56e2\u6280\u672f")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://juejin.im/post/5ac83fa35188255c5668afd0"},"\u641e\u61c2 Java HashMap \u6e90\u7801 - \u6398\u91d1")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://juejin.im/post/5ac4d8abf265da23a4050ae3"},"\u641e\u61c2 Java equals \u548c hashCode \u65b9\u6cd5 - \u6398\u91d1"))),(0,l.kt)("h3",{id:"concurrenthashmap"},"ConcurrentHashMap"),(0,l.kt)("h4",{id:"1-\u6982\u8ff0"},"1. \u6982\u8ff0\u3000\u3000"),(0,l.kt)("p",null,"\u3000\u3000\u4f17\u6240\u5468\u77e5\uff0c\u54c8\u5e0c\u8868\u662f\u4e2d\u975e\u5e38\u9ad8\u6548\uff0c\u590d\u6742\u5ea6\u4e3a O(1) \u7684\u6570\u636e\u7ed3\u6784\uff0c\u5728 Java \u5f00\u53d1\u4e2d\uff0c\u6211\u4eec\u6700\u5e38\u89c1\u5230\u6700\u9891\u7e41\u4f7f\u7528\u7684\u5c31\u662f HashMap \u548c Hashtable\uff0c\u4f46\u662f\u5728\u7ebf\u7a0b\u7ade\u4e89\u6fc0\u70c8\u7684\u5e76\u53d1\u573a\u666f\u4e2d\u4f7f\u7528\u90fd\u4e0d\u591f\u5408\u7406\u3002"),(0,l.kt)("p",null,"\u3000\u3000",(0,l.kt)("strong",{parentName:"p"},"HashMap")," \uff1a\u5148\u8bf4 HashMap\uff0cHashMap \u662f",(0,l.kt)("strong",{parentName:"p"},"\u7ebf\u7a0b\u4e0d\u5b89\u5168"),"\u7684\uff0c\u5728\u5e76\u53d1\u73af\u5883\u4e0b\uff0c\u53ef\u80fd\u4f1a\u5f62\u6210",(0,l.kt)("strong",{parentName:"p"},"\u73af\u72b6\u94fe\u8868"),"\uff08\u6269\u5bb9\u65f6\u53ef\u80fd\u9020\u6210\uff09\uff0c\u5bfc\u81f4 get \u64cd\u4f5c\u65f6\uff0ccpu \u7a7a\u8f6c\uff0c\u6240\u4ee5\uff0c\u5728\u5e76\u53d1\u73af\u5883\u4e2d\u4f7f \u7528HashMap \u662f\u975e\u5e38\u5371\u9669\u7684\u3002"),(0,l.kt)("p",null,"\u3000\u3000",(0,l.kt)("strong",{parentName:"p"},"Hashtable")," \uff1a Hashtable \u548c HashMap\u7684\u5b9e\u73b0\u539f\u7406\u51e0\u4e4e\u4e00\u6837\uff0c\u5dee\u522b\u65e0\u975e\u662f\uff1a\uff081\uff09Hashtable\u4e0d\u5141\u8bb8key\u548cvalue\u4e3anull\uff1b\uff082\uff09Hashtable\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002"),(0,l.kt)("p",null,"\u3000\u3000\u4f46\u662f Hashtable \u7ebf\u7a0b\u5b89\u5168\u7684\u7b56\u7565\u5b9e\u73b0\u4ee3\u4ef7\u5374\u592a\u5927\u4e86\uff0c\u7b80\u5355\u7c97\u66b4\uff0cget/put \u6240\u6709\u76f8\u5173\u64cd\u4f5c\u90fd\u662f synchronized \u7684\uff0c\u8fd9\u76f8\u5f53\u4e8e\u7ed9\u6574\u4e2a\u54c8\u5e0c\u8868\u52a0\u4e86\u4e00\u628a\u5927\u9501\uff0c\u591a\u7ebf\u7a0b\u8bbf\u95ee\u65f6\u5019\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u6216\u64cd\u4f5c\u8be5\u5bf9\u8c61\uff0c\u90a3\u5176\u4ed6\u7ebf\u7a0b\u53ea\u80fd\u963b\u585e\uff0c\u76f8\u5f53\u4e8e\u5c06\u6240\u6709\u7684\u64cd\u4f5c\u4e32\u884c\u5316\uff0c\u5728\u7ade\u4e89\u6fc0\u70c8\u7684\u5e76\u53d1\u573a\u666f\u4e2d\u6027\u80fd\u5c31\u4f1a\u975e\u5e38\u5dee\u3002"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashtable-ds.png",width:"600"})),(0,l.kt)("p",null,'\u3000\u3000Hashtable \u6027\u80fd\u5dee\u4e3b\u8981\u662f\u7531\u4e8e\u6240\u6709\u64cd\u4f5c\u9700\u8981\u7ade\u4e89\u540c\u4e00\u628a\u9501\uff0c\u800c\u5982\u679c\u5bb9\u5668\u4e2d\u6709\u591a\u628a\u9501\uff0c\u6bcf\u4e00\u628a\u9501\u9501\u4e00\u6bb5\u6570\u636e\uff0c\u8fd9\u6837\u5728\u591a\u7ebf\u7a0b\u8bbf\u95ee\u65f6\u4e0d\u540c\u6bb5\u7684\u6570\u636e\u65f6\uff0c\u5c31\u4e0d\u4f1a\u5b58\u5728\u9501\u7ade\u4e89\u4e86\uff0c\u8fd9\u6837\u4fbf\u53ef\u4ee5\u6709\u6548\u5730\u63d0\u9ad8\u5e76\u53d1\u6548\u7387\u3002\u8fd9\u5c31\u662fConcurrentHashMap \u6240\u91c7\u7528\u7684 "',(0,l.kt)("strong",{parentName:"p"},"\u5206\u6bb5\u9501"),'" \u601d\u60f3\u3002'),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashmap-ds.png",width:"600"})),(0,l.kt)("br",null),(0,l.kt)("h4",{id:"2-\u5b58\u50a8\u7ed3\u6784"},"2. \u5b58\u50a8\u7ed3\u6784"),(0,l.kt)("p",null,'ConcurrentHashMap \u91c7\u7528\u4e86\u975e\u5e38\u7cbe\u5999\u7684"\u5206\u6bb5\u9501"\u7b56\u7565\uff0cConcurrentHashMap \u7684\u4e3b\u5e72\u662f\u4e2a Segment \u6570\u7ec4\u3002'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"}," final Segment<K,V>[] segments;\n")),(0,l.kt)("p",null,"\u3000\u3000Segment \u7ee7\u627f\u4e86 ReentrantLock\uff0c\u6240\u4ee5\u5b83\u5c31\u662f\u4e00\u79cd\u53ef\u91cd\u5165\u9501\uff08ReentrantLock)\u3002\u5728 ConcurrentHashMap\uff0c\u4e00\u4e2a Segment \u5c31\u662f\u4e00\u4e2a\u5b50\u54c8\u5e0c\u8868\uff0cSegment \u91cc\u7ef4\u62a4\u4e86\u4e00\u4e2a HashEntry \u6570\u7ec4\uff0c\u5e76\u53d1\u73af\u5883\u4e0b\uff0c\u5bf9\u4e8e\u4e0d\u540c Segment \u7684\u6570\u636e\u8fdb\u884c\u64cd\u4f5c\u662f\u4e0d\u7528\u8003\u8651\u9501\u7ade\u4e89\u7684\u3002\uff08\u5c31\u6309\u9ed8\u8ba4\u7684 ConcurrentLeve \u4e3a16\u6765\u8bb2\uff0c\u7406\u8bba\u4e0a\u5c31\u5141\u8bb8 16 \u4e2a\u7ebf\u7a0b\u5e76\u53d1\u6267\u884c\uff0c\u6709\u6728\u6709\u5f88\u9177\uff09"),(0,l.kt)("p",null,"\u3000\u3000",(0,l.kt)("strong",{parentName:"p"},"\u6240\u4ee5\uff0c\u5bf9\u4e8e\u540c\u4e00\u4e2a Segment \u7684\u64cd\u4f5c\u624d\u9700\u8003\u8651\u7ebf\u7a0b\u540c\u6b65\uff0c\u4e0d\u540c\u7684 Segment \u5219\u65e0\u9700\u8003\u8651\u3002")),(0,l.kt)("p",null,"Segment \u7c7b\u4f3c\u4e8e HashMap\uff0c\u4e00\u4e2a Segment \u7ef4\u62a4\u7740\u4e00\u4e2a HashEntry \u6570\u7ec4"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"transient volatile HashEntry<K,V>[] table;\n")),(0,l.kt)("p",null,"HashEntry \u662f\u76ee\u524d\u6211\u4eec\u63d0\u5230\u7684\u6700\u5c0f\u7684\u903b\u8f91\u5904\u7406\u5355\u5143\u4e86\u3002\u4e00\u4e2a ConcurrentHashMap \u7ef4\u62a4\u4e00\u4e2a Segment \u6570\u7ec4\uff0c\u4e00\u4e2a Segment \u7ef4\u62a4\u4e00\u4e2a HashEntry \u6570\u7ec4\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"static final class HashEntry<K,V> {\n    final int hash;\n    final K key;\n    volatile V value;\n    volatile HashEntry<K,V> next;\n}\n")),(0,l.kt)("p",null,"\u3000\u3000ConcurrentHashMap \u548c HashMap \u5b9e\u73b0\u4e0a\u7c7b\u4f3c\uff0c\u6700\u4e3b\u8981\u7684\u5dee\u522b\u662f ConcurrentHashMap \u91c7\u7528\u4e86\u5206\u6bb5\u9501\uff08Segment\uff09\uff0c\u6bcf\u4e2a\u5206\u6bb5\u9501\u7ef4\u62a4\u7740\u51e0\u4e2a\u6876\uff08HashEntry\uff09\uff0c\u591a\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u540c\u65f6\u8bbf\u95ee\u4e0d\u540c\u5206\u6bb5\u9501\u4e0a\u7684\u6876\uff0c\u4ece\u800c\u4f7f\u5176\u5e76\u53d1\u5ea6\u66f4\u9ad8\uff08\u5e76\u53d1\u5ea6\u5c31\u662f Segment \u7684\u4e2a\u6570\uff09\u3002"),(0,l.kt)("p",null,"Segment \u7ee7\u627f\u81ea ",(0,l.kt)("strong",{parentName:"p"},"ReentrantLock"),"\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"static final class Segment<K,V> extends ReentrantLock implements Serializable {\n\n    private static final long serialVersionUID = 2249069246763182397L;\n\n    static final int MAX_SCAN_RETRIES =\n        Runtime.getRuntime().availableProcessors() > 1 ? 64 : 1;\n\n    transient volatile HashEntry<K,V>[] table;\n\n    transient int count;\n\n    transient int modCount;\n\n    transient int threshold;\n\n    final float loadFactor;\n}\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"final Segment<K,V>[] segments;\n")),(0,l.kt)("p",null,"\u9ed8\u8ba4\u7684\u5e76\u53d1\u7ea7\u522b\u4e3a 16\uff0c\u4e5f\u5c31\u662f\u8bf4\u9ed8\u8ba4\u521b\u5efa 16 \u4e2a Segment\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"static final int DEFAULT_CONCURRENCY_LEVEL = 16;\n")),(0,l.kt)("h4",{id:"2-size-\u64cd\u4f5c"},"2. size \u64cd\u4f5c"),(0,l.kt)("p",null,"\u6bcf\u4e2a Segment \u7ef4\u62a4\u4e86\u4e00\u4e2a count \u53d8\u91cf\u6765\u7edf\u8ba1\u8be5 Segment \u4e2d\u7684\u952e\u503c\u5bf9\u4e2a\u6570\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * The number of elements. Accessed only either within locks\n * or among other volatile reads that maintain visibility.\n */\ntransient int count;\n")),(0,l.kt)("p",null,"\u5728\u6267\u884c size \u64cd\u4f5c\u65f6\uff0c\u9700\u8981\u904d\u5386\u6240\u6709 Segment \u7136\u540e\u628a count \u7d2f\u8ba1\u8d77\u6765\u3002"),(0,l.kt)("p",null,"ConcurrentHashMap \u5728\u6267\u884c size \u64cd\u4f5c\u65f6\u5148\u5c1d\u8bd5\u4e0d\u52a0\u9501\uff0c\u5982\u679c\u8fde\u7eed\u4e24\u6b21\u4e0d\u52a0\u9501\u64cd\u4f5c\u5f97\u5230\u7684\u7ed3\u679c\u4e00\u81f4\uff0c\u90a3\u4e48\u53ef\u4ee5\u8ba4\u4e3a\u8fd9\u4e2a\u7ed3\u679c\u662f\u6b63\u786e\u7684\u3002"),(0,l.kt)("p",null,"\u5c1d\u8bd5\u6b21\u6570\u4f7f\u7528 RETRIES_BEFORE_LOCK \u5b9a\u4e49\uff0c\u8be5\u503c\u4e3a 2\uff0cretries \u521d\u59cb\u503c\u4e3a -1\uff0c\u56e0\u6b64\u5c1d\u8bd5\u6b21\u6570\u4e3a 3\u3002"),(0,l.kt)("p",null,"\u5982\u679c\u5c1d\u8bd5\u7684\u6b21\u6570\u8d85\u8fc7 3 \u6b21\uff0c\u5c31\u9700\u8981\u5bf9\u6bcf\u4e2a Segment \u52a0\u9501\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * Number of unsynchronized retries in size and containsValue\n * methods before resorting to locking. This is used to avoid\n * unbounded retries if tables undergo continuous modification\n * which would make it impossible to obtain an accurate result.\n */\nstatic final int RETRIES_BEFORE_LOCK = 2;\n\npublic int size() {\n    // Try a few times to get accurate count. On failure due to\n    // continuous async changes in table, resort to locking.\n    final Segment<K,V>[] segments = this.segments;\n    int size;\n    boolean overflow; // true if size overflows 32 bits\n    long sum;         // sum of modCounts\n    long last = 0L;   // previous sum\n    int retries = -1; // first iteration isn't retry\n    try {\n        for (;;) {\n            // \u8d85\u8fc7\u5c1d\u8bd5\u6b21\u6570\uff0c\u5219\u5bf9\u6bcf\u4e2a Segment \u52a0\u9501\n            if (retries++ == RETRIES_BEFORE_LOCK) {\n                for (int j = 0; j < segments.length; ++j)\n                    ensureSegment(j).lock(); // force creation\n            }\n            sum = 0L;\n            size = 0;\n            overflow = false;\n            for (int j = 0; j < segments.length; ++j) {\n                Segment<K,V> seg = segmentAt(segments, j);\n                if (seg != null) {\n                    sum += seg.modCount;\n                    int c = seg.count;\n                    if (c < 0 || (size += c) < 0)\n                        overflow = true;\n                }\n            }\n            // \u8fde\u7eed\u4e24\u6b21\u5f97\u5230\u7684\u7ed3\u679c\u4e00\u81f4\uff0c\u5219\u8ba4\u4e3a\u8fd9\u4e2a\u7ed3\u679c\u662f\u6b63\u786e\u7684\n            if (sum == last)\n                break;\n            last = sum;\n        }\n    } finally {\n        if (retries > RETRIES_BEFORE_LOCK) {\n            for (int j = 0; j < segments.length; ++j)\n                segmentAt(segments, j).unlock();\n        }\n    }\n    return overflow ? Integer.MAX_VALUE : size;\n}\n")),(0,l.kt)("h4",{id:"3-\u540c\u6b65\u65b9\u5f0f"},"3. \u540c\u6b65\u65b9\u5f0f"),(0,l.kt)("p",null,"Segment \u7ee7\u627f\u81ea ReentrantLock\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5bf9\u6bcf\u4e00\u4e2a Segment \u4e0a\u9501\u3002"),(0,l.kt)("p",null,"\u5bf9\u4e8e\u8bfb\u64cd\u4f5c\uff0c\u83b7\u53d6 Key \u6240\u5728\u7684 Segment \u65f6\uff0c\u9700\u8981\u4fdd\u8bc1\u53ef\u89c1\u6027\u3002\u5177\u4f53\u5b9e\u73b0\u4e0a\u53ef\u4ee5\u4f7f\u7528 volatile \u5173\u952e\u5b57\uff0c\u4e5f\u53ef\u4f7f\u7528\u9501\u3002\u4f46\u4f7f\u7528\u9501\u5f00\u9500\u592a\u5927\uff0c\u800c\u4f7f\u7528 volatile \u65f6\u6bcf\u6b21\u5199\u64cd\u4f5c\u90fd\u4f1a\u8ba9\u6240\u6709 CPU \u5185\u7f13\u5b58\u65e0\u6548\uff0c\u4e5f\u6709\u4e00\u5b9a\u5f00\u9500\u3002ConcurrentHashMap \u4f7f\u7528\u5982\u4e0b\u65b9\u6cd5\u4fdd\u8bc1\u53ef\u89c1\u6027\uff0c\u53d6\u5f97\u6700\u65b0\u7684 Segment\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"Segment<K,V> s = (Segment<K,V>)UNSAFE.getObjectVolatile(segments, u)\n")),(0,l.kt)("p",null,"\u83b7\u53d6 Segment \u4e2d\u7684 HashEntry \u65f6\u4e5f\u4f7f\u7528\u4e86\u7c7b\u4f3c\u65b9\u6cd5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"HashEntry<K,V> e = (HashEntry<K,V>) UNSAFE.getObjectVolatile\n  (tab, ((long)(((tab.length - 1) & h)) << TSHIFT) + TBASE)\n")),(0,l.kt)("p",null,"\u5bf9\u4e8e\u5199\u64cd\u4f5c\uff0c\u5e76\u4e0d\u8981\u6c42\u540c\u65f6\u83b7\u53d6\u6240\u6709 Segment \u7684\u9501\uff0c\u56e0\u4e3a\u90a3\u6837\u76f8\u5f53\u4e8e\u9501\u4f4f\u4e86\u6574\u4e2a Map\u3002\u5b83\u4f1a\u5148\u83b7\u53d6\u8be5 Key-Value \u5bf9\u6240\u5728\u7684 Segment \u7684\u9501\uff0c\u83b7\u53d6\u6210\u529f\u540e\u5c31\u53ef\u4ee5\u50cf\u64cd\u4f5c\u4e00\u4e2a\u666e\u901a\u7684 HashMap \u4e00\u6837\u64cd\u4f5c\u8be5 Segment\uff0c\u5e76\u4fdd\u8bc1\u8be5Segment \u7684\u5b89\u5168\u6027\u3002\n\u540c\u65f6\u7531\u4e8e\u5176\u5b83 Segment \u7684\u9501\u5e76\u672a\u88ab\u83b7\u53d6\uff0c\u56e0\u6b64\u7406\u8bba\u4e0a\u53ef\u652f\u6301 concurrencyLevel\uff08\u7b49\u4e8e Segment \u7684\u4e2a\u6570\uff09\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u5e76\u53d1\u8bfb\u5199\u3002"),(0,l.kt)("p",null,"\u83b7\u53d6\u9501\u65f6\uff0c\u5e76\u4e0d\u76f4\u63a5\u4f7f\u7528 lock \u6765\u83b7\u53d6\uff0c\u56e0\u4e3a\u8be5\u65b9\u6cd5\u83b7\u53d6\u9501\u5931\u8d25\u65f6\u4f1a\u6302\u8d77\u3002\u4e8b\u5b9e\u4e0a\uff0c\u5b83\u4f7f\u7528\u4e86\u81ea\u65cb\u9501\uff0c\u5982\u679c tryLock \u83b7\u53d6\u9501\u5931\u8d25\uff0c\u8bf4\u660e\u9501\u88ab\u5176\u5b83\u7ebf\u7a0b\u5360\u7528\uff0c\u6b64\u65f6\u901a\u8fc7\u5faa\u73af\u518d\u6b21\u4ee5 tryLock \u7684\u65b9\u5f0f\u7533\u8bf7\u9501\u3002\u5982\u679c\u5728\u5faa\u73af\u8fc7\u7a0b\u4e2d\u8be5 Key \u6240\u5bf9\u5e94\u7684\u94fe\u8868\u5934\u88ab\u4fee\u6539\uff0c\u5219\u91cd\u7f6e retry \u6b21\u6570\u3002\u5982\u679c retry \u6b21\u6570\u8d85\u8fc7\u4e00\u5b9a\u503c\uff0c\u5219\u4f7f\u7528 lock \u65b9\u6cd5\u7533\u8bf7\u9501\u3002"),(0,l.kt)("p",null,"\u8fd9\u91cc\u4f7f\u7528\u81ea\u65cb\u9501\u662f\u56e0\u4e3a\u81ea\u65cb\u9501\u7684\u6548\u7387\u6bd4\u8f83\u9ad8\uff0c\u4f46\u662f\u5b83\u6d88\u8017 CPU \u8d44\u6e90\u6bd4\u8f83\u591a\uff0c\u56e0\u6b64\u5728\u81ea\u65cb\u6b21\u6570\u8d85\u8fc7\u9608\u503c\u65f6\u5207\u6362\u4e3a\u4e92\u65a5\u9501\u3002"),(0,l.kt)("h4",{id:"4-jdk-18-\u7684\u6539\u52a8"},"4. JDK 1.8 \u7684\u6539\u52a8"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"JDK 1.7 \u4f7f\u7528\u5206\u6bb5\u9501\u673a\u5236\u6765\u5b9e\u73b0\u5e76\u53d1\u66f4\u65b0\u64cd\u4f5c\uff0c\u6838\u5fc3\u7c7b\u4e3a Segment\uff0c\u5b83\u7ee7\u627f\u81ea\u91cd\u5165\u9501 ReentrantLock\uff0c\u5e76\u53d1\u7a0b\u5ea6\u4e0e Segment \u6570\u91cf\u76f8\u7b49\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"JDK 1.8 \u4f7f\u7528\u4e86 CAS \u64cd\u4f5c\u6765\u652f\u6301\u66f4\u9ad8\u7684\u5e76\u53d1\u5ea6\uff0c\u5728 CAS \u64cd\u4f5c\u5931\u8d25\u65f6\u4f7f\u7528\u5185\u7f6e\u9501 synchronized\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5e76\u4e14 JDK 1.8 \u7684\u5b9e\u73b0\u4e5f\u5728\u94fe\u8868\u8fc7\u957f\u65f6\u4f1a\u8f6c\u6362\u4e3a\u7ea2\u9ed1\u6811\u3002"))),(0,l.kt)("p",null,"\u53c2\u8003\u8d44\u6599\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"http://www.jasongj.com/java/concurrenthashmap/"},"ConcurrentHashMap\u6f14\u8fdb\u4eceJava7\u5230Java8"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/chengxiao/p/6842045.html"},"ConcurrentHashMap\u5b9e\u73b0\u539f\u7406\u53ca\u6e90\u7801\u5206\u6790 - dreamcatcher-cx - \u535a\u5ba2\u56ed")))),(0,l.kt)("h3",{id:"hashset"},"HashSet"),(0,l.kt)("p",null,"\u3000\u3000\u524d\u9762\u5df2\u7ecf\u8bf4\u8fc7 HashSet \u662f\u5bf9 HashMap \u7684\u7b80\u5355\u5305\u88c5\uff0c\u5bf9 HashSet \u7684\u51fd\u6570\u8c03\u7528\u90fd\u4f1a\u8f6c\u6362\u6210\u5408\u9002\u7684 HashMap \u65b9\u6cd5\uff0c\u56e0\u6b64 HashSet \u7684\u5b9e\u73b0\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u6709\u4e0d\u5230 300 \u884c\u4ee3\u7801\uff08\u9002\u914d\u5668\u6a21\u5f0f\uff09\u3002\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"//HashSet\u662f\u5bf9HashMap\u7684\u7b80\u5355\u5305\u88c5\npublic class HashSet<E>\n{\n    ......\n    private transient HashMap<E,Object> map;//HashSet\u91cc\u9762\u6709\u4e00\u4e2aHashMap\n    // Dummy value to associate with an Object in the backing Map\n    private static final Object PRESENT = new Object();\n    public HashSet() {\n        map = new HashMap<>();\n    }\n    ......\n    public boolean add(E e) {//\u7b80\u5355\u7684\u65b9\u6cd5\u8f6c\u6362\n        return map.put(e, PRESENT)==null;\n    }\n    ......\n}\n")),(0,l.kt)("h4",{id:"1-\u6210\u5458\u53d8\u91cf"},"1. \u6210\u5458\u53d8\u91cf"),(0,l.kt)("p",null,"\u9996\u5148\u4e86\u89e3\u4e0b ",(0,l.kt)("inlineCode",{parentName:"p"},"HashSet")," \u7684\u6210\u5458\u53d8\u91cf:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"    private transient HashMap<E,Object> map;\n\n    // Dummy value to associate with an Object in the backing Map\n    private static final Object PRESENT = new Object();\n")),(0,l.kt)("p",null,"\u53d1\u73b0\u4e3b\u8981\u5c31\u4e24\u4e2a\u53d8\u91cf:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"map")," \uff1a\u7528\u4e8e\u5b58\u653e\u6700\u7ec8\u6570\u636e\u7684\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"PRESENT")," \uff1a\u662f\u6240\u6709\u5199\u5165 map \u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"value")," \u503c\u3002")),(0,l.kt)("h4",{id:"2-\u6784\u9020\u51fd\u6570"},"2. \u6784\u9020\u51fd\u6570"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"    public HashSet() {\n        map = new HashMap<>();\n    }\n    \n    public HashSet(int initialCapacity, float loadFactor) {\n        map = new HashMap<>(initialCapacity, loadFactor);\n    }    \n")),(0,l.kt)("p",null,"\u6784\u9020\u51fd\u6570\u5f88\u7b80\u5355\uff0c\u5229\u7528\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},"HashMap")," \u521d\u59cb\u5316\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},"map")," \u3002"),(0,l.kt)("h4",{id:"3-add"},"3. add()"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"    public boolean add(E e) {\n        return map.put(e, PRESENT)==null;\n    }\n")),(0,l.kt)("p",null,"\u6bd4\u8f83\u5173\u952e\u7684\u5c31\u662f\u8fd9\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"add()")," \u65b9\u6cd5\u3002 \u53ef\u4ee5\u770b\u51fa\u5b83\u662f\u5c06\u5b58\u653e\u7684\u5bf9\u8c61\u5f53\u505a\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},"HashMap")," \u7684\u5065\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"value")," \u90fd\u662f\u76f8\u540c\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"PRESENT")," \u3002\u7531\u4e8e ",(0,l.kt)("inlineCode",{parentName:"p"},"HashMap")," \u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"key")," \u662f\u4e0d\u80fd\u91cd\u590d\u7684\uff0c\u6240\u4ee5\u6bcf\u5f53\u6709\u91cd\u590d\u7684\u503c\u5199\u5165\u5230 ",(0,l.kt)("inlineCode",{parentName:"p"},"HashSet")," \u65f6\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"value")," \u4f1a\u88ab\u8986\u76d6\uff0c\u4f46 ",(0,l.kt)("inlineCode",{parentName:"p"},"key")," \u4e0d\u4f1a\u6536\u5230\u5f71\u54cd\uff0c\u8fd9\u6837\u5c31\u4fdd\u8bc1\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},"HashSet")," \u4e2d\u53ea\u80fd\u5b58\u653e\u4e0d\u91cd\u590d\u7684\u5143\u7d20\u3002"),(0,l.kt)("h4",{id:"4-\u603b\u7ed3"},"4. \u603b\u7ed3"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"HashSet")," \u7684\u539f\u7406\u6bd4\u8f83\u7b80\u5355\uff0c\u51e0\u4e4e\u5168\u90e8\u501f\u52a9\u4e8e ",(0,l.kt)("inlineCode",{parentName:"p"},"HashMap")," \u6765\u5b9e\u73b0\u7684\u3002"),(0,l.kt)("p",null,"\u6240\u4ee5 ",(0,l.kt)("inlineCode",{parentName:"p"},"HashMap")," \u4f1a\u51fa\u73b0\u7684\u95ee\u9898 ",(0,l.kt)("inlineCode",{parentName:"p"},"HashSet")," \u4f9d\u7136\u4e0d\u80fd\u907f\u514d\u3002"),(0,l.kt)("h3",{id:"linkedhashset-and-linkedhashmap"},"LinkedHashSet and LinkedHashMap"),(0,l.kt)("h4",{id:"1-\u6982\u89c8-2"},"1. \u6982\u89c8"),(0,l.kt)("p",null,"\u3000\u3000\u5982\u679c\u4f60\u5df2\u770b\u8fc7\u524d\u9762\u5173\u4e8e HashSet \u548c HashMap\uff0c\u7684\u8bb2\u89e3\uff0c\u4e00\u5b9a\u80fd\u591f\u60f3\u5230\u672c\u6587\u5c06\u8981\u8bb2\u89e3\u7684 LinkedHashSet \u548c LinkedHashMap \u5176\u5b9e\u4e5f\u662f\u4e00\u56de\u4e8b\u3002 LinkedHashSet \u548c LinkedHashMap \u5728 Java \u91cc\u4e5f\u6709\u7740\u76f8\u540c\u7684\u5b9e\u73b0\uff0c\u524d\u8005\u4ec5\u4ec5\u662f\u5bf9\u540e\u8005\u505a\u4e86\u4e00\u5c42\u5305\u88c5\uff0c\u4e5f\u5c31\u662f\u8bf4 LinkedHashSet \u91cc\u9762\u6709\u4e00\u4e2a LinkedHashMap\uff08",(0,l.kt)("strong",{parentName:"p"},"\u9002\u914d\u5668\u6a21\u5f0f"),"\uff09\u3002\u56e0\u6b64\u672c\u6587\u5c06\u91cd\u70b9\u5206\u6790 LinkedHashMap\u3002"),(0,l.kt)("p",null,"\u3000\u3000LinkedHashMap \u5b9e\u73b0\u4e86 Map \u63a5\u53e3\uff0c\u5373\u5141\u8bb8\u653e\u5165 key \u4e3a null \u7684\u5143\u7d20\uff0c\u4e5f\u5141\u8bb8\u63d2\u5165 value \u4e3a null \u7684\u5143\u7d20\u3002\u4ece\u540d\u5b57\u4e0a\u53ef\u4ee5\u770b\u51fa\u8be5\u5bb9\u5668\u662f LinkedList \u548c HashMap \u7684\u6df7\u5408\u4f53\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u540c\u65f6\u6ee1\u8db3 HashMap \u548c LinkedList \u7684\u67d0\u4e9b\u7279\u6027\u3002",(0,l.kt)("strong",{parentName:"p"},"\u53ef\u5c06 LinkedHashMap \u770b\u4f5c\u91c7\u7528 LinkedList \u589e\u5f3a\u7684 HashMap\u3002")),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/LinkedHashMap_base.png",width:"650"})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u4e8b\u5b9e\u4e0a LinkedHashMap \u662f HashMap \u7684\u76f4\u63a5\u5b50\u7c7b\uff0c",(0,l.kt)("strong",{parentName:"p"},"\u4e8c\u8005\u552f\u4e00\u7684\u533a\u522b\u662f LinkedHashMap \u5728 HashMap \u7684\u57fa\u7840\u4e0a\uff0c\u91c7\u7528\u53cc\u5411\u94fe\u8868\uff08doubly-linked list\uff09\u7684\u5f62\u5f0f\u5c06\u6240\u6709 entry \u8fde\u63a5\u8d77\u6765\uff0c\u8fd9\u6837\u662f\u4e3a\u4fdd\u8bc1\u5143\u7d20\u7684\u8fed\u4ee3\u987a\u5e8f\u8ddf\u63d2\u5165\u987a\u5e8f\u76f8\u540c"),"\u3002\u4e0a\u56fe\u7ed9\u51fa\u4e86 LinkedHashMap \u7684\u7ed3\u6784\u56fe\uff0c\u4e3b\u4f53\u90e8\u5206\u8ddf HashMap \u5b8c\u5168\u4e00\u6837\uff0c\u591a\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},"header")," \u6307\u5411\u53cc\u5411\u94fe\u8868\u7684\u5934\u90e8\uff08\u662f\u4e00\u4e2a\u54d1\u5143\uff09\uff0c",(0,l.kt)("strong",{parentName:"p"},"\u8be5\u53cc\u5411\u94fe\u8868\u7684\u8fed\u4ee3\u987a\u5e8f\u5c31\u662f entry \u7684\u63d2\u5165\u987a\u5e8f"),"\u3002"),(0,l.kt)("p",null,"\u9664\u4e86\u53ef\u4ee5\u4fdd\u8fed\u4ee3\u5386\u987a\u5e8f\uff0c\u8fd9\u79cd\u7ed3\u6784\u8fd8\u6709\u4e00\u4e2a\u597d\u5904\uff1a",(0,l.kt)("strong",{parentName:"p"},"\u8fed\u4ee3 LinkedHashMap \u65f6\u4e0d\u9700\u8981\u50cf HashMap \u90a3\u6837\u904d\u5386\u6574\u4e2atable\uff0c\u800c\u53ea\u9700\u8981\u76f4\u63a5\u904d\u5386 header \u6307\u5411\u7684\u53cc\u5411\u94fe\u8868\u5373\u53ef"),"\uff0c\u4e5f\u5c31\u662f\u8bf4 LinkedHashMap \u7684\u8fed\u4ee3\u65f6\u95f4\u5c31\u53ea\u8ddf",(0,l.kt)("inlineCode",{parentName:"p"},"entry"),"\u7684\u4e2a\u6570\u76f8\u5173\uff0c\u800c\u8ddf",(0,l.kt)("inlineCode",{parentName:"p"},"table"),"\u7684\u5927\u5c0f\u65e0\u5173\u3002"),(0,l.kt)("p",null,"\u6709\u4e24\u4e2a\u53c2\u6570\u53ef\u4ee5\u5f71\u54cd LinkedHashMap \u7684\u6027\u80fd\uff1a",(0,l.kt)("strong",{parentName:"p"},"\u521d\u59cb\u5bb9\u91cf"),"\uff08inital capacity\uff09\u548c",(0,l.kt)("strong",{parentName:"p"},"\u8d1f\u8f7d\u7cfb\u6570"),"\uff08load factor\uff09\u3002\u521d\u59cb\u5bb9\u91cf\u6307\u5b9a\u4e86\u521d\u59cb",(0,l.kt)("inlineCode",{parentName:"p"},"table"),"\u7684\u5927\u5c0f\uff0c\u8d1f\u8f7d\u7cfb\u6570\u7528\u6765\u6307\u5b9a\u81ea\u52a8\u6269\u5bb9\u7684\u4e34\u754c\u503c\u3002\u5f53",(0,l.kt)("inlineCode",{parentName:"p"},"entry"),"\u7684\u6570\u91cf\u8d85\u8fc7",(0,l.kt)("inlineCode",{parentName:"p"},"capacity*load_factor"),"\u65f6\uff0c\u5bb9\u5668\u5c06\u81ea\u52a8\u6269\u5bb9\u5e76\u91cd\u65b0\u54c8\u5e0c\u3002\u5bf9\u4e8e\u63d2\u5165\u5143\u7d20\u8f83\u591a\u7684\u573a\u666f\uff0c\u5c06\u521d\u59cb\u5bb9\u91cf\u8bbe\u5927\u53ef\u4ee5\u51cf\u5c11\u91cd\u65b0\u54c8\u5e0c\u7684\u6b21\u6570\u3002"),(0,l.kt)("p",null,"\u5c06\u5bf9\u8c61\u653e\u5165\u5230 LinkedHashMap \u6216 LinkedHashSet \u4e2d\u65f6\uff0c\u6709\u4e24\u4e2a\u65b9\u6cd5\u9700\u8981\u7279\u522b\u5173\u5fc3\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"hashCode()")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"equals()"),"\u3002",(0,l.kt)("strong",{parentName:"p"},"hashCode() \u65b9\u6cd5\u51b3\u5b9a\u4e86\u5bf9\u8c61\u4f1a\u88ab\u653e\u5230\u54ea\u4e2a bucket \u91cc\uff0c\u5f53\u591a\u4e2a\u5bf9\u8c61\u7684\u54c8\u5e0c\u503c\u51b2\u7a81\u65f6\uff0cequals() \u65b9\u6cd5\u51b3\u5b9a\u4e86\u8fd9\u4e9b\u5bf9\u8c61\u662f\u5426\u662f\u201c\u540c\u4e00\u4e2a\u5bf9\u8c61\u201d"),"\u3002\u6240\u4ee5\uff0c\u5982\u679c\u8981\u5c06\u81ea\u5b9a\u4e49\u7684\u5bf9\u8c61\u653e\u5165\u5230 ",(0,l.kt)("inlineCode",{parentName:"p"},"LinkedHashMap")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"LinkedHashSet")," \u4e2d\uff0c\u9700\u8981 ",(0,l.kt)("em",{parentName:"p"},"@Override"),(0,l.kt)("inlineCode",{parentName:"p"},"hashCode()")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"equals()")," \u65b9\u6cd5\u3002"),(0,l.kt)("p",null,"\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u8ddf\u6e90 Map \u8fed\u4ee3\u987a\u5e8f \u4e00\u6837\u7684 LinkedHashMap\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"void foo(Map m) {\n    Map copy = new LinkedHashMap(m);\n    ...\n}\n")),(0,l.kt)("p",null,"\u51fa\u4e8e\u6027\u80fd\u539f\u56e0\uff0cLinkedHashMap \u662f\u975e\u540c\u6b65\u7684\uff08not synchronized\uff09\uff0c\u5982\u679c\u9700\u8981\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4f7f\u7528\uff0c\u9700\u8981\u7a0b\u5e8f\u5458\u624b\u52a8\u540c\u6b65\uff1b\u6216\u8005\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u5c06 LinkedHashMap \u5305\u88c5\u6210\uff08wrapped\uff09\u540c\u6b65\u7684\uff1a"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Map m = Collections.synchronizedMap(new LinkedHashMap(...));")),(0,l.kt)("h4",{id:"2-get"},"2. get()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"get(Object key)")," \u65b9\u6cd5\u6839\u636e\u6307\u5b9a\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"key")," \u503c\u8fd4\u56de\u5bf9\u5e94\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"value"),"\u3002\u8be5\u65b9\u6cd5\u8ddf",(0,l.kt)("inlineCode",{parentName:"p"},"HashMap.get()"),"\u65b9\u6cd5\u7684\u6d41\u7a0b\u51e0\u4e4e\u5b8c\u5168\u4e00\u6837\uff0c\u8bfb\u8005\u53ef\u81ea\u884c",(0,l.kt)("a",{parentName:"p",href:"https://github.com/CarpenterLee/JCFInternals/blob/master/markdown/6-HashSet%20and%20HashMap.md#get"},"\u53c2\u8003\u524d\u6587"),"\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002"),(0,l.kt)("h4",{id:"3-put"},"3. put()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"put(K key, V value)")," \u65b9\u6cd5\u662f\u5c06\u6307\u5b9a\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"key, value")," \u5bf9\u6dfb\u52a0\u5230 ",(0,l.kt)("inlineCode",{parentName:"p"},"map")," \u91cc\u3002\u8be5\u65b9\u6cd5\u9996\u5148\u4f1a\u5bf9 ",(0,l.kt)("inlineCode",{parentName:"p"},"map")," \u505a\u4e00\u6b21\u67e5\u627e\uff0c\u770b\u662f\u5426\u5305\u542b\u8be5\u5143\u7ec4\uff0c\u5982\u679c\u5df2\u7ecf\u5305\u542b\u5219\u76f4\u63a5\u8fd4\u56de\uff0c\u67e5\u627e\u8fc7\u7a0b\u7c7b\u4f3c\u4e8e",(0,l.kt)("inlineCode",{parentName:"p"},"get()"),"\u65b9\u6cd5\uff1b\u5982\u679c\u6ca1\u6709\u627e\u5230\uff0c\u5219\u4f1a\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"addEntry(int hash, K key, V value, int bucketIndex)")," \u65b9\u6cd5\u63d2\u5165\u65b0\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"entry"),"\u3002"),(0,l.kt)("p",null,"\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684",(0,l.kt)("strong",{parentName:"p"},"\u63d2\u5165\u6709\u4e24\u91cd\u542b\u4e49"),"\uff1a"),(0,l.kt)("blockquote",null,(0,l.kt)("ol",{parentName:"blockquote"},(0,l.kt)("li",{parentName:"ol"},"\u4ece table \u7684\u89d2\u5ea6\u770b\uff0c\u65b0\u7684 entry \u9700\u8981\u63d2\u5165\u5230\u5bf9\u5e94\u7684 bucket \u91cc\uff0c\u5f53\u6709\u54c8\u5e0c\u51b2\u7a81\u65f6\uff0c\u91c7\u7528\u5934\u63d2\u6cd5\u5c06\u65b0\u7684 entry \u63d2\u5165\u5230\u51b2\u7a81\u94fe\u8868\u7684\u5934\u90e8\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u4ece header \u7684\u89d2\u5ea6\u770b\uff0c\u65b0\u7684 entry \u9700\u8981\u63d2\u5165\u5230\u53cc\u5411\u94fe\u8868\u7684\u5c3e\u90e8\u3002"))),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/LinkedHashMap_addEntry.png",width:"650"})),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"addEntry()"),"\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"// LinkedHashMap.addEntry()\nvoid addEntry(int hash, K key, V value, int bucketIndex) {\n    if ((size >= threshold) && (null != table[bucketIndex])) {\n        resize(2 * table.length);// \u81ea\u52a8\u6269\u5bb9\uff0c\u5e76\u91cd\u65b0\u54c8\u5e0c\n        hash = (null != key) ? hash(key) : 0;\n        bucketIndex = hash & (table.length-1);// hash%table.length\n    }\n    // 1.\u5728\u51b2\u7a81\u94fe\u8868\u5934\u90e8\u63d2\u5165\u65b0\u7684entry\n    HashMap.Entry<K,V> old = table[bucketIndex];\n    Entry<K,V> e = new Entry<>(hash, key, value, old);\n    table[bucketIndex] = e;\n    // 2.\u5728\u53cc\u5411\u94fe\u8868\u7684\u5c3e\u90e8\u63d2\u5165\u65b0\u7684entry\n    e.addBefore(header);\n    size++;\n}\n")),(0,l.kt)("p",null,"\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u7528\u5230\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},"addBefore()"),"\u65b9 \u6cd5\u5c06\u65b0 ",(0,l.kt)("inlineCode",{parentName:"p"},"entry e")," \u63d2\u5165\u5230\u53cc\u5411\u94fe\u8868\u5934\u5f15\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"header")," \u7684\u524d\u9762\uff0c\u8fd9\u6837 ",(0,l.kt)("inlineCode",{parentName:"p"},"e")," \u5c31\u6210\u4e3a\u53cc\u5411\u94fe\u8868\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u3002",(0,l.kt)("inlineCode",{parentName:"p"},"addBefore()")," \u7684\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"// LinkedHashMap.Entry.addBefor()\uff0c\u5c06this\u63d2\u5165\u5230existingEntry\u7684\u524d\u9762\nprivate void addBefore(Entry<K,V> existingEntry) {\n    after  = existingEntry;\n    before = existingEntry.before;\n    before.after = this;\n    after.before = this;\n}\n")),(0,l.kt)("p",null,"\u4e0a\u8ff0\u4ee3\u7801\u53ea\u662f\u7b80\u5355\u4fee\u6539\u76f8\u5173 ",(0,l.kt)("inlineCode",{parentName:"p"},"entry")," \u7684\u5f15\u7528\u800c\u5df2\u3002"),(0,l.kt)("h4",{id:"4-remove"},"4. remove()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"remove(Object key)"),"\u7684\u4f5c\u7528\u662f\u5220\u9664",(0,l.kt)("inlineCode",{parentName:"p"},"key"),"\u503c\u5bf9\u5e94\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"entry"),"\uff0c\u8be5\u65b9\u6cd5\u7684\u5177\u4f53\u903b\u8f91\u662f\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"removeEntryForKey(Object key)"),"\u91cc\u5b9e\u73b0\u7684\u3002",(0,l.kt)("inlineCode",{parentName:"p"},"removeEntryForKey()"),"\u65b9\u6cd5\u4f1a\u9996\u5148\u627e\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"key"),"\u503c\u5bf9\u5e94\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"entry"),"\uff0c\u7136\u540e\u5220\u9664\u8be5",(0,l.kt)("inlineCode",{parentName:"p"},"entry"),"\uff08\u4fee\u6539\u94fe\u8868\u7684\u76f8\u5e94\u5f15\u7528\uff09\u3002\u67e5\u627e\u8fc7\u7a0b\u8ddf",(0,l.kt)("inlineCode",{parentName:"p"},"get()"),"\u65b9\u6cd5\u7c7b\u4f3c\u3002"),(0,l.kt)("p",null,"\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684",(0,l.kt)("strong",{parentName:"p"},"\u5220\u9664\u4e5f\u6709\u4e24\u91cd\u542b\u4e49"),"\uff1a"),(0,l.kt)("blockquote",null,(0,l.kt)("ol",{parentName:"blockquote"},(0,l.kt)("li",{parentName:"ol"},"\u4ece",(0,l.kt)("inlineCode",{parentName:"li"},"table"),"\u7684\u89d2\u5ea6\u770b\uff0c\u9700\u8981\u5c06\u8be5",(0,l.kt)("inlineCode",{parentName:"li"},"entry"),"\u4ece\u5bf9\u5e94\u7684",(0,l.kt)("inlineCode",{parentName:"li"},"bucket"),"\u91cc\u5220\u9664\uff0c\u5982\u679c\u5bf9\u5e94\u7684\u51b2\u7a81\u94fe\u8868\u4e0d\u7a7a\uff0c\u9700\u8981\u4fee\u6539\u51b2\u7a81\u94fe\u8868\u7684\u76f8\u5e94\u5f15\u7528\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u4ece",(0,l.kt)("inlineCode",{parentName:"li"},"header"),"\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u9700\u8981\u5c06\u8be5",(0,l.kt)("inlineCode",{parentName:"li"},"entry"),"\u4ece\u53cc\u5411\u94fe\u8868\u4e2d\u5220\u9664\uff0c\u540c\u65f6\u4fee\u6539\u94fe\u8868\u4e2d\u524d\u9762\u4ee5\u53ca\u540e\u9762\u5143\u7d20\u7684\u76f8\u5e94\u5f15\u7528\u3002"))),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/LinkedList_remove.png",width:"700"})),(0,l.kt)("br",null),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"removeEntryForKey()")," \u5bf9\u5e94\u7684\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-javascript"},"// LinkedHashMap.removeEntryForKey()\uff0c\u5220\u9664key\u503c\u5bf9\u5e94\u7684entry\nfinal Entry<K,V> removeEntryForKey(Object key) {\n    ......\n    int hash = (key == null) ? 0 : hash(key);\n    int i = indexFor(hash, table.length);// hash&(table.length-1)\n    Entry<K,V> prev = table[i];// \u5f97\u5230\u51b2\u7a81\u94fe\u8868\n    Entry<K,V> e = prev;\n    while (e != null) {// \u904d\u5386\u51b2\u7a81\u94fe\u8868\n        Entry<K,V> next = e.next;\n        Object k;\n        if (e.hash == hash &&\n            ((k = e.key) == key || (key != null && key.equals(k)))) {// \u627e\u5230\u8981\u5220\u9664\u7684entry\n            modCount++; size--;\n            // 1. \u5c06e\u4ece\u5bf9\u5e94bucket\u7684\u51b2\u7a81\u94fe\u8868\u4e2d\u5220\u9664\n            if (prev == e) table[i] = next;\n            else prev.next = next;\n            // 2. \u5c06e\u4ece\u53cc\u5411\u94fe\u8868\u4e2d\u5220\u9664\n            e.before.after = e.after;\n            e.after.before = e.before;\n            return e;\n        }\n        prev = e; e = next;\n    }\n    return e;\n}\n")),(0,l.kt)("h4",{id:"5-linkedhashset"},"5. LinkedHashSet"),(0,l.kt)("p",null,"\u524d\u9762\u5df2\u7ecf\u8bf4\u8fc7",(0,l.kt)("em",{parentName:"p"},"LinkedHashSet"),"\u662f\u5bf9",(0,l.kt)("em",{parentName:"p"},"LinkedHashMap"),"\u7684\u7b80\u5355\u5305\u88c5\uff0c\u5bf9",(0,l.kt)("em",{parentName:"p"},"LinkedHashSet"),"\u7684\u51fd\u6570\u8c03\u7528\u90fd\u4f1a\u8f6c\u6362\u6210\u5408\u9002\u7684",(0,l.kt)("em",{parentName:"p"},"LinkedHashMap"),"\u65b9\u6cd5\uff0c\u56e0\u6b64",(0,l.kt)("em",{parentName:"p"},"LinkedHashSet"),"\u7684\u5b9e\u73b0\u975e\u5e38\u7b80\u5355\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public class LinkedHashSet<E>\n    extends HashSet<E>\n    implements Set<E>, Cloneable, java.io.Serializable {\n    ......\n    // LinkedHashSet\u91cc\u9762\u6709\u4e00\u4e2aLinkedHashMap\n    public LinkedHashSet(int initialCapacity, float loadFactor) {\n        map = new LinkedHashMap<>(initialCapacity, loadFactor);\n    }\n    ......\n    public boolean add(E e) {//\u7b80\u5355\u7684\u65b9\u6cd5\u8f6c\u6362\n        return map.put(e, PRESENT)==null;\n    }\n    ......\n}\n")),(0,l.kt)("h4",{id:"6-linkedhashmap\u7ecf\u5178\u7528\u6cd5"},"6. LinkedHashMap\u7ecf\u5178\u7528\u6cd5"),(0,l.kt)("p",null,"LinkedHashMap \u9664\u4e86\u53ef\u4ee5\u4fdd\u8bc1\u8fed\u4ee3\u987a\u5e8f\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u975e\u5e38\u6709\u7528\u7684\u7528\u6cd5\uff1a\u53ef\u4ee5\u8f7b\u677e\u5b9e\u73b0\u4e00\u4e2a\u91c7\u7528\u4e86FIFO\u66ff\u6362\u7b56\u7565\u7684\u7f13\u5b58\u3002\u5177\u4f53\u8bf4\u6765\uff0cLinkedHashMap \u6709\u4e00\u4e2a\u5b50\u7c7b\u65b9\u6cd5 ",(0,l.kt)("inlineCode",{parentName:"p"},"protected boolean removeEldestEntry(Map.Entry<K,V> eldest)"),"\uff0c\u8be5\u65b9\u6cd5\u7684\u4f5c\u7528\u662f\u544a\u8bc9 Map \u662f\u5426\u8981\u5220\u9664\u201c\u6700\u8001\u201d\u7684 Entry\uff0c\u6240\u8c13\u6700\u8001\u5c31\u662f\u5f53\u524d Map \u4e2d\u6700\u65e9\u63d2\u5165\u7684 Entry\uff0c\u5982\u679c\u8be5\u65b9\u6cd5\u8fd4\u56de true\uff0c\u6700\u8001\u7684\u90a3\u4e2a\u5143\u7d20\u5c31\u4f1a\u88ab\u5220\u9664\u3002\u5728\u6bcf\u6b21\u63d2\u5165\u65b0\u5143\u7d20\u7684\u4e4b\u540e LinkedHashMap \u4f1a\u81ea\u52a8\u8be2\u95ee removeEldestEntry() \u662f\u5426\u8981\u5220\u9664\u6700\u8001\u7684\u5143\u7d20\u3002\u8fd9\u6837\u53ea\u9700\u8981\u5728\u5b50\u7c7b\u4e2d\u91cd\u8f7d\u8be5\u65b9\u6cd5\uff0c\u5f53\u5143\u7d20\u4e2a\u6570\u8d85\u8fc7\u4e00\u5b9a\u6570\u91cf\u65f6\u8ba9 removeEldestEntry() \u8fd4\u56de true\uff0c\u5c31\u80fd\u591f\u5b9e\u73b0\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684 FIFO \u7b56\u7565\u7684\u7f13\u5b58\u3002\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"/** \u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684FIFO\u66ff\u6362\u7b56\u7565\u7684\u7f13\u5b58 */\nclass FIFOCache<K, V> extends LinkedHashMap<K, V>{\n    private final int cacheSize;\n    public FIFOCache(int cacheSize){\n        this.cacheSize = cacheSize;\n    }\n\n    // \u5f53Entry\u4e2a\u6570\u8d85\u8fc7cacheSize\u65f6\uff0c\u5220\u9664\u6700\u8001\u7684Entry\n    @Override\n    protected boolean removeEldestEntry(Map.Entry<K,V> eldest) {\n       return size() > cacheSize;\n    }\n}\n")),(0,l.kt)("h2",{id:"\u4e09\u5bb9\u5668\u4e2d\u7684\u8bbe\u8ba1\u6a21\u5f0f"},"\u4e09\u3001\u5bb9\u5668\u4e2d\u7684\u8bbe\u8ba1\u6a21\u5f0f"),(0,l.kt)("h3",{id:"\u8fed\u4ee3\u5668\u6a21\u5f0f"},"\u8fed\u4ee3\u5668\u6a21\u5f0f"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/Iterator-1.jpg",width:""})),(0,l.kt)("br",null),(0,l.kt)("p",null,"Collection \u5b9e\u73b0\u4e86 Iterable \u63a5\u53e3\uff0c\u5176\u4e2d\u7684 iterator() \u65b9\u6cd5\u80fd\u591f\u4ea7\u751f\u4e00\u4e2a Iterator \u5bf9\u8c61\uff0c\u901a\u8fc7\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u53ef\u4ee5\u8fed\u4ee3\u904d\u5386 Collection \u4e2d\u7684\u5143\u7d20\u3002"),(0,l.kt)("p",null,"\u4ece JDK 1.5 \u4e4b\u540e\u53ef\u4ee5\u4f7f\u7528 foreach \u65b9\u6cd5\u6765\u904d\u5386\u5b9e\u73b0\u4e86 Iterable \u63a5\u53e3\u7684\u805a\u5408\u5bf9\u8c61\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'List<String> list = new ArrayList<>();\nlist.add("a");\nlist.add("b");\nfor (String item : list) {\n    System.out.println(item);\n}\n')),(0,l.kt)("h3",{id:"\u9002\u914d\u5668\u6a21\u5f0f"},"\u9002\u914d\u5668\u6a21\u5f0f"),(0,l.kt)("p",null,"java.util.Arrays.asList() \u53ef\u4ee5\u628a\u6570\u7ec4\u7c7b\u578b\u8f6c\u6362\u4e3a List \u7c7b\u578b\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@SafeVarargs\npublic static <T> List<T> asList(T... a)\n")),(0,l.kt)("p",null,"\u5982\u679c\u8981\u5c06\u6570\u7ec4\u7c7b\u578b\u8f6c\u6362\u4e3a List \u7c7b\u578b\uff0c\u5e94\u8be5\u6ce8\u610f\u7684\u662f asList() \u7684\u53c2\u6570\u4e3a\u6cdb\u578b\u7684\u53d8\u957f\u53c2\u6570\uff0c\u56e0\u6b64\u4e0d\u80fd\u4f7f\u7528\u57fa\u672c\u7c7b\u578b\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\uff0c\u53ea\u80fd\u4f7f\u7528\u76f8\u5e94\u7684\u5305\u88c5\u7c7b\u578b\u6570\u7ec4\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"Integer[] arr = {1, 2, 3};\nList list = Arrays.asList(arr);\n")),(0,l.kt)("p",null,"\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u751f\u6210 List\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"List list = Arrays.asList(1,2,3);\n")),(0,l.kt)("h2",{id:"\u56db\u9762\u8bd5\u6307\u5357"},"\u56db\u3001\u9762\u8bd5\u6307\u5357"),(0,l.kt)("h3",{id:"1-arraylist\u548clinkedlist\u533a\u522b"},"1. ArrayList\u548cLinkedList\u533a\u522b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"ArrayList \u548c LinkedList \u53ef\u60f3\u4ece\u540d\u5b57\u5206\u6790\uff0c\u5b83\u4eec\u4e00\u4e2a\u662f Array (\u52a8\u6001\u6570\u7ec4) \u7684\u6570\u636e\u7ed3\u6784\uff0c\u4e00\u4e2a\u662f Link (\u94fe\u8868) \u7684\u6570\u636e\u7ed3\u6784\uff0c\u6b64\u5916\uff0c\u5b83\u4eec\u4e24\u4e2a\u90fd\u662f\u5bf9 List \u63a5\u53e3\u7684\u5b9e\u73b0\u3002\u524d\u8005\u662f\u6570\u7ec4\u961f\u5217\uff0c\u76f8\u5f53\u4e8e\u52a8\u6001\u6570\u7ec4\uff1b\u540e\u8005\u4e3a\u53cc\u5411\u94fe\u8868\u7ed3\u6784\uff0c\u4e5f\u53ef\u5f53\u4f5c\u5806\u6808\u3001\u961f\u5217\u3001\u53cc\u7aef\u961f\u5217\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5f53\u968f\u673a\u8bbf\u95ee List \u65f6"),"\uff08get\u548cset\u64cd\u4f5c\uff09\uff0cArrayList \u6bd4 LinkedList\u7684\u6548\u7387\u66f4\u9ad8\uff0c\u56e0\u4e3a LinkedList \u662f\u7ebf\u6027\u7684\u6570\u636e\u5b58\u50a8\u65b9\u5f0f\uff0c\u6240\u4ee5\u9700\u8981\u79fb\u52a8\u6307\u9488\u4ece\u524d\u5f80\u540e\u4f9d\u6b21\u67e5\u627e\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5f53\u5bf9\u6570\u636e\u8fdb\u884c\u589e\u52a0\u548c\u5220\u9664\u7684\u64cd\u4f5c\u65f6"),"\uff08add \u548c remove \u64cd\u4f5c\uff09\uff0cLinkedList \u6bd4 ArrayList \u7684\u6548\u7387\u66f4\u9ad8\uff0c\u56e0\u4e3a ArrayList \u662f\u6570\u7ec4\uff0c\u6240\u4ee5\u5728\u5176\u4e2d\u8fdb\u884c\u589e\u5220\u64cd\u4f5c\u65f6\uff0c\u4f1a\u5bf9\u64cd\u4f5c\u70b9\u4e4b\u540e\u6240\u6709\u6570\u636e\u7684\u4e0b\u6807\u7d22\u5f15\u9020\u6210\u5f71\u54cd\uff0c\u9700\u8981\u8fdb\u884c\u6570\u636e\u7684\u79fb\u52a8\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u4ece\u5229\u7528\u6548\u7387\u6765\u770b"),"\uff0cArrayList \u81ea\u7531\u6027\u8f83\u4f4e\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u624b\u52a8\u7684\u8bbe\u7f6e\u56fa\u5b9a\u5927\u5c0f\u7684\u5bb9\u91cf\uff0c\u4f46\u662f\u5b83\u7684\u4f7f\u7528\u6bd4\u8f83\u65b9\u4fbf\uff0c\u53ea\u9700\u8981\u521b\u5efa\uff0c\u7136\u540e\u6dfb\u52a0\u6570\u636e\uff0c\u901a\u8fc7\u8c03\u7528\u4e0b\u6807\u8fdb\u884c\u4f7f\u7528\uff1b\u800c LinkedList \u81ea\u7531\u6027\u8f83\u9ad8\uff0c\u80fd\u591f\u52a8\u6001\u7684\u968f\u6570\u636e\u91cf\u7684\u53d8\u5316\u800c\u53d8\u5316\uff0c\u4f46\u662f\u5b83\u4e0d\u4fbf\u4e8e\u4f7f\u7528\uff1b"),(0,l.kt)("li",{parentName:"ul"},"ArrayList \u4e3b\u8981\u7a7a\u95f4\u5f00\u9500\u5728\u4e8e\u9700\u8981\u5728 List \u5217\u8868\u9884\u7559\u4e00\u5b9a\u7a7a\u95f4\uff1b\u800c LinkList \u4e3b\u8981\u63a7\u4ef6\u5f00\u9500\u5728\u4e8e\u9700\u8981\u5b58\u50a8\u7ed3\u70b9\u4fe1\u606f\u4ee5\u53ca\u7ed3\u70b9\u6307\u9488\u4fe1\u606f\u3002")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"ArrayList\u3001LinkedList \u548c Vector\u5982\u4f55\u9009\u62e9\uff1f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5f53\u5bf9\u6570\u636e\u7684\u4e3b\u8981\u64cd\u4f5c\u4e3a\u7d22\u5f15\u6216\u53ea\u5728\u96c6\u5408\u7684\u672b\u7aef\u589e\u52a0\u3001\u5220\u9664\u5143\u7d20\u65f6\uff0c\u4f7f\u7528 ArrayList \u6216 Vector \u6548\u7387\u6bd4\u8f83\u9ad8\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u5bf9\u6570\u636e\u7684\u64cd\u4f5c\u4e3b\u8981\u4e3a\u6307\u5b9a\u4f4d\u7f6e\u7684\u63d2\u5165\u6216\u5220\u9664\u64cd\u4f5c\u65f6\uff0c\u4f7f\u7528 LinkedList \u6548\u7387\u6bd4\u8f83\u9ad8\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u5728\u591a\u7ebf\u7a0b\u4e2d\u4f7f\u7528\u5bb9\u5668\u65f6\uff08\u5373\u591a\u4e2a\u7ebf\u7a0b\u4f1a\u540c\u65f6\u8bbf\u95ee\u8be5\u5bb9\u5668\uff09\uff0c\u9009\u7528 Vector \u8f83\u4e3a\u5b89\u5168\uff1b")))),(0,l.kt)("h3",{id:"2-hashmap\u548chashtable\u533a\u522bhashmap\u7684key\u7c7b\u578b"},"2. HashMap\u548cHashtable\u533a\u522b\uff0cHashMap\u7684key\u7c7b\u578b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"HashMap\u548cHashtable\u7684\u533a\u522b"),"  "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Hashtable \u7684\u65b9\u6cd5\u662f\u540c\u6b65\u7684\uff0cHashMap \u975e\u540c\u6b65\uff0c\u6240\u4ee5\u5728\u591a\u7ebf\u7a0b\u573a\u5408\u8981\u624b\u52a8\u540c\u6b65\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Hashtable \u4e0d\u5141\u8bb8 null \u503c (key \u548c value \u90fd\u4e0d\u53ef\u4ee5)\uff0cHashMap \u5141\u8bb8 null \u503c( key \u548c value \u90fd\u53ef\u4ee5)\u3002 ")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4e24\u8005\u7684\u904d\u5386\u65b9\u5f0f\u5927\u540c\u5c0f\u5f02\uff0cHashtable \u4ec5\u4ec5\u6bd4 HashMap \u591a\u4e00\u4e2a elements \u65b9\u6cd5\u3002 ")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Hashtable\u202f\u548c\u202fHashMap\u202f\u90fd\u80fd\u901a\u8fc7 values() \u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a Collection \uff0c\u7136\u540e\u8fdb\u884c\u904d\u5386\u5904\u7406\u3002 ")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4e24\u8005\u4e5f\u90fd\u53ef\u4ee5\u901a\u8fc7 entrySet() \u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a Set \uff0c \u7136\u540e\u8fdb\u884c\u904d\u5386\u5904\u7406\u3002 ")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Hashtable \u4f7f\u7528 Enumeration\uff0cHashMap \u4f7f\u7528 Iterator\u3002 ")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u54c8\u5e0c\u503c\u7684\u4f7f\u7528\u4e0d\u540c\uff0cHashtable \u76f4\u63a5\u4f7f\u7528\u5bf9\u8c61\u7684 hashCode\u3002\u800c HashMap \u91cd\u65b0\u8ba1\u7b97hash\u503c\uff0c\u800c\u4e14\u7528\u4e8e\u4ee3\u66ff\u6c42\u6a21\u3002 ")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Hashtable \u4e2d hash \u6570\u7ec4\u9ed8\u8ba4\u5927\u5c0f\u662f11\uff0c\u589e\u52a0\u7684\u65b9\u5f0f\u662f old*2+1\u3002HashMap \u4e2d hash \u6570\u7ec4\u7684\u9ed8\u8ba4\u5927\u5c0f\u662f16\uff0c\u800c\u4e14\u4e00\u5b9a\u662f 2 \u7684\u6307\u6570\u3002 ")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Hashtable \u57fa\u4e8e Dictionary \u7c7b\uff0c\u800c HashMap \u57fa\u4e8e AbstractMap \u7c7b ")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"HashMap\u4e2d\u7684key\u53ef\u4ee5\u662f\u4efb\u4f55\u5bf9\u8c61\u6216\u6570\u636e\u7c7b\u578b\u5417")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u4e3anull\uff0c\u4f46\u4e0d\u80fd\u662f\u53ef\u53d8\u5bf9\u8c61\uff0c\u5982\u679c\u662f\u53ef\u53d8\u5bf9\u8c61\u7684\u8bdd\uff0c\u5bf9\u8c61\u4e2d\u7684\u5c5e\u6027\u6539\u53d8\uff0c\u5219\u5bf9\u8c61 HashCode \u4e5f\u8fdb\u884c\u76f8\u5e94\u7684\u6539\u53d8\uff0c\u5bfc\u81f4\u4e0b\u6b21\u65e0\u6cd5\u67e5\u627e\u5230\u5df2\u5b58\u5728Map\u4e2d\u7684\u6570\u636e\u3002 "),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u53ef\u53d8\u5bf9\u8c61\u5728 HashMap \u4e2d\u88ab\u7528\u4f5c\u952e\uff0c\u90a3\u5c31\u8981\u5c0f\u5fc3\u5728\u6539\u53d8\u5bf9\u8c61\u72b6\u6001\u7684\u65f6\u5019\uff0c\u4e0d\u8981\u6539\u53d8\u5b83\u7684\u54c8\u5e0c\u503c\u4e86\u3002\u6211\u4eec\u53ea\u9700\u8981\u4fdd\u8bc1\u6210\u5458\u53d8\u91cf\u7684\u6539\u53d8\u80fd\u4fdd\u8bc1\u8be5\u5bf9\u8c61\u7684\u54c8\u5e0c\u503c\u4e0d\u53d8\u5373\u53ef\u3002 "))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Hashtable\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u4e48")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Hashtable \u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u5176\u5b9e\u73b0\u662f\u5728\u5bf9\u5e94\u7684\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u4e86 synchronized \u5173\u952e\u5b57\u8fdb\u884c\u4fee\u9970\uff0c\u7531\u4e8e\u5728\u6267\u884c\u6b64\u65b9\u6cd5\u7684\u65f6\u5019\u9700\u8981\u83b7\u5f97\u5bf9\u8c61\u9501\uff0c\u5219\u6267\u884c\u8d77\u6765\u6bd4\u8f83\u6162\u3002\u6240\u4ee5\u73b0\u5728\u5982\u679c\u4e3a\u4e86\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u7684\u8bdd\uff0c\u4f7f\u7528 CurrentHashMap\u3002 ")))),(0,l.kt)("h3",{id:"3-hashmap\u548cconcurrenthashmap"},"3. HashMap\u548cConcurrentHashMap"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"HashMap\u548cConcurrent\u202fHashMap\u533a\u522b\uff1f")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"HashMap \u662f\u975e\u7ebf\u7a0b\u5b89\u5168\u7684\uff0cCurrentHashMap \u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002 "),(0,l.kt)("li",{parentName:"ul"},"ConcurrentHashMap \u5c06\u6574\u4e2a Hash \u6876\u8fdb\u884c\u4e86\u5206\u6bb5 segment\uff0c\u4e5f\u5c31\u662f\u5c06\u8fd9\u4e2a\u5927\u7684\u6570\u7ec4\u5206\u6210\u4e86\u51e0\u4e2a\u5c0f\u7684\u7247\u6bb5segment\uff0c\u800c\u4e14\u6bcf\u4e2a\u5c0f\u7684\u7247\u6bb5 segment \u4e0a\u9762\u90fd\u6709\u9501\u5b58\u5728\uff0c\u90a3\u4e48\u5728\u63d2\u5165\u5143\u7d20\u7684\u65f6\u5019\u5c31\u9700\u8981\u5148\u627e\u5230\u5e94\u8be5\u63d2\u5165\u5230\u54ea\u4e00\u4e2a\u7247\u6bb5 segment\uff0c\u7136\u540e\u518d\u5728\u8fd9\u4e2a\u7247\u6bb5\u4e0a\u9762\u8fdb\u884c\u63d2\u5165\uff0c\u800c\u4e14\u8fd9\u91cc\u8fd8\u9700\u8981\u83b7\u53d6 segment \u9501\u3002 "),(0,l.kt)("li",{parentName:"ul"},"ConcurrentHashMap \u8ba9\u9501\u7684\u7c92\u5ea6\u66f4\u7cbe\u7ec6\u4e00\u4e9b\uff0c\u5e76\u53d1\u6027\u80fd\u66f4\u597d\u3002 "))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"ConcurrentHashMap\u202f\u7ebf\u7a0b\u5b89\u5168\u5417\uff0c\u202fConcurrentHashMap\u5982\u4f55\u4fdd\u8bc1\u202f\u7ebf\u7a0b\u5b89\u5168\uff1f")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Hashtable \u5bb9\u5668\u5728\u7ade\u4e89\u6fc0\u70c8\u7684\u5e76\u53d1\u73af\u5883\u4e0b\u8868\u73b0\u51fa\u6548\u7387\u4f4e\u4e0b\u7684\u539f\u56e0\u662f\u6240\u6709\u8bbf\u95ee Hashtable \u7684\u7ebf\u7a0b\u90fd\u5fc5\u987b\u7ade\u4e89\u540c\u4e00\u628a\u9501\uff0c\u90a3\u5047\u5982\u5bb9\u5668\u91cc\u6709\u591a\u628a\u9501\uff0c\u6bcf\u4e00\u628a\u9501\u7528\u4e8e\u9501\u5bb9\u5668\u5176\u4e2d\u4e00\u90e8\u5206\u6570\u636e\uff0c\u90a3\u4e48\u5f53\u591a\u7ebf\u7a0b\u8bbf\u95ee\u5bb9\u5668\u91cc\u4e0d\u540c\u6570\u636e\u6bb5\u7684\u6570\u636e\u65f6\uff0c\u7ebf\u7a0b\u95f4\u5c31\u4e0d\u4f1a\u5b58\u5728\u9501\u7ade\u4e89\uff0c\u4ece\u800c\u53ef\u4ee5\u6709\u6548\u7684\u63d0\u9ad8\u5e76\u53d1\u8bbf\u95ee\u6548\u7387\uff0c\u8fd9\u5c31\u662f ConcurrentHashMap \u6240\u4f7f\u7528\u7684",(0,l.kt)("strong",{parentName:"li"},"\u5206\u6bb5\u9501"),"\uff0c\u9996\u5148\u5c06\u6570\u636e\u5206\u6210\u4e00\u6bb5\u4e00\u6bb5\u7684\u5b58\u50a8\uff0c\u7136\u540e\u7ed9\u6bcf\u4e00\u6bb5\u6570\u636e\u914d\u4e00\u628a\u9501\uff0c\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5360\u7528\u9501\u8bbf\u95ee\u5176\u4e2d\u4e00\u4e2a\u6bb5\u6570\u636e\u7684\u65f6\u5019\uff0c\u5176\u4ed6\u6bb5\u7684\u6570\u636e\u4e5f\u80fd\u88ab\u5176\u4ed6\u7ebf\u7a0b\u8bbf\u95ee\u3002 "),(0,l.kt)("li",{parentName:"ul"},"get \u64cd\u4f5c\u7684\u9ad8\u6548\u4e4b\u5904\u5728\u4e8e\u6574\u4e2a get \u8fc7\u7a0b\u4e0d\u9700\u8981\u52a0\u9501\uff0c\u9664\u975e\u8bfb\u5230\u7684\u503c\u662f\u7a7a\u7684\u624d\u4f1a\u52a0\u9501\u91cd\u8bfb\u3002",(0,l.kt)("strong",{parentName:"li"},"get \u65b9\u6cd5\u91cc\u5c06\u8981\u4f7f\u7528\u7684\u5171\u4eab\u53d8\u91cf\u90fd\u5b9a\u4e49\u6210 volatile"),"\uff0c\u5982\u7528\u4e8e\u7edf\u8ba1\u5f53\u524d Segement \u5927\u5c0f\u7684 count \u5b57\u6bb5\u548c\u7528\u4e8e\u5b58\u50a8\u503c\u7684 HashEntry \u7684 value\u3002\u5b9a\u4e49\u6210 volatile \u7684\u53d8\u91cf\uff0c\u80fd\u591f\u5728\u7ebf\u7a0b\u4e4b\u95f4\u4fdd\u6301\u53ef\u89c1\u6027\uff0c\u80fd\u591f\u88ab\u591a\u7ebf\u7a0b\u540c\u65f6\u8bfb\uff0c\u5e76\u4e14\u4fdd\u8bc1\u4e0d\u4f1a\u8bfb\u5230\u8fc7\u671f\u7684\u503c\uff0c\u4f46\u662f\u53ea\u80fd\u88ab\u5355\u7ebf\u7a0b\u5199\uff08\u6709\u4e00\u79cd\u60c5\u51b5\u53ef\u4ee5\u88ab\u591a\u7ebf\u7a0b\u5199\uff0c\u5c31\u662f\u5199\u5165\u7684\u503c\u4e0d\u4f9d\u8d56\u4e8e\u539f\u503c\uff09\uff0c\u5728 get \u64cd\u4f5c\u91cc\u53ea\u9700\u8981\u8bfb\u4e0d\u9700\u8981\u5199\u5171\u4eab\u53d8\u91cf count \u548c value\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e0d\u7528\u52a0\u9501\u3002 "),(0,l.kt)("li",{parentName:"ul"},"put \u65b9\u6cd5\u9996\u5148\u5b9a\u4f4d\u5230 Segment\uff0c\u7136\u540e\u5728 Segment \u91cc\u8fdb\u884c\u63d2\u5165\u64cd\u4f5c\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u63d2\u5165\u64cd\u4f5c\u9700\u8981\u7ecf\u5386\u4e24\u4e2a\u6b65\u9aa4\uff1a\uff081\uff09\u5224\u65ad\u662f\u5426\u9700\u8981\u5bf9 Segment \u91cc\u7684 HashEntry \u6570\u7ec4\u8fdb\u884c\u6269\u5bb9\uff1b\uff082\uff09\u5b9a\u4f4d\u6dfb\u52a0\u5143\u7d20\u7684\u4f4d\u7f6e\u7136\u540e\u653e\u5728HashEntry\u6570\u7ec4\u91cc\u3002 ")))))),(0,l.kt)("h3",{id:"4-hashtable\u7684\u539f\u7406"},"4. Hashtable\u7684\u539f\u7406"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Hashtable \u4f7f\u7528\u94fe\u5730\u5740\u6cd5\u8fdb\u884c\u5143\u7d20\u5b58\u50a8\uff0c\u901a\u8fc7\u4e00\u4e2a\u5b9e\u9645\u7684\u4f8b\u5b50\u6765\u6f14\u793a\u4e00\u4e0b\u63d2\u5165\u5143\u7d20\u7684\u8fc7\u7a0b\uff1a")),(0,l.kt)("p",null,"\u5047\u8bbe\u6211\u4eec\u73b0\u5728 Hashtable \u7684\u5bb9\u91cf\u4e3a 5\uff0c\u5df2\u7ecf\u5b58\u5728\u4e86 (8,8)\uff0c(10,10)\uff0c(13,13)\uff0c(16,16)\uff0c(17,17)\uff0c(21,21) \u8fd9 6 \u4e2a\u952e\u503c\u5bf9\uff0c\u76ee\u524d\u4ed6\u4eec\u5728 Hashtable \u4e2d\u7684\u4f4d\u7f6e\u5982\u4e0b\uff1a"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashtable1.png",width:""})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u73b0\u5728\uff0c\u6211\u4eec\u63d2\u5165\u4e00\u4e2a\u65b0\u7684\u952e\u503c\u5bf9\uff0cput(16,22)\uff0c\u5047\u8bbe key=16 \u7684\u7d22\u5f15\u4e3a 1.\u4f46\u73b0\u5728\u7d22\u5f15 1 \u7684\u4f4d\u7f6e\u6709\u4e24\u4e2a Entry \u4e86\uff0c\u6240\u4ee5\u7a0b\u5e8f\u4f1a\u5bf9\u94fe\u8868\u8fdb\u884c\u8fed\u4ee3\u3002\u8fed\u4ee3\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53d1\u73b0\u5176\u4e2d\u6709\u4e00\u4e2a Entry \u7684 key \u548c\u6211\u4eec\u8981\u63d2\u5165\u7684\u952e\u503c\u5bf9\u7684 key \u76f8\u540c\uff0c\u6240\u4ee5\u73b0\u5728\u4f1a\u505a\u7684\u5de5\u4f5c\u5c31\u662f\u5c06 newValue=22 \u66ff\u6362 oldValue=16\uff0c\u7136\u540e\u8fd4\u56de oldValue = 16. "),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashtable2.png",width:""})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u7136\u540e\u6211\u4eec\u73b0\u5728\u518d\u63d2\u5165\u4e00\u4e2a\uff0cput(33,33)\uff0ckey=33 \u7684\u7d22\u5f15\u4e3a 3\uff0c\u5e76\u4e14\u5728\u94fe\u8868\u4e2d\u4e5f\u4e0d\u5b58\u5728 key=33 \u7684 Entry\uff0c\u6240\u4ee5\u5c06\u8be5\u8282\u70b9\u63d2\u5165\u94fe\u8868\u7684\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u3002 "),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hashtable3.png",width:""})),(0,l.kt)("br",null),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Hashtable \u4e0e HashMap \u7684\u7b80\u5355\u6bd4\u8f83")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Hashtable \u57fa\u4e8e Dictionary \u7c7b\uff0c\u800c HashMap \u662f\u57fa\u4e8e AbstractMap\u3002Dictionary \u662f\u4efb\u4f55\u53ef\u5c06\u952e\u6620\u5c04\u5230\u76f8\u5e94\u503c\u7684\u7c7b\u7684\u62bd\u8c61\u7236\u7c7b\uff0c\u800c AbstractMap \u662f\u57fa\u4e8e Map \u63a5\u53e3\u7684\u5b9e\u73b0\uff0c\u5b83\u4ee5\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u5b9e\u73b0\u6b64\u63a5\u53e3\u6240\u9700\u7684\u5de5\u4f5c\u3002"),(0,l.kt)("li",{parentName:"ol"},"HashMap \u7684 key \u548c value \u90fd\u5141\u8bb8\u4e3a null\uff0c\u800c Hashtable \u7684 key \u548c value \u90fd\u4e0d\u5141\u8bb8\u4e3a null\u3002HashMap \u9047\u5230 key \u4e3a null \u7684\u65f6\u5019\uff0c\u8c03\u7528 putForNullKey \u65b9\u6cd5\u8fdb\u884c\u5904\u7406\uff0c\u800c\u5bf9 value \u6ca1\u6709\u5904\u7406\uff1bHashtable\u9047\u5230 null\uff0c\u76f4\u63a5\u8fd4\u56de NullPointerException\u3002"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"Hashtable \u65b9\u6cd5\u662f\u540c\u6b65\uff0c\u800cHashMap\u5219\u4e0d\u662f"),"\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u4e00\u4e0b\u6e90\u7801\uff0cHashtable \u4e2d\u7684\u51e0\u4e4e\u6240\u6709\u7684 public \u7684\u65b9\u6cd5\u90fd\u662f synchronized \u7684\uff0c\u800c\u6709\u4e9b\u65b9\u6cd5\u4e5f\u662f\u5728\u5185\u90e8\u901a\u8fc7 synchronized \u4ee3\u7801\u5757\u6765\u5b9e\u73b0\u3002\u6240\u4ee5\u6709\u4eba\u4e00\u822c\u90fd\u5efa\u8bae\u5982\u679c\u662f\u6d89\u53ca\u5230\u591a\u7ebf\u7a0b\u540c\u6b65\u65f6\u91c7\u7528 Hashtable\uff0c\u6ca1\u6709\u6d89\u53ca\u5c31\u91c7\u7528 HashMap\uff0c\u4f46\u662f\u5728 Collections \u7c7b\u4e2d\u5b58\u5728\u4e00\u4e2a\u9759\u6001\u65b9\u6cd5\uff1a",(0,l.kt)("strong",{parentName:"li"},"synchronizedMap()"),"\uff0c\u8be5\u65b9\u6cd5\u521b\u5efa\u4e86\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684 Map \u5bf9\u8c61\uff0c\u5e76\u628a\u5b83\u4f5c\u4e3a\u4e00\u4e2a\u5c01\u88c5\u7684\u5bf9\u8c61\u6765\u8fd4\u56de\u3002")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u53c2\u8003\u8d44\u6599\uff1a")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://wiki.jikexueyuan.com/project/java-collection/hashtable.html"},"Hashtable \u7684\u5b9e\u73b0\u539f\u7406 - Java \u96c6\u5408\u5b66\u4e60\u6307\u5357 - \u6781\u5ba2\u5b66\u9662Wiki"))),(0,l.kt)("h3",{id:"5-hash\u51b2\u7a81\u7684\u89e3\u51b3\u529e\u6cd5"},"5. Hash\u51b2\u7a81\u7684\u89e3\u51b3\u529e\u6cd5"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u94fe\u5730\u5740\u6cd5"),(0,l.kt)("li",{parentName:"ul"},"\u5f00\u653e\u5730\u5740\u6cd5\uff08\u5411\u540e\u4e00\u4f4d\uff09",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u6027\u63a2\u6d4b"),(0,l.kt)("li",{parentName:"ul"},"\u5e73\u65b9\u63a2\u6d4b"),(0,l.kt)("li",{parentName:"ul"},"\u4e8c\u6b21\u54c8\u5e0c"))),(0,l.kt)("li",{parentName:"ul"},"\u518d\u54c8\u5e0c\u6cd5")),(0,l.kt)("h3",{id:"6-\u4ec0\u4e48\u662f\u8fed\u4ee3\u5668"},"6. \u4ec0\u4e48\u662f\u8fed\u4ee3\u5668"),(0,l.kt)("p",null,"\u3000\u3000Java \u96c6\u5408\u6846\u67b6\u7684\u96c6\u5408\u7c7b\uff0c\u6211\u4eec\u6709\u65f6\u5019\u79f0\u4e4b\u4e3a\u5bb9\u5668\u3002\u5bb9\u5668\u7684\u79cd\u7c7b\u6709\u5f88\u591a\u79cd\uff0c\u6bd4\u5982 ArrayList\u3001LinkedList\u3001HashSet...\uff0c\u6bcf\u79cd\u5bb9\u5668\u90fd\u6709\u81ea\u5df1\u7684\u7279\u70b9\uff0cArrayList \u5e95\u5c42\u7ef4\u62a4\u7684\u662f\u4e00\u4e2a\u6570\u7ec4\uff1bLinkedList \u662f\u94fe\u8868\u7ed3\u6784\u7684\uff1bHashSet \u4f9d\u8d56\u7684\u662f\u54c8\u5e0c\u8868\uff0c\u6bcf\u79cd\u5bb9\u5668\u90fd\u6709\u81ea\u5df1\u7279\u6709\u7684\u6570\u636e\u7ed3\u6784\u3002"),(0,l.kt)("p",null,"\u3000\u3000\u56e0\u4e3a\u5bb9\u5668\u7684\u5185\u90e8\u7ed3\u6784\u4e0d\u540c\uff0c\u5f88\u591a\u65f6\u5019\u53ef\u80fd\u4e0d\u77e5\u9053\u8be5\u600e\u6837\u53bb\u904d\u5386\u4e00\u4e2a\u5bb9\u5668\u4e2d\u7684\u5143\u7d20\u3002\u6240\u4ee5\u4e3a\u4e86\u4f7f\u5bf9\u5bb9\u5668\u5185\u5143\u7d20\u7684\u64cd\u4f5c\u66f4\u4e3a\u7b80\u5355\uff0cJava \u5f15\u5165\u4e86\u8fed\u4ee3\u5668\u6a21\u5f0f\uff01 "),(0,l.kt)("p",null,"\u3000\u3000\u628a\u8bbf\u95ee\u903b\u8f91\u4ece\u4e0d\u540c\u7c7b\u578b\u7684\u96c6\u5408\u7c7b\u4e2d\u62bd\u53d6\u51fa\u6765\uff0c\u4ece\u800c\u907f\u514d\u5411\u5916\u90e8\u66b4\u9732\u96c6\u5408\u7684\u5185\u90e8\u7ed3\u6784\u3002"),(0,l.kt)("p",null,"\u3000\u3000",(0,l.kt)("strong",{parentName:"p"},"\u8fed\u4ee3\u5668\u6a21\u5f0f"),"\uff1a\u5c31\u662f\u63d0\u4f9b\u4e00\u79cd\u65b9\u6cd5\u5bf9\u4e00\u4e2a\u5bb9\u5668\u5bf9\u8c61\u4e2d\u7684\u5404\u4e2a\u5143\u7d20\u8fdb\u884c\u8bbf\u95ee\uff0c\u800c\u53c8\u4e0d\u66b4\u9732\u8be5\u5bf9\u8c61\u5bb9\u5668\u7684\u5185\u90e8\u7ec6\u8282\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public static void main(String[] args) {\n    // \u4f7f\u7528\u8fed\u4ee3\u5668\u904d\u5386ArrayList\u96c6\u5408\n    Iterator<String> listIt = list.iterator();\n    while(listIt.hasNext()){\n        System.out.println(listIt.hasNext());\n    }\n    // \u4f7f\u7528\u8fed\u4ee3\u5668\u904d\u5386Set\u96c6\u5408\n    Iterator<String> setIt = set.iterator();\n    while(setIt.hasNext()){\n        System.out.println(listIt.hasNext());\n    }\n    // \u4f7f\u7528\u8fed\u4ee3\u5668\u904d\u5386LinkedList\u96c6\u5408\n    Iterator<String> linkIt = linkList.iterator();\n    while(linkIt.hasNext()){\n        System.out.println(listIt.hasNext());\n    }\n}\n")),(0,l.kt)("p",null,"\u53c2\u8003\u8d44\u6599\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.cnblogs.com/zyuze/p/7726582.html"},"\u6df1\u5165\u7406\u89e3Java\u4e2d\u7684\u8fed\u4ee3\u5668 - Mr\xb7Dragon - \u535a\u5ba2\u56ed"))),(0,l.kt)("h3",{id:"7-\u6784\u9020\u76f8\u540chash\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u653b\u51fb\u8fd9\u79cd\u60c5\u51b5\u5e94\u8be5\u600e\u4e48\u5904\u7406jdk7\u5982\u4f55\u5904\u7406"},"7. \u6784\u9020\u76f8\u540chash\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u653b\u51fb\uff0c\u8fd9\u79cd\u60c5\u51b5\u5e94\u8be5\u600e\u4e48\u5904\u7406\uff1fJDK7\u5982\u4f55\u5904\u7406"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u653b\u51fb\u539f\u7406\uff1a")),(0,l.kt)("p",null,"\u3000\u3000\u5f53\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u5230\u670d\u52a1\u5668\uff0c\u5982\u679c\u8be5\u8bf7\u6c42\u4e2d\u5e26\u6709\u53c2\u6570\uff0c\u670d\u52a1\u5668\u7aef\u4f1a\u5c06 \u53c2\u6570\u540d-\u53c2\u6570\u503c \u4f5c\u4e3a key-value \u4fdd\u5b58\u5728 HashMap \u4e2d\u3002\u5982\u679c\u6709\u4eba\u6076\u610f\u6784\u9020\u8bf7\u6c42\uff0c\u5728\u8bf7\u6c42\u4e2d\u52a0\u5165\u5927\u91cf\u76f8\u540c hash \u503c\u7684 String \u53c2\u6570\u540d\uff08key\uff09\uff0c\u90a3\u4e48\u5728\u670d\u52a1\u5668\u7aef\u7528\u4e8e\u5b58\u50a8\u8fd9\u4e9b key-value \u5bf9\u7684 HashMap \u4f1a\u88ab\u5f3a\u884c\u9000\u5316\u6210\u94fe\u8868\uff0c\u5982\u56fe\uff1a"),(0,l.kt)("div",{align:"center"}," ",(0,l.kt)("img",{src:"assets/hash-to-badlink.png",width:""})),(0,l.kt)("p",null,"\u5982\u679c\u6570\u636e\u91cf\u8db3\u591f\u5927\uff0c\u90a3\u4e48\u5728\u67e5\u627e\uff0c\u63d2\u5165\u65f6\u4f1a\u5360\u7528\u5927\u91cf CPU\uff0c\u8fbe\u5230\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u7684\u76ee\u7684\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u600e\u4e48\u5904\u7406")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u9650\u5236 POST \u548c GET \u8bf7\u6c42\u7684\u53c2\u6570\u4e2a\u6570"),(0,l.kt)("li",{parentName:"ol"},"\u9650\u5236 POST \u8bf7\u6c42\u7684\u8bf7\u6c42\u4f53\u5927\u5c0f"),(0,l.kt)("li",{parentName:"ol"},"Web Application FireWall\uff08WAF\uff09")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"JDK7\u5982\u4f55\u5904\u7406")),(0,l.kt)("p",null,"HashMap \u4f1a\u52a8\u6001\u7684\u4f7f\u7528\u4e00\u4e2a\u4e13\u95e8 TreeMap \u5b9e\u73b0\u6765\u66ff\u6362\u6389\u5b83\u3002"),(0,l.kt)("h3",{id:"8-hashmap\u4e3a\u4ec0\u4e48\u5927\u5c0f\u662f2\u7684\u5e42\u6b21"},"8. HashMap\u4e3a\u4ec0\u4e48\u5927\u5c0f\u662f2\u7684\u5e42\u6b21"),(0,l.kt)("p",null,"\u9996\u5148\u6765\u770b\u4e00\u4e0b HashMap \u7684 put \u65b9\u6cd5\u7684\u6e90\u7801"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public V put(K key, V value) {\n    if (key == null)                \n        return putForNullKey(value);  //\u5c06\u7a7akey\u7684Entry\u52a0\u5165\u5230table[0]\u4e2d\n    int hash = hash(key.hashCode());  //\u8ba1\u7b97key.hashcode()\u7684hash\u503c\uff0chash\u51fd\u6570\u7531HashMap\u81ea\u5df1\u5b9e\u73b0\n    int i = indexFor(hash, table.length);  //\u83b7\u53d6\u5c06\u8981\u5b58\u653e\u7684\u6570\u7ec4\u4e0b\u6807\n    /*\n     * for\u4e2d\u7684\u4ee3\u7801\u7528\u4e8e\uff1a\u5f53hash\u503c\u76f8\u540c\u4e14key\u76f8\u540c\u7684\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528\u65b0\u503c\u8986\u76d6\u65e7\u503c\uff08\u5176\u5b9e\u5c31\u662f\u4fee\u6539\u529f\u80fd\uff09\n     */\n    //\u6ce8\u610f\uff1afor\u5faa\u73af\u5728\u7b2c\u4e00\u6b21\u6267\u884c\u65f6\u5c31\u4f1a\u5148\u5224\u65ad\u6761\u4ef6\n    for (Entry<K, V> e = table[i]; e != null; e = e.next) {\n        Object k;\n        //hash\u503c\u76f8\u540c\u4e14key\u76f8\u540c\u7684\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528\u65b0\u503c\u8986\u76d6\u65e7\u503c\n        if (e.hash == hash && ((k = e.key) == key || key.equals(k))) {\n            V oldValue = e.value;\n            e.value = value;\n            //e.recordAccess(this);\n            return oldValue;//\u8fd4\u56de\u65e7\u503c\n        }\n    }\n    modCount++;\n    addEntry(hash, key, value, i);//\u589e\u52a0\u4e00\u4e2a\u65b0\u7684Entry\u5230table[i]\n    return null;//\u5982\u679c\u6ca1\u6709\u4e0e\u4f20\u5165\u7684key\u76f8\u7b49\u7684Entry\uff0c\u5c31\u8fd4\u56denull\n}\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * "\u6309\u4f4d\u4e0e"\u6765\u83b7\u53d6\u6570\u7ec4\u4e0b\u6807\n */\nstatic int indexFor(int h, int length) {\n    return h & (length - 1);\n}\n\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"HashMap \u59cb\u7ec8\u5c06\u81ea\u5df1\u7684\u6876\u4fdd\u6301\u57282",(0,l.kt)("sup",null,"n"),"\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\uff1findexFor\u8fd9\u4e2a\u65b9\u6cd5\u89e3\u91ca\u4e86\u8fd9\u4e2a\u95ee\u9898")),(0,l.kt)("p",null,"\u5927\u5bb6\u90fd\u77e5\u9053\u8ba1\u7b97\u673a\u91cc\u9762\u4f4d\u8fd0\u7b97\u662f\u57fa\u672c\u8fd0\u7b97\uff0c\u4f4d\u8fd0\u7b97\u7684\u6548\u7387\u662f\u8fdc\u8fdc\u9ad8\u4e8e\u53d6\u4f59 % \u8fd0\u7b97\u7684"),(0,l.kt)("p",null,"\u4e3e\u4e2a\u4f8b\u5b50\uff1a2",(0,l.kt)("sup",null,"n")," \u8f6c\u6362\u6210\u4e8c\u8fdb\u5236\u5c31\u662f 1+n \u4e2a 0\uff0c\u51cf 1 \u4e4b\u540e\u5c31\u662f 0+n\u4e2a1\uff0c\u598216 -> 10000\uff0c15 -> 01111"),(0,l.kt)("p",null,"\u90a3\u4e48\u6839\u636e & \u4f4d\u8fd0\u7b97\u7684\u89c4\u5219\uff0c\u90fd\u4e3a 1 (\u771f)\u65f6\uff0c\u624d\u4e3a 1\uff0c\u90a3 0\u2264\u8fd0\u7b97\u540e\u7684\u7ed3\u679c\u226415\uff0c\u5047\u8bbe h <= 15\uff0c\u90a3\u4e48\u8fd0\u7b97\u540e\u7684\u7ed3\u679c\u5c31\u662f h \u672c\u8eab\uff0ch >15\uff0c\u8fd0\u7b97\u540e\u7684\u7ed3\u679c\u5c31\u662f\u6700\u540e\u56db\u4f4d\u4e8c\u8fdb\u5236\u505a & \u8fd0\u7b97\u540e\u7684\u503c\uff0c\u6700\u7ec8\uff0c\u5c31\u662f % \u8fd0\u7b97\u540e\u7684\u4f59\u6570\u3002"),(0,l.kt)("p",null,"\u5f53\u5bb9\u91cf\u4e00\u5b9a\u662f 2",(0,l.kt)("sup",null,"n")," \u65f6\uff0ch & (length - 1) == h % length"),(0,l.kt)("h2",{id:"\u66f4\u65b0\u65e5\u5fd7"},"\u66f4\u65b0\u65e5\u5fd7"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"2018/8/3 v2.5 \u57fa\u7840\u7248"),(0,l.kt)("li",{parentName:"ul"},"2018/9/1 v3.0 \u521d\u7a3f\u7248")))}u.isMDXComponent=!0},9138:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/1535785576589-c4eb3febe83dc2d18ed19f1dc6ecb0fd.png"},4345:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/ArrayList_base-34ee3ad61aa6c940f5c47432c1e15aa0.png"}}]);